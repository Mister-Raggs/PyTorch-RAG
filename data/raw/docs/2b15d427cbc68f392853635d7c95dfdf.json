{
  "doc_id": "2b15d427cbc68f392853635d7c95dfdf",
  "source": "pytorch_docs",
  "title": "python.assert \u2014 PyTorch 2.9 documentation",
  "text": "\n## python.assert#\n\n\n## dynamic_shape_assert#\n\nNote\nTags:python.assert\nSupport Level: SUPPORTED\nOriginal source code:\n\n```python\n# mypy: allow-untyped-defs\nimport torch\n\nclass DynamicShapeAssert(torch.nn.Module):\n    \"\"\"\n    A basic usage of python assertion.\n    \"\"\"\n\n    def forward(self, x):\n        # assertion with error message\n        assert x.shape[0] > 2, f\"{x.shape[0]} is greater than 2\"\n        # assertion without error message\n        assert x.shape[0] > 1\n        return x\n\nexample_args = (torch.randn(3, 2),)\ntags = {\"python.assert\"}\nmodel = DynamicShapeAssert()\n\n\ntorch.export.export(model, example_args)\n\n```\n\nResult:\n\n```python\nExportedProgram:\n    class GraphModule(torch.nn.Module):\n        def forward(self, x: \"f32[3, 2]\"):\n            return (x,)\n\nGraph signature:\n    # inputs\n    x: USER_INPUT\n\n    # outputs\n    x: USER_OUTPUT\n\nRange constraints: {}\n\n```\n\n\n## list_contains#\n\nNote\nTags:python.data-structure,torch.dynamic-shape,python.assert\nSupport Level: SUPPORTED\nOriginal source code:\n\n```python\n# mypy: allow-untyped-defs\nimport torch\n\nclass ListContains(torch.nn.Module):\n    \"\"\"\n    List containment relation can be checked on a dynamic shape or constants.\n    \"\"\"\n\n    def forward(self, x):\n        assert x.size(-1) in [6, 2]\n        assert x.size(0) not in [4, 5, 6]\n        assert \"monkey\" not in [\"cow\", \"pig\"]\n        return x + x\n\nexample_args = (torch.randn(3, 2),)\ntags = {\"torch.dynamic-shape\", \"python.data-structure\", \"python.assert\"}\nmodel = ListContains()\n\n\ntorch.export.export(model, example_args)\n\n```\n\nResult:\n\n```python\nExportedProgram:\n    class GraphModule(torch.nn.Module):\n        def forward(self, x: \"f32[3, 2]\"):\n                 add: \"f32[3, 2]\" = torch.ops.aten.add.Tensor(x, x);  x = None\n            return (add,)\n\nGraph signature:\n    # inputs\n    x: USER_INPUT\n\n    # outputs\n    add: USER_OUTPUT\n\nRange constraints: {}\n\n```\n",
  "url": "https://pytorch.org/docs/stable/generated/exportdb/python.assert.html",
  "metadata": {
    "section": null,
    "issue_number": null,
    "labels": null,
    "answer_author": null
  }
}