{
  "doc_id": "8b5b197f2592bf79474ece4062e8e703",
  "source": "pytorch_docs",
  "title": "torch.overrides \u2014 PyTorch 2.9 documentation",
  "text": "\n## torch.overrides#\n\nCreated On: Nov 30, 2020 | Last Updated On: Jun 06, 2025\nThis module exposes various helper functions for the__torch_function__protocol. SeeExtending torch Python APIfor more details on the__torch_function__protocol.\n__torch_function__\n__torch_function__\n\n## Functions#\n\nReturn public functions that cannot be overridden by__torch_function__.\n__torch_function__\nA tuple of functions that are publicly available in the torch API but cannot\nbe overridden with__torch_function__. Mostly this is because none of the\narguments of these functions are tensors or tensor-likes.\n__torch_function__\nset[Callable]\nExamples\n\n```python\n>>> torch.Tensor.as_subclass in torch.overrides.get_ignored_functions()\nTrue\n>>> torch.add in torch.overrides.get_ignored_functions()\nFalse\n\n```\n\nList functions that are overridable via __torch_function__\nA dictionary that maps namespaces that contain overridable functions\nto functions in that namespace that can be overridden.\nDict[Any, List[Callable]]\nGet a human readable string name for a function passed to\n__torch_function__\nf(Callable) \u2013 Function to resolve the name of.\nName of the function; if eval\u2019ed it should give back the input\nfunction.\nstr\nReturn a dict containing dummy overrides for all overridable functions\nA dictionary that maps overridable functions in the PyTorch API to\nlambda functions that have the same signature as the real function\nand unconditionally return -1. These lambda functions are useful\nfor testing API coverage for a type that defines__torch_function__.\n__torch_function__\nDict[Callable, Callable]\nExamples\n\n```python\n>>> import inspect\n>>> my_add = torch.overrides.get_testing_overrides()[torch.add]\n>>> inspect.signature(my_add)\n<Signature (input, other, out=None)>\n\n```\n\nImplement a function with checks for__torch_function__overrides.\n__torch_function__\nSee torch::autograd::handle_torch_function for the equivalent of this\nfunction in the C++ implementation.\npublic_api(function) \u2013 Function exposed by the public torch API originally called likepublic_api(*args,**kwargs)on which arguments are now being\nchecked.\npublic_api(*args,**kwargs)\nrelevant_args(iterable) \u2013 Iterable of arguments to check for __torch_function__ methods.\nargs(tuple) \u2013 Arbitrary positional arguments originally passed intopublic_api.\npublic_api\nkwargs(tuple) \u2013 Arbitrary keyword arguments originally passed intopublic_api.\npublic_api\nResult from callingimplementationor an__torch_function__method, as appropriate.\nimplementation\n__torch_function__\nobject\n:raises TypeError : if no implementation is found.:\nExample\n\n```python\n>>> def func(a):\n...     if has_torch_function_unary(a):\n...         return handle_torch_function(func, (a,), a)\n...     return a + 0\n\n```\n\nCheck for __torch_function__ implementations in the elements of an iterable\nor if a __torch_function__ mode is enabled.  Considers exactTensors\nandParameters non-dispatchable.  Use this to guard a call tohandle_torch_function(); don\u2019t use it to test if something\nis Tensor-like, useis_tensor_like()instead.\n:param relevant_args: Iterable or arguments to check for __torch_function__ methods.\n:type relevant_args: iterable\nTensor\nParameter\nhandle_torch_function()\nis_tensor_like()\nTrue if any of the elements of relevant_args have __torch_function__\nimplementations, False otherwise.\nbool\nSee also\ntorch.is_tensor_like\nChecks if something is a Tensor-like, including an exactTensor.\nTensor\nReturnsTrueif the passed-in input is a Tensor-like.\nTrue\nCurrently, this occurs whenever there\u2019s a__torch_function__attribute on the type of the input.\n__torch_function__\nExamples\nA subclass of tensor is generally a Tensor-like.\n\n```python\n>>> class SubTensor(torch.Tensor): ...\n>>> is_tensor_like(SubTensor([0]))\nTrue\n\n```\n\nBuilt-in or user types aren\u2019t usually Tensor-like.\n\n```python\n>>> is_tensor_like(6)\nFalse\n>>> is_tensor_like(None)\nFalse\n>>> class NotATensor: ...\n>>> is_tensor_like(NotATensor())\nFalse\n\n```\n\nBut, they can be made Tensor-like by implementing __torch_function__.\n\n```python\n>>> class TensorLike:\n...     @classmethod\n...     def __torch_function__(cls, func, types, args, kwargs):\n...         return -1\n>>> is_tensor_like(TensorLike())\nTrue\n\n```\n\nReturns True if the function passed in is a handler for a\nmethod or property belonging totorch.Tensor, as passed\ninto__torch_function__.\ntorch.Tensor\n__torch_function__\nNote\nFor properties, their__get__method must be passed in.\n__get__\nThis may be needed, in particular, for the following reasons:\nMethods/properties sometimes don\u2019t contain a__module__slot.\nThey require that the first passed-in argument is an instance\noftorch.Tensor.\ntorch.Tensor\nExamples\n\n```python\n>>> is_tensor_method_or_property(torch.Tensor.add)\nTrue\n>>> is_tensor_method_or_property(torch.add)\nFalse\n\n```\n\nbool\nWraps a given function with__torch_function__-related functionality.\n__torch_function__\ndispatcher(Callable) \u2013 A callable that returns an iterable of Tensor-likes passed into the function.\nNote\nThis decorator may reduce the performance of your code. Generally, it\u2019s enough to express\nyour code as a series of functions that, themselves, support __torch_function__. If you\nfind yourself in the rare situation where this is not the case, e.g. if you\u2019re wrapping a\nlow-level library and you also need it to work for Tensor-likes, then this function is available.\nExamples\n\n```python\n>>> def dispatcher(a):  # Must have the same signature as func\n...     return (a,)\n>>> @torch.overrides.wrap_torch_function(dispatcher)\n>>> def func(a):  # This will make func dispatchable by __torch_function__\n...     return a + 0\n\n```\n",
  "url": "https://pytorch.org/docs/stable/torch.overrides.html",
  "metadata": {
    "section": null,
    "issue_number": null,
    "labels": null,
    "answer_author": null
  }
}