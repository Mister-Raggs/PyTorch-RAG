{
  "doc_id": "78fb4fedf103adc6b97789dd754f7d10",
  "source": "pytorch_docs",
  "title": "Toggling error_on_graph_break \u2014 PyTorch 2.9 documentation",
  "text": "\n## Togglingerror_on_graph_break#\n\nerror_on_graph_break\nCreated On: Sep 03, 2025 | Last Updated On: Sep 03, 2025\nSummary:\nWhenfullgraph=False, we can usetorch._dynamo.error_on_graph_break()for more flexibility in\ndealing with graph breaks.\nfullgraph=False\ntorch._dynamo.error_on_graph_break()\nSo far, we have introduced two ways in dealing with graph breaks intorch.compile:\ntorch.compile\nfullgraph=Trueerrors on the first graph break and additionally guarantees that only one graph is traced from the code.\nfullgraph=True\nfullgraph=Falsecontinues tracing even when encountering graph breaks.\nfullgraph=False\nWhat if we want to disallow graph breaks for most of the code, but there are a few problematic functions where the graph breaks are hard to remove,\nand we are okay with having those graph breaks? We can usetorch._dynamo.error_on_graph_break()to achieve this.\ntorch._dynamo.error_on_graph_break()\ntorch.compilehas anerror_on_graph_breaksetting (initially set toFalse).\nIf a graph break or compiler error occurs in code whileerror_on_graph_breakis set toFalse, thentorch.compilewill attempt to continue compilation after the graph break/error.\nIferror_on_graph_breakis set toTrue, thentorch.compilewill abort compilation and propagate the error to user code.\ntorch.compile\nerror_on_graph_break\nFalse\nerror_on_graph_break\nFalse\ntorch.compile\nerror_on_graph_break\nTrue\ntorch.compile\nA significant difference betweenerror_on_graph_break=Trueandfullgraph=Trueis that the formerdoes not guarantee that a single graph will be captured.error_on_graph_breakcan be arbitrarily toggled during compile timeby using thetorch._dynamo.error_on_graph_break()context manager/decorator.\nIn comparison, oncefullgraphis set toTrue, it cannot be set back toFalse.\nFinally,error_on_graph_breakhas lower precedence thanfullgraph-error_on_graph_breakonly takes effect whenfullgraph=False.\nerror_on_graph_break=True\nfullgraph=True\nerror_on_graph_break\ntorch._dynamo.error_on_graph_break()\nfullgraph\nTrue\nFalse\nerror_on_graph_break\nfullgraph\nerror_on_graph_break\nfullgraph=False\n\n## error_on_graph_break(False)example#\n\nerror_on_graph_break(False)\n\n```python\n@torch._dynamo.error_on_graph_break(False)\ndef code_with_a_difficult_graph_break(x):\n    x = x + 1\n    torch._dynamo.graph_break()\n    return x + 2\n\ndef inner(x):\n    return code_with_a_difficult_graph_break(x)\n\n# NOTE: fullgraph=False\n@torch._dynamo.error_on_graph_break(True)\n@torch.compile\ndef fn(x):\n    return inner(x)\n\n# No error, but there is a graph break\nfn(torch.randn(3))\n\n```\n\n\n```python\nGraph break in user code at /tmp/ipykernel_357/1452578661.py:4\nGraph Break Reason: Call to `torch._dynamo.graph_break()`\n  Explanation: User-inserted graph break. Message: None\n  Hint: Remove the `torch._dynamo.graph_break()` call.\n\n  Developer debug context: Called `torch._dynamo.graph_break()` with args `[]`, kwargs `{}`\n\n For more details about this graph break, please visit: https://meta-pytorch.github.io/compile-graph-break-site/gb/gb0025.html\nUser code traceback:\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/runpy.py\", line 196, in _run_module_as_main\n    return _run_code(code, main_globals, None,\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/runpy.py\", line 86, in _run_code\n    exec(code, run_globals)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel_launcher.py\", line 18, in <module>\n    app.launch_new_instance()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/traitlets/config/application.py\", line 1075, in launch_instance\n    app.start()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/kernelapp.py\", line 758, in start\n    self.io_loop.start()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/tornado/platform/asyncio.py\", line 211, in start\n    self.asyncio_loop.run_forever()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/asyncio/base_events.py\", line 603, in run_forever\n    self._run_once()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/asyncio/base_events.py\", line 1909, in _run_once\n    handle._run()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/asyncio/events.py\", line 80, in _run\n    self._context.run(self._callback, *self._args)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/utils.py\", line 71, in preserve_context\n    return await f(*args, **kwargs)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/kernelbase.py\", line 614, in shell_main\n    await self.dispatch_shell(msg, subshell_id=subshell_id)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/kernelbase.py\", line 471, in dispatch_shell\n    await result\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/ipkernel.py\", line 366, in execute_request\n    await super().execute_request(stream, ident, parent)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/kernelbase.py\", line 827, in execute_request\n    reply_content = await reply_content\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/ipkernel.py\", line 458, in do_execute\n    res = shell.run_cell(\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/zmqshell.py\", line 663, in run_cell\n    return super().run_cell(*args, **kwargs)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/interactiveshell.py\", line 3006, in run_cell\n    result = self._run_cell(\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/interactiveshell.py\", line 3061, in _run_cell\n    result = runner(coro)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/async_helpers.py\", line 129, in _pseudo_sync_runner\n    coro.send(None)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/interactiveshell.py\", line 3266, in run_cell_async\n    has_raised = await self.run_ast_nodes(code_ast.body, cell_name,\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/interactiveshell.py\", line 3445, in run_ast_nodes\n    if await self.run_code(code, result, async_=asy):\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/interactiveshell.py\", line 3505, in run_code\n    exec(code_obj, self.user_global_ns, self.user_ns)\n  File \"/tmp/ipykernel_357/1452578661.py\", line 17, in <module>\n    fn(torch.randn(3))\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/_dynamo/external_utils.py\", line 209, in inner\n    return func(*args, **kwargs)\n  File \"/tmp/ipykernel_357/1452578661.py\", line 14, in fn\n    return inner(x)\n  File \"/tmp/ipykernel_357/1452578661.py\", line 8, in inner\n    return code_with_a_difficult_graph_break(x)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/_dynamo/external_utils.py\", line 209, in inner\n    return func(*args, **kwargs)\n  File \"/tmp/ipykernel_357/1452578661.py\", line 4, in code_with_a_difficult_graph_break\n    torch._dynamo.graph_break()\n\nGraph break (user stack suppressed due to duplicate graph break) in user code at /tmp/ipykernel_357/1452578661.py:4\nGraph Break Reason: Call to `torch._dynamo.graph_break()`\n  Explanation: User-inserted graph break. Message: None\n  Hint: Remove the `torch._dynamo.graph_break()` call.\n\n  Developer debug context: Called `torch._dynamo.graph_break()` with args `[]`, kwargs `{}`\n\n For more details about this graph break, please visit: https://meta-pytorch.github.io/compile-graph-break-site/gb/gb0025.html\nGraph break (user stack suppressed due to duplicate graph break) in user code at /tmp/ipykernel_357/1452578661.py:4\nGraph Break Reason: Call to `torch._dynamo.graph_break()`\n  Explanation: User-inserted graph break. Message: None\n  Hint: Remove the `torch._dynamo.graph_break()` call.\n\n  Developer debug context: Called `torch._dynamo.graph_break()` with args `[]`, kwargs `{}`\n\n For more details about this graph break, please visit: https://meta-pytorch.github.io/compile-graph-break-site/gb/gb0025.html\nGraph break (user stack suppressed due to duplicate graph break) in user code at /tmp/ipykernel_357/1452578661.py:4\nGraph Break Reason: Call to `torch._dynamo.graph_break()`\n  Explanation: User-inserted graph break. Message: None\n  Hint: Remove the `torch._dynamo.graph_break()` call.\n\n  Developer debug context: Called `torch._dynamo.graph_break()` with args `[]`, kwargs `{}`\n\n For more details about this graph break, please visit: https://meta-pytorch.github.io/compile-graph-break-site/gb/gb0025.html\n\n```\n\n\n```python\ntensor([3.1074, 3.0004, 2.7473])\n\n```\n\nUsingerror_on_graph_break(False)undererror_on_graph_break(True)is helpful for when we want to minimize graph breaks (i.e. follow thefullgraph=Trueprogramming model),\nbut there are some sections of code with non-performance-critical graph breaks that are difficult to work around.\nerror_on_graph_break(False)\nerror_on_graph_break(True)\nfullgraph=True\nerror_on_graph_break()can be used as a context manager as well:\nerror_on_graph_break()\n\n```python\n# NOTE: fullgraph=False\n@torch._dynamo.error_on_graph_break(True)\n@torch.compile\ndef fn(x):\n    x = x + 1\n    with torch._dynamo.error_on_graph_break(False):\n        torch._dynamo.graph_break()  # no error\n    return x + 2\n\n# No error, but there is a graph break\nfn(torch.randn(3))\n\n```\n\n\n```python\nGraph break in user code at /tmp/ipykernel_357/737485247.py:7\nGraph Break Reason: Call to `torch._dynamo.graph_break()`\n  Explanation: User-inserted graph break. Message: None\n  Hint: Remove the `torch._dynamo.graph_break()` call.\n\n  Developer debug context: Called `torch._dynamo.graph_break()` with args `[]`, kwargs `{}`\n\n For more details about this graph break, please visit: https://meta-pytorch.github.io/compile-graph-break-site/gb/gb0025.html\nUser code traceback:\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/runpy.py\", line 196, in _run_module_as_main\n    return _run_code(code, main_globals, None,\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/runpy.py\", line 86, in _run_code\n    exec(code, run_globals)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel_launcher.py\", line 18, in <module>\n    app.launch_new_instance()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/traitlets/config/application.py\", line 1075, in launch_instance\n    app.start()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/kernelapp.py\", line 758, in start\n    self.io_loop.start()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/tornado/platform/asyncio.py\", line 211, in start\n    self.asyncio_loop.run_forever()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/asyncio/base_events.py\", line 603, in run_forever\n    self._run_once()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/asyncio/base_events.py\", line 1909, in _run_once\n    handle._run()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/asyncio/events.py\", line 80, in _run\n    self._context.run(self._callback, *self._args)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/utils.py\", line 71, in preserve_context\n    return await f(*args, **kwargs)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/kernelbase.py\", line 614, in shell_main\n    await self.dispatch_shell(msg, subshell_id=subshell_id)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/kernelbase.py\", line 471, in dispatch_shell\n    await result\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/ipkernel.py\", line 366, in execute_request\n    await super().execute_request(stream, ident, parent)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/kernelbase.py\", line 827, in execute_request\n    reply_content = await reply_content\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/ipkernel.py\", line 458, in do_execute\n    res = shell.run_cell(\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/zmqshell.py\", line 663, in run_cell\n    return super().run_cell(*args, **kwargs)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/interactiveshell.py\", line 3006, in run_cell\n    result = self._run_cell(\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/interactiveshell.py\", line 3061, in _run_cell\n    result = runner(coro)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/async_helpers.py\", line 129, in _pseudo_sync_runner\n    coro.send(None)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/interactiveshell.py\", line 3266, in run_cell_async\n    has_raised = await self.run_ast_nodes(code_ast.body, cell_name,\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/interactiveshell.py\", line 3445, in run_ast_nodes\n    if await self.run_code(code, result, async_=asy):\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/interactiveshell.py\", line 3505, in run_code\n    exec(code_obj, self.user_global_ns, self.user_ns)\n  File \"/tmp/ipykernel_357/737485247.py\", line 11, in <module>\n    fn(torch.randn(3))\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/_dynamo/external_utils.py\", line 209, in inner\n    return func(*args, **kwargs)\n  File \"/tmp/ipykernel_357/737485247.py\", line 7, in fn\n    torch._dynamo.graph_break()  # no error\n\n```\n\n\n```python\ntensor([2.5366, 3.5258, 3.4748])\n\n```\n\nYou can use monkey patching to toggleerror_on_graph_breakfor code where you cannot edit the source (e.g. framework code):\nerror_on_graph_break\n\n```python\nclass ThirdPartyModule(torch.nn.Module):\n    def forward(self, x):\n        x = x + 1\n        torch._dynamo.graph_break()\n        return x + 2\n\ntp_mod = ThirdPartyModule()\ntp_mod.forward = torch._dynamo.error_on_graph_break(False)(tp_mod.forward)\n\n@torch._dynamo.error_on_graph_break(True)\n@torch.compile\ndef fn(x):\n    return tp_mod.forward(x)\n\n# No error, but there is a graph break\nfn(torch.randn(3))\n\n```\n\n\n```python\nGraph break in user code at /tmp/ipykernel_357/2112598647.py:4\nGraph Break Reason: Call to `torch._dynamo.graph_break()`\n  Explanation: User-inserted graph break. Message: None\n  Hint: Remove the `torch._dynamo.graph_break()` call.\n\n  Developer debug context: Called `torch._dynamo.graph_break()` with args `[]`, kwargs `{}`\n\n For more details about this graph break, please visit: https://meta-pytorch.github.io/compile-graph-break-site/gb/gb0025.html\nUser code traceback:\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/runpy.py\", line 196, in _run_module_as_main\n    return _run_code(code, main_globals, None,\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/runpy.py\", line 86, in _run_code\n    exec(code, run_globals)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel_launcher.py\", line 18, in <module>\n    app.launch_new_instance()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/traitlets/config/application.py\", line 1075, in launch_instance\n    app.start()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/kernelapp.py\", line 758, in start\n    self.io_loop.start()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/tornado/platform/asyncio.py\", line 211, in start\n    self.asyncio_loop.run_forever()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/asyncio/base_events.py\", line 603, in run_forever\n    self._run_once()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/asyncio/base_events.py\", line 1909, in _run_once\n    handle._run()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/asyncio/events.py\", line 80, in _run\n    self._context.run(self._callback, *self._args)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/utils.py\", line 71, in preserve_context\n    return await f(*args, **kwargs)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/kernelbase.py\", line 614, in shell_main\n    await self.dispatch_shell(msg, subshell_id=subshell_id)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/kernelbase.py\", line 471, in dispatch_shell\n    await result\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/ipkernel.py\", line 366, in execute_request\n    await super().execute_request(stream, ident, parent)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/kernelbase.py\", line 827, in execute_request\n    reply_content = await reply_content\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/ipkernel.py\", line 458, in do_execute\n    res = shell.run_cell(\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/zmqshell.py\", line 663, in run_cell\n    return super().run_cell(*args, **kwargs)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/interactiveshell.py\", line 3006, in run_cell\n    result = self._run_cell(\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/interactiveshell.py\", line 3061, in _run_cell\n    result = runner(coro)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/async_helpers.py\", line 129, in _pseudo_sync_runner\n    coro.send(None)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/interactiveshell.py\", line 3266, in run_cell_async\n    has_raised = await self.run_ast_nodes(code_ast.body, cell_name,\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/interactiveshell.py\", line 3445, in run_ast_nodes\n    if await self.run_code(code, result, async_=asy):\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/interactiveshell.py\", line 3505, in run_code\n    exec(code_obj, self.user_global_ns, self.user_ns)\n  File \"/tmp/ipykernel_357/2112598647.py\", line 16, in <module>\n    fn(torch.randn(3))\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/_dynamo/external_utils.py\", line 209, in inner\n    return func(*args, **kwargs)\n  File \"/tmp/ipykernel_357/2112598647.py\", line 13, in fn\n    return tp_mod.forward(x)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/_dynamo/external_utils.py\", line 209, in inner\n    return func(*args, **kwargs)\n  File \"/tmp/ipykernel_357/2112598647.py\", line 4, in forward\n    torch._dynamo.graph_break()\n\nGraph break (user stack suppressed due to duplicate graph break) in user code at /tmp/ipykernel_357/2112598647.py:4\nGraph Break Reason: Call to `torch._dynamo.graph_break()`\n  Explanation: User-inserted graph break. Message: None\n  Hint: Remove the `torch._dynamo.graph_break()` call.\n\n  Developer debug context: Called `torch._dynamo.graph_break()` with args `[]`, kwargs `{}`\n\n For more details about this graph break, please visit: https://meta-pytorch.github.io/compile-graph-break-site/gb/gb0025.html\nGraph break (user stack suppressed due to duplicate graph break) in user code at /tmp/ipykernel_357/2112598647.py:4\nGraph Break Reason: Call to `torch._dynamo.graph_break()`\n  Explanation: User-inserted graph break. Message: None\n  Hint: Remove the `torch._dynamo.graph_break()` call.\n\n  Developer debug context: Called `torch._dynamo.graph_break()` with args `[]`, kwargs `{}`\n\n For more details about this graph break, please visit: https://meta-pytorch.github.io/compile-graph-break-site/gb/gb0025.html\n\n```\n\n\n```python\ntensor([2.6542, 2.0017, 3.5263])\n\n```\n\n\n## error_on_graph_break(True)example#\n\nerror_on_graph_break(True)\n\n```python\n@torch._dynamo.error_on_graph_break(True)\ndef inner2(x):\n    x = x + 1\n    torch._dynamo.graph_break()  # error\n    return x + 2\n\ndef inner(x):\n    return inner2(x)\n\n# fullgraph=False, error_on_graph_break=False\n@torch.compile\ndef fn(x):\n    x = x + 4\n    torch._dynamo.graph_break()  # no error\n    return inner(x)\n\ntry:\n    fn(torch.randn(3))\nexcept Exception as e:\n    print(e)\n\n```\n\n\n```python\nCall to `torch._dynamo.graph_break()`\n  Explanation: User-inserted graph break. Message: None\n  Hint: Remove the `torch._dynamo.graph_break()` call.\n\n  Developer debug context: Called `torch._dynamo.graph_break()` with args `[]`, kwargs `{}`\n\n For more details about this graph break, please visit: https://meta-pytorch.github.io/compile-graph-break-site/gb/gb0025.html\n\nfrom user code:\n   File \"/tmp/ipykernel_357/2379101916.py\", line 15, in torch_dynamo_resume_in_fn_at_14\n    return inner(x)\n  File \"/tmp/ipykernel_357/2379101916.py\", line 8, in inner\n    return inner2(x)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/_dynamo/external_utils.py\", line 209, in inner\n    return func(*args, **kwargs)\n  File \"/tmp/ipykernel_357/2379101916.py\", line 4, in inner2\n    torch._dynamo.graph_break()  # error\n\nSet TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS=\"+dynamo\"\n\n```\n\n\n```python\nGraph break in user code at /tmp/ipykernel_357/2379101916.py:14\nGraph Break Reason: Call to `torch._dynamo.graph_break()`\n  Explanation: User-inserted graph break. Message: None\n  Hint: Remove the `torch._dynamo.graph_break()` call.\n\n  Developer debug context: Called `torch._dynamo.graph_break()` with args `[]`, kwargs `{}`\n\n For more details about this graph break, please visit: https://meta-pytorch.github.io/compile-graph-break-site/gb/gb0025.html\nUser code traceback:\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/runpy.py\", line 196, in _run_module_as_main\n    return _run_code(code, main_globals, None,\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/runpy.py\", line 86, in _run_code\n    exec(code, run_globals)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel_launcher.py\", line 18, in <module>\n    app.launch_new_instance()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/traitlets/config/application.py\", line 1075, in launch_instance\n    app.start()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/kernelapp.py\", line 758, in start\n    self.io_loop.start()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/tornado/platform/asyncio.py\", line 211, in start\n    self.asyncio_loop.run_forever()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/asyncio/base_events.py\", line 603, in run_forever\n    self._run_once()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/asyncio/base_events.py\", line 1909, in _run_once\n    handle._run()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/asyncio/events.py\", line 80, in _run\n    self._context.run(self._callback, *self._args)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/utils.py\", line 71, in preserve_context\n    return await f(*args, **kwargs)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/kernelbase.py\", line 614, in shell_main\n    await self.dispatch_shell(msg, subshell_id=subshell_id)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/kernelbase.py\", line 471, in dispatch_shell\n    await result\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/ipkernel.py\", line 366, in execute_request\n    await super().execute_request(stream, ident, parent)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/kernelbase.py\", line 827, in execute_request\n    reply_content = await reply_content\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/ipkernel.py\", line 458, in do_execute\n    res = shell.run_cell(\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/zmqshell.py\", line 663, in run_cell\n    return super().run_cell(*args, **kwargs)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/interactiveshell.py\", line 3006, in run_cell\n    result = self._run_cell(\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/interactiveshell.py\", line 3061, in _run_cell\n    result = runner(coro)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/async_helpers.py\", line 129, in _pseudo_sync_runner\n    coro.send(None)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/interactiveshell.py\", line 3266, in run_cell_async\n    has_raised = await self.run_ast_nodes(code_ast.body, cell_name,\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/interactiveshell.py\", line 3445, in run_ast_nodes\n    if await self.run_code(code, result, async_=asy):\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/interactiveshell.py\", line 3505, in run_code\n    exec(code_obj, self.user_global_ns, self.user_ns)\n  File \"/tmp/ipykernel_357/2379101916.py\", line 18, in <module>\n    fn(torch.randn(3))\n  File \"/tmp/ipykernel_357/2379101916.py\", line 14, in fn\n    torch._dynamo.graph_break()  # no error\n\n```\n\nUsingerror_on_graph_break(True)undererror_on_graph_break(False)is helpful for when we want to usetorch.compileflexibly (i.e. follow thefullgraph=Falseprogramming model),\nbut there are some sections of the code that are performance-critical and we want to ensure that those sections do not contain graph breaks.\nerror_on_graph_break(True)\nerror_on_graph_break(False)\ntorch.compile\nfullgraph=False\n\n## error_on_graph_breaknesting behavior#\n\nerror_on_graph_break\ntorch._dynamo.error_on_graph_break()affects theerror_on_graph_breaksetting of nested calls as well:\ntorch._dynamo.error_on_graph_break()\nerror_on_graph_break\n\n```python\ndef inner(x):\n    x = x + 1\n    torch._dynamo.graph_break()\n    return x + 2\n\ndef inner2(x):\n    with torch._dynamo.error_on_graph_break(False):\n        return inner(x)\n\n@torch._dynamo.error_on_graph_break(True)\n@torch.compile\ndef fn(x):\n    return inner2(x)\n\n# no error\nfn(torch.randn(3))\n\n```\n\n\n```python\nGraph break in user code at /tmp/ipykernel_357/1007149706.py:3\nGraph Break Reason: Call to `torch._dynamo.graph_break()`\n  Explanation: User-inserted graph break. Message: None\n  Hint: Remove the `torch._dynamo.graph_break()` call.\n\n  Developer debug context: Called `torch._dynamo.graph_break()` with args `[]`, kwargs `{}`\n\n For more details about this graph break, please visit: https://meta-pytorch.github.io/compile-graph-break-site/gb/gb0025.html\nUser code traceback:\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/runpy.py\", line 196, in _run_module_as_main\n    return _run_code(code, main_globals, None,\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/runpy.py\", line 86, in _run_code\n    exec(code, run_globals)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel_launcher.py\", line 18, in <module>\n    app.launch_new_instance()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/traitlets/config/application.py\", line 1075, in launch_instance\n    app.start()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/kernelapp.py\", line 758, in start\n    self.io_loop.start()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/tornado/platform/asyncio.py\", line 211, in start\n    self.asyncio_loop.run_forever()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/asyncio/base_events.py\", line 603, in run_forever\n    self._run_once()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/asyncio/base_events.py\", line 1909, in _run_once\n    handle._run()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/asyncio/events.py\", line 80, in _run\n    self._context.run(self._callback, *self._args)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/utils.py\", line 71, in preserve_context\n    return await f(*args, **kwargs)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/kernelbase.py\", line 614, in shell_main\n    await self.dispatch_shell(msg, subshell_id=subshell_id)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/kernelbase.py\", line 471, in dispatch_shell\n    await result\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/ipkernel.py\", line 366, in execute_request\n    await super().execute_request(stream, ident, parent)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/kernelbase.py\", line 827, in execute_request\n    reply_content = await reply_content\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/ipkernel.py\", line 458, in do_execute\n    res = shell.run_cell(\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/zmqshell.py\", line 663, in run_cell\n    return super().run_cell(*args, **kwargs)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/interactiveshell.py\", line 3006, in run_cell\n    result = self._run_cell(\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/interactiveshell.py\", line 3061, in _run_cell\n    result = runner(coro)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/async_helpers.py\", line 129, in _pseudo_sync_runner\n    coro.send(None)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/interactiveshell.py\", line 3266, in run_cell_async\n    has_raised = await self.run_ast_nodes(code_ast.body, cell_name,\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/interactiveshell.py\", line 3445, in run_ast_nodes\n    if await self.run_code(code, result, async_=asy):\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/interactiveshell.py\", line 3505, in run_code\n    exec(code_obj, self.user_global_ns, self.user_ns)\n  File \"/tmp/ipykernel_357/1007149706.py\", line 16, in <module>\n    fn(torch.randn(3))\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/_dynamo/external_utils.py\", line 209, in inner\n    return func(*args, **kwargs)\n  File \"/tmp/ipykernel_357/1007149706.py\", line 13, in fn\n    return inner2(x)\n  File \"/tmp/ipykernel_357/1007149706.py\", line 8, in inner2\n    return inner(x)\n  File \"/tmp/ipykernel_357/1007149706.py\", line 3, in inner\n    torch._dynamo.graph_break()\n\nGraph break (user stack suppressed due to duplicate graph break) in user code at /tmp/ipykernel_357/1007149706.py:3\nGraph Break Reason: Call to `torch._dynamo.graph_break()`\n  Explanation: User-inserted graph break. Message: None\n  Hint: Remove the `torch._dynamo.graph_break()` call.\n\n  Developer debug context: Called `torch._dynamo.graph_break()` with args `[]`, kwargs `{}`\n\n For more details about this graph break, please visit: https://meta-pytorch.github.io/compile-graph-break-site/gb/gb0025.html\nGraph break (user stack suppressed due to duplicate graph break) in user code at /tmp/ipykernel_357/1007149706.py:3\nGraph Break Reason: Call to `torch._dynamo.graph_break()`\n  Explanation: User-inserted graph break. Message: None\n  Hint: Remove the `torch._dynamo.graph_break()` call.\n\n  Developer debug context: Called `torch._dynamo.graph_break()` with args `[]`, kwargs `{}`\n\n For more details about this graph break, please visit: https://meta-pytorch.github.io/compile-graph-break-site/gb/gb0025.html\n\n```\n\n\n```python\ntensor([2.3742, 1.1152, 2.7729])\n\n```\n\ntorch._dynamo.error_on_graph_break()can be used under anothertorch._dynamo.error_on_graph_break()region:\ntorch._dynamo.error_on_graph_break()\ntorch._dynamo.error_on_graph_break()\n\n```python\ndef inner(x):\n    x = x + 1\n    with torch._dynamo.error_on_graph_break(False):\n        torch._dynamo.graph_break()\n    return x + 2\n\ndef inner2(x):\n    with torch._dynamo.error_on_graph_break(True):\n        return inner(x)\n\n@torch.compile\ndef fn(x):\n    return inner2(x)\n\n# no error\nfn(torch.randn(3))\n\n```\n\n\n```python\nGraph break in user code at /tmp/ipykernel_357/1343774799.py:4\nGraph Break Reason: Call to `torch._dynamo.graph_break()`\n  Explanation: User-inserted graph break. Message: None\n  Hint: Remove the `torch._dynamo.graph_break()` call.\n\n  Developer debug context: Called `torch._dynamo.graph_break()` with args `[]`, kwargs `{}`\n\n For more details about this graph break, please visit: https://meta-pytorch.github.io/compile-graph-break-site/gb/gb0025.html\nUser code traceback:\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/runpy.py\", line 196, in _run_module_as_main\n    return _run_code(code, main_globals, None,\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/runpy.py\", line 86, in _run_code\n    exec(code, run_globals)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel_launcher.py\", line 18, in <module>\n    app.launch_new_instance()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/traitlets/config/application.py\", line 1075, in launch_instance\n    app.start()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/kernelapp.py\", line 758, in start\n    self.io_loop.start()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/tornado/platform/asyncio.py\", line 211, in start\n    self.asyncio_loop.run_forever()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/asyncio/base_events.py\", line 603, in run_forever\n    self._run_once()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/asyncio/base_events.py\", line 1909, in _run_once\n    handle._run()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/asyncio/events.py\", line 80, in _run\n    self._context.run(self._callback, *self._args)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/utils.py\", line 71, in preserve_context\n    return await f(*args, **kwargs)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/kernelbase.py\", line 614, in shell_main\n    await self.dispatch_shell(msg, subshell_id=subshell_id)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/kernelbase.py\", line 471, in dispatch_shell\n    await result\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/ipkernel.py\", line 366, in execute_request\n    await super().execute_request(stream, ident, parent)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/kernelbase.py\", line 827, in execute_request\n    reply_content = await reply_content\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/ipkernel.py\", line 458, in do_execute\n    res = shell.run_cell(\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/zmqshell.py\", line 663, in run_cell\n    return super().run_cell(*args, **kwargs)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/interactiveshell.py\", line 3006, in run_cell\n    result = self._run_cell(\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/interactiveshell.py\", line 3061, in _run_cell\n    result = runner(coro)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/async_helpers.py\", line 129, in _pseudo_sync_runner\n    coro.send(None)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/interactiveshell.py\", line 3266, in run_cell_async\n    has_raised = await self.run_ast_nodes(code_ast.body, cell_name,\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/interactiveshell.py\", line 3445, in run_ast_nodes\n    if await self.run_code(code, result, async_=asy):\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/interactiveshell.py\", line 3505, in run_code\n    exec(code_obj, self.user_global_ns, self.user_ns)\n  File \"/tmp/ipykernel_357/1343774799.py\", line 16, in <module>\n    fn(torch.randn(3))\n  File \"/tmp/ipykernel_357/1343774799.py\", line 13, in fn\n    return inner2(x)\n  File \"/tmp/ipykernel_357/1343774799.py\", line 9, in inner2\n    return inner(x)\n  File \"/tmp/ipykernel_357/1343774799.py\", line 4, in inner\n    torch._dynamo.graph_break()\n\nGraph break (user stack suppressed due to duplicate graph break) in user code at /tmp/ipykernel_357/1343774799.py:4\nGraph Break Reason: Call to `torch._dynamo.graph_break()`\n  Explanation: User-inserted graph break. Message: None\n  Hint: Remove the `torch._dynamo.graph_break()` call.\n\n  Developer debug context: Called `torch._dynamo.graph_break()` with args `[]`, kwargs `{}`\n\n For more details about this graph break, please visit: https://meta-pytorch.github.io/compile-graph-break-site/gb/gb0025.html\nGraph break (user stack suppressed due to duplicate graph break) in user code at /tmp/ipykernel_357/1343774799.py:4\nGraph Break Reason: Call to `torch._dynamo.graph_break()`\n  Explanation: User-inserted graph break. Message: None\n  Hint: Remove the `torch._dynamo.graph_break()` call.\n\n  Developer debug context: Called `torch._dynamo.graph_break()` with args `[]`, kwargs `{}`\n\n For more details about this graph break, please visit: https://meta-pytorch.github.io/compile-graph-break-site/gb/gb0025.html\n\n```\n\n\n```python\ntensor([3.5156, 2.9280, 3.7220])\n\n```\n\n\n## Interaction withfullgraph#\n\nfullgraph\nfullgraph=Truetakes higher precedence thanerror_on_graph_break:\nfullgraph=True\nerror_on_graph_break\n\n```python\n@torch._dynamo.error_on_graph_break(False)\ndef inner(x):\n    x = x + 1\n    torch._dynamo.graph_break()\n    return x + 2\n\n@torch.compile(fullgraph=True)\ndef fn(x):\n    return inner(x)\n\ntry:\n    fn(torch.randn(3))\nexcept Exception as e:\n    print(e)\n\n```\n\n\n```python\nCall to `torch._dynamo.graph_break()`\n  Explanation: User-inserted graph break. Message: None\n  Hint: Remove the `torch._dynamo.graph_break()` call.\n\n  Developer debug context: Called `torch._dynamo.graph_break()` with args `[]`, kwargs `{}`\n\n For more details about this graph break, please visit: https://meta-pytorch.github.io/compile-graph-break-site/gb/gb0025.html\n\nfrom user code:\n   File \"/tmp/ipykernel_357/2331424258.py\", line 9, in fn\n    return inner(x)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/_dynamo/external_utils.py\", line 209, in inner\n    return func(*args, **kwargs)\n  File \"/tmp/ipykernel_357/2331424258.py\", line 3, in inner\n    x = x + 1\n\nSet TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS=\"+dynamo\"\n\n```\n\nfullgraph=Truecannot be toggled back tofullgraph=False:\nfullgraph=True\nfullgraph=False\n\n```python\n@torch.compile(fullgraph=False)\ndef inner(x):\n    x = x + 1\n    torch._dynamo.graph_break()\n    return x + 2\n\n@torch.compile(fullgraph=True)\ndef fn(x):\n    return inner(x)\n\ntry:\n    fn(torch.randn(3))\nexcept Exception as e:\n    print(e)\n\n```\n\n\n```python\nCall to `torch._dynamo.graph_break()`\n  Explanation: User-inserted graph break. Message: None\n  Hint: Remove the `torch._dynamo.graph_break()` call.\n\n  Developer debug context: Called `torch._dynamo.graph_break()` with args `[]`, kwargs `{}`\n\n For more details about this graph break, please visit: https://meta-pytorch.github.io/compile-graph-break-site/gb/gb0025.html\n\nfrom user code:\n   File \"/tmp/ipykernel_357/262151723.py\", line 9, in fn\n    return inner(x)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/_dynamo/polyfills/__init__.py\", line 264, in getattr_and_trace\n    return fn(*args[2:], **kwargs)\n  File \"/tmp/ipykernel_357/262151723.py\", line 3, in inner\n    x = x + 1\n\nSet TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS=\"+dynamo\"\n\n```\n\n\n```python\n@torch.compile(fullgraph=True)\ndef inner(x):\n    x = x + 1\n    torch._dynamo.graph_break()\n    return x + 2\n\n@torch.compile(fullgraph=False)\ndef fn(x):\n    return inner(x)\n\ntry:\n    fn(torch.randn(3))\nexcept Exception as e:\n    print(e)\n\n```\n\n\n```python\nCall to `torch._dynamo.graph_break()`\n  Explanation: User-inserted graph break. Message: None\n  Hint: Remove the `torch._dynamo.graph_break()` call.\n\n  Developer debug context: Called `torch._dynamo.graph_break()` with args `[]`, kwargs `{}`\n\n For more details about this graph break, please visit: https://meta-pytorch.github.io/compile-graph-break-site/gb/gb0025.html\n\nfrom user code:\n   File \"/tmp/ipykernel_357/2119173801.py\", line 3, in inner\n    x = x + 1\n\nSet TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS=\"+dynamo\"\n\n```\n\n\n```python\nGraph break in user code at /tmp/ipykernel_357/2119173801.py:3\nGraph Break Reason: Call to `torch._dynamo.graph_break()`\n  Explanation: User-inserted graph break. Message: None\n  Hint: Remove the `torch._dynamo.graph_break()` call.\n\n  Developer debug context: Called `torch._dynamo.graph_break()` with args `[]`, kwargs `{}`\n\n For more details about this graph break, please visit: https://meta-pytorch.github.io/compile-graph-break-site/gb/gb0025.html\nUser code traceback:\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/runpy.py\", line 196, in _run_module_as_main\n    return _run_code(code, main_globals, None,\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/runpy.py\", line 86, in _run_code\n    exec(code, run_globals)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel_launcher.py\", line 18, in <module>\n    app.launch_new_instance()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/traitlets/config/application.py\", line 1075, in launch_instance\n    app.start()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/kernelapp.py\", line 758, in start\n    self.io_loop.start()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/tornado/platform/asyncio.py\", line 211, in start\n    self.asyncio_loop.run_forever()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/asyncio/base_events.py\", line 603, in run_forever\n    self._run_once()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/asyncio/base_events.py\", line 1909, in _run_once\n    handle._run()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/asyncio/events.py\", line 80, in _run\n    self._context.run(self._callback, *self._args)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/utils.py\", line 71, in preserve_context\n    return await f(*args, **kwargs)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/kernelbase.py\", line 614, in shell_main\n    await self.dispatch_shell(msg, subshell_id=subshell_id)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/kernelbase.py\", line 471, in dispatch_shell\n    await result\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/ipkernel.py\", line 366, in execute_request\n    await super().execute_request(stream, ident, parent)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/kernelbase.py\", line 827, in execute_request\n    reply_content = await reply_content\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/ipkernel.py\", line 458, in do_execute\n    res = shell.run_cell(\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/zmqshell.py\", line 663, in run_cell\n    return super().run_cell(*args, **kwargs)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/interactiveshell.py\", line 3006, in run_cell\n    result = self._run_cell(\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/interactiveshell.py\", line 3061, in _run_cell\n    result = runner(coro)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/async_helpers.py\", line 129, in _pseudo_sync_runner\n    coro.send(None)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/interactiveshell.py\", line 3266, in run_cell_async\n    has_raised = await self.run_ast_nodes(code_ast.body, cell_name,\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/interactiveshell.py\", line 3445, in run_ast_nodes\n    if await self.run_code(code, result, async_=asy):\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/interactiveshell.py\", line 3505, in run_code\n    exec(code_obj, self.user_global_ns, self.user_ns)\n  File \"/tmp/ipykernel_357/2119173801.py\", line 12, in <module>\n    fn(torch.randn(3))\n  File \"/tmp/ipykernel_357/2119173801.py\", line 9, in fn\n    return inner(x)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/_dynamo/polyfills/__init__.py\", line 264, in getattr_and_trace\n    return fn(*args[2:], **kwargs)\n  File \"/tmp/ipykernel_357/2119173801.py\", line 3, in inner\n    x = x + 1\n\n```\n\n\n## Summary offullgraph=True/Falsevserror_on_graph_break#\n\nfullgraph=True/False\nerror_on_graph_break\nHere is a table summarizing the differences betweenfullgraph=True/Falseanderror_on_graph_break:\nfullgraph=True/False\nerror_on_graph_break\n\nerror_on_graph_break=True\nerror_on_graph_break=True\nerror_on_graph_break=False(default)\nerror_on_graph_break=False\nfullgraph=True\nfullgraph=True\nGraph breaks result in errors. Only the first graph break will be reported.One graph guarantee.fullgraphcannot be toggled toFalse.error_on_graph_breakhas no effect.User code must be fully compatible withtorch.compile. Guarantees no performance hits from graph breaks (because there are no graph breaks).Ideal for code sensitive to graph breaks: framework/library code or cases where getting maximum performance is required. Prevents downstream user code from inadvertently allowing graph breaks.\nfullgraph\nFalse\nerror_on_graph_break\ntorch.compile\nSame asfullgraph=Trueanderror_on_graph_break=Trueaserror_on_graph_breakhas no effect whenfullgraph=True.\nfullgraph=True\nerror_on_graph_break=True\nerror_on_graph_break\nfullgraph=True\nfullgraph=False(default)\nfullgraph=False\nGraph breaks result in errors. Only the first graph break will be reported.No one graph guarantee.error_on_graph_breakcan be toggled toFalse.User code must be fully compatible withtorch.compile. Guarantees no performance hits from graph breaks (because there are no graph breaks).Ideal for user code sensitive to graph breaks.error_on_graph_breakcan be toggled toFalseto deal with sections that have graph breaks that are difficult to work around.\nerror_on_graph_break\nFalse\ntorch.compile\nerror_on_graph_break\nFalse\nWill continue to compile after encountering graph breaks. All graph breaks will be reported.error_on_graph_breakcan be toggled toTrue.Doesn\u2019t require many user code changes to work. Performance may be negatively impacted due to graph breaks.Ideal for out-of-the-box use cases, on \u201cnon-weird\u201d code, or where squeezing maximal performance is not necessary\nerror_on_graph_break\nTrue",
  "url": "https://pytorch.org/docs/stable/compile/programming_model.error_on_graph_break.html",
  "metadata": {
    "section": null,
    "issue_number": null,
    "labels": null,
    "answer_author": null
  }
}