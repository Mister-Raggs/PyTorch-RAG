{
  "doc_id": "fd2dd8830ab2bd0b8a47c949060f7880",
  "source": "pytorch_docs",
  "title": "torch.mps \u2014 PyTorch 2.9 documentation",
  "text": "\n## torch.mps#\n\nCreated On: Feb 10, 2023 | Last Updated On: Jun 08, 2025\nThis package enables an interface for accessing MPS (Metal Performance Shaders) backend in Python.\nMetal is Apple\u2019s API for programming metal GPU (graphics processor unit). Using MPS means that increased\nperformance can be achieved, by running work on the metal GPU(s).\nSeehttps://developer.apple.com/documentation/metalperformanceshadersfor more details.\ndevice_count\n\ndevice_count\nReturns the number of available MPS devices.\nsynchronize\n\nsynchronize\nWaits for all kernels in all streams on a MPS device to complete.\nget_rng_state\n\nget_rng_state\nReturns the random number generator state as a ByteTensor.\nset_rng_state\n\nset_rng_state\nSets the random number generator state.\nmanual_seed\n\nmanual_seed\nSets the seed for generating random numbers.\nseed\n\nseed\nSets the seed for generating random numbers to a random number.\nempty_cache\n\nempty_cache\nReleases all unoccupied cached memory currently held by the caching allocator so that those can be used in other GPU applications.\nset_per_process_memory_fraction\n\nset_per_process_memory_fraction\nSet memory fraction for limiting process's memory allocation on MPS device.\ncurrent_allocated_memory\n\ncurrent_allocated_memory\nReturns the current GPU memory occupied by tensors in bytes.\ndriver_allocated_memory\n\ndriver_allocated_memory\nReturns total GPU memory allocated by Metal driver for the process in bytes.\nrecommended_max_memory\n\nrecommended_max_memory\nReturns recommended max Working set size for GPU memory in bytes.\ncompile_shader\n\ncompile_shader\nCompiles compute shader from source and allows one to invoke kernels defined there from the comfort of Python runtime Example.\n\n## MPS Profiler#\n\nprofiler.start\nprofiler.start\nStart OS Signpost tracing from MPS backend.\nprofiler.stop\nprofiler.stop\nStops generating OS Signpost tracing from MPS backend.\nprofiler.profile\nprofiler.profile\nContext Manager to enabling generating OS Signpost tracing from MPS backend.\nprofiler.is_capturing_metal\nprofiler.is_capturing_metal\nChecks if metal capture is in progress\nprofiler.is_metal_capture_enabled\nprofiler.is_metal_capture_enabled\nChecks ifmetal_capturecontext manager is usable To enable metal capture, set MTL_CAPTURE_ENABLED envvar\nprofiler.metal_capture\nprofiler.metal_capture\nContext manager that enables capturing of Metal calls into gputrace\n\n## MPS Event#\n\nevent.Event\nevent.Event\nWrapper around an MPS event.",
  "url": "https://pytorch.org/docs/stable/mps.html",
  "metadata": {
    "section": null,
    "issue_number": null,
    "labels": null,
    "answer_author": null
  }
}