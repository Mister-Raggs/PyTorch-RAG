{
  "doc_id": "278511eef8901180455cf38e3823b141",
  "source": "pytorch_docs",
  "title": "Skipped Functions \u2014 PyTorch 2.9 documentation",
  "text": "\n## Skipped Functions#\n\nCreated On: Jul 28, 2025 | Last Updated On: Jul 29, 2025\nSummary:\nSometimes,torch.compilecompletely gives up compiling a function and runs it eagerly instead,\nresulting in potentially lost optimization opportunities.\ntorch.compile\nThere are ways to work around skipped functions in order to re-enable tracing around the problematic code.\nSometimes,torch.compilewithfullgraph=Falseis unable to resume tracing when encountering a graph break\nor other compiler error. In many of these cases,torch.compilewill skip compiling the function entirely and run it eagerly.\ntorch.compile\nfullgraph=False\ntorch.compile\nNote that the skip is only applied to the current function and NOT any nested function calls.torch.compilewill still attempt to compile nested calls.\ntorch.compile\n\n```python\ndef inner1(x):\n    return x + 1\ndef inner2(x):\n    return x + 2\n@torch.compile\ndef fn(x):\n    x = inner1(x)\n    torch._dynamo.skip_frame()\n    x = inner2(x)\nfn(torch.randn(3))\n\n```\n\n\n```python\nChromiumEventLogger initialized with id 23519bca-29f9-476e-84a4-2aecfc50de2d\ntorchdynamo start compiling fn /tmp/ipykernel_532/2126697152.py:5, stack (elided 5 frames):\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/runpy.py\", line 196, in _run_module_as_main\n    return _run_code(code, main_globals, None,\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/runpy.py\", line 86, in _run_code\n    exec(code, run_globals)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel_launcher.py\", line 18, in <module>\n    app.launch_new_instance()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/traitlets/config/application.py\", line 1075, in launch_instance\n    app.start()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/kernelapp.py\", line 758, in start\n    self.io_loop.start()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/tornado/platform/asyncio.py\", line 211, in start\n    self.asyncio_loop.run_forever()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/asyncio/base_events.py\", line 603, in run_forever\n    self._run_once()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/asyncio/base_events.py\", line 1909, in _run_once\n    handle._run()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/asyncio/events.py\", line 80, in _run\n    self._context.run(self._callback, *self._args)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/utils.py\", line 71, in preserve_context\n    return await f(*args, **kwargs)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/kernelbase.py\", line 614, in shell_main\n    await self.dispatch_shell(msg, subshell_id=subshell_id)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/kernelbase.py\", line 471, in dispatch_shell\n    await result\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/ipkernel.py\", line 366, in execute_request\n    await super().execute_request(stream, ident, parent)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/kernelbase.py\", line 827, in execute_request\n    reply_content = await reply_content\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/ipkernel.py\", line 458, in do_execute\n    res = shell.run_cell(\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/zmqshell.py\", line 663, in run_cell\n    return super().run_cell(*args, **kwargs)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/interactiveshell.py\", line 3006, in run_cell\n    result = self._run_cell(\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/interactiveshell.py\", line 3061, in _run_cell\n    result = runner(coro)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/async_helpers.py\", line 129, in _pseudo_sync_runner\n    coro.send(None)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/interactiveshell.py\", line 3266, in run_cell_async\n    has_raised = await self.run_ast_nodes(code_ast.body, cell_name,\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/interactiveshell.py\", line 3445, in run_ast_nodes\n    if await self.run_code(code, result, async_=asy):\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/interactiveshell.py\", line 3505, in run_code\n    exec(code_obj, self.user_global_ns, self.user_ns)\n  File \"/tmp/ipykernel_532/2126697152.py\", line 10, in <module>\n    fn(torch.randn(3))\n\nStep 1: torchdynamo start tracing fn /tmp/ipykernel_532/2126697152.py:5\ncreate_env\nTRACE starts_line /tmp/ipykernel_532/2126697152.py:7 in fn\n        x = inner1(x)\nTRACE LOAD_GLOBAL inner1 []\nTRACE LOAD_FAST x [LazyVariableTracker()]\nTRACE CALL_FUNCTION 1 [LazyVariableTracker(), LazyVariableTracker()]\nINLINING <code object inner1 at 0x7fabe826a340, file \"/tmp/ipykernel_532/2126697152.py\", line 1>, inlined according trace_rules.lookup inlined by default\nwrap_to_fake L['x'] (3,) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None], constraint_strides=[None], specialize_on=[[]], view_base_context=None, tensor_source=LocalSource(local_name='x', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>\ncreate_graph_input L_x_ L['x'] FakeTensor(..., size=(3,)) at debug_level 0 before=False\nTRACE starts_line /tmp/ipykernel_532/2126697152.py:2 in inner1 (inline depth: 1)\n        return x + 1\nTRACE LOAD_FAST x []\nTRACE LOAD_CONST 1 [TensorVariable()]\nTRACE BINARY_ADD None [TensorVariable(), ConstantVariable(int: 1)]\nTRACE RETURN_VALUE None [TensorVariable()]\nDONE INLINING <code object inner1 at 0x7fabe826a340, file \"/tmp/ipykernel_532/2126697152.py\", line 1>\nTRACE STORE_FAST x [TensorVariable()]\nTRACE starts_line /tmp/ipykernel_532/2126697152.py:8 in fn\n        torch._dynamo.skip_frame()\nTRACE LOAD_GLOBAL torch []\nTRACE LOAD_ATTR _dynamo [LazyVariableTracker()]\nTRACE LOAD_ATTR skip_frame [LazyVariableTracker()]\nTRACE CALL_FUNCTION 0 [LazyVariableTracker()]\nSkipping frame Skip frame due to `torch._dynamo.skip_frame()`. Message: None fn                 /tmp/ipykernel_532/2126697152.py 5\nput_code_state: no cache key, skipping\nrun_gc_after_compile: running gc\ntorchdynamo start compiling inner1 /tmp/ipykernel_532/2126697152.py:1, stack (elided 5 frames):\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/runpy.py\", line 196, in _run_module_as_main\n    return _run_code(code, main_globals, None,\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/runpy.py\", line 86, in _run_code\n    exec(code, run_globals)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel_launcher.py\", line 18, in <module>\n    app.launch_new_instance()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/traitlets/config/application.py\", line 1075, in launch_instance\n    app.start()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/kernelapp.py\", line 758, in start\n    self.io_loop.start()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/tornado/platform/asyncio.py\", line 211, in start\n    self.asyncio_loop.run_forever()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/asyncio/base_events.py\", line 603, in run_forever\n    self._run_once()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/asyncio/base_events.py\", line 1909, in _run_once\n    handle._run()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/asyncio/events.py\", line 80, in _run\n    self._context.run(self._callback, *self._args)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/utils.py\", line 71, in preserve_context\n    return await f(*args, **kwargs)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/kernelbase.py\", line 614, in shell_main\n    await self.dispatch_shell(msg, subshell_id=subshell_id)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/kernelbase.py\", line 471, in dispatch_shell\n    await result\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/ipkernel.py\", line 366, in execute_request\n    await super().execute_request(stream, ident, parent)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/kernelbase.py\", line 827, in execute_request\n    reply_content = await reply_content\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/ipkernel.py\", line 458, in do_execute\n    res = shell.run_cell(\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/zmqshell.py\", line 663, in run_cell\n    return super().run_cell(*args, **kwargs)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/interactiveshell.py\", line 3006, in run_cell\n    result = self._run_cell(\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/interactiveshell.py\", line 3061, in _run_cell\n    result = runner(coro)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/async_helpers.py\", line 129, in _pseudo_sync_runner\n    coro.send(None)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/interactiveshell.py\", line 3266, in run_cell_async\n    has_raised = await self.run_ast_nodes(code_ast.body, cell_name,\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/interactiveshell.py\", line 3445, in run_ast_nodes\n    if await self.run_code(code, result, async_=asy):\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/interactiveshell.py\", line 3505, in run_code\n    exec(code_obj, self.user_global_ns, self.user_ns)\n  File \"/tmp/ipykernel_532/2126697152.py\", line 10, in <module>\n    fn(torch.randn(3))\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py\", line 832, in compile_wrapper\n    return fn(*args, **kwargs)\n\nStep 1: torchdynamo start tracing inner1 /tmp/ipykernel_532/2126697152.py:1\ncreate_env\nTRACE starts_line /tmp/ipykernel_532/2126697152.py:2 in inner1\n        return x + 1\nTRACE LOAD_FAST x []\nTRACE LOAD_CONST 1 [LazyVariableTracker()]\nTRACE BINARY_ADD None [LazyVariableTracker(), ConstantVariable(int: 1)]\nwrap_to_fake L['x'] (3,) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None], constraint_strides=[None], specialize_on=[[]], view_base_context=None, tensor_source=LocalSource(local_name='x', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>\ncreate_graph_input L_x_ L['x'] FakeTensor(..., size=(3,)) at debug_level 0 before=False\nTRACE RETURN_VALUE None [TensorVariable()]\nStep 1: torchdynamo done tracing inner1 (RETURN_VALUE)\nRETURN_VALUE triggered compile\nCOMPILING GRAPH due to GraphCompileReason(reason='return_value', user_stack=[<FrameSummary file /tmp/ipykernel_532/2126697152.py, line 2 in inner1>], graph_break=False)\nTRACED GRAPH\n ===== __compiled_fn_2_9a47d8a0_0722_48b1_8b6d_8892f4ce7d34 =====\n /opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/fx/_lazy_graph_module.py class GraphModule(torch.nn.Module):\n    def forward(self, L_x_: \"f32[3][1]cpu\"):\n        l_x_ = L_x_\n        \n         # File: /tmp/ipykernel_532/2126697152.py:2 in inner1, code: return x + 1\n        add: \"f32[3][1]cpu\" = l_x_ + 1;  l_x_ = None\n        return (add,)\n        \n\nStep 2: calling compiler function eager\nStep 2: done compiler function eager\nproduce_guards\ntrack_symint L['x'].size()[0] 3 None\ntrack_symint L['x'].stride()[0] 1 None\ntrack_symint L['x'].storage_offset() 0 None\nSkipping guard L['x'].size()[0] == 3\nSkipping guard L['x'].stride()[0] == 1\nSkipping guard L['x'].storage_offset() == 0\nGUARDS:\n\nTREE_GUARD_MANAGER:\n+- RootGuardManager\n| +- LAMBDA_GUARD: torch._functorch.aot_autograd.utils.top_saved_tensors_hooks ids == None  # _dynamo/output_graph.py:688 in init_ambient_guards\n| +- DEFAULT_DEVICE: utils_device.CURRENT_DEVICE == None                           # _dynamo/output_graph.py:676 in init_ambient_guards\n| +- GLOBAL_STATE: ___check_global_state()\n| +- TORCH_FUNCTION_MODE_STACK: ___check_torch_function_mode_stack()\n| +- GuardManager: source=L['x'], accessed_by=FrameLocalsGuardAccessor(key='x', framelocals_idx=0), type=<class 'torch.Tensor'>, tag_safe=(True, False)\n| | +- TENSOR_MATCH: check_tensor(L['x'], Tensor, DispatchKeySet(CPU, BackendSelect, ADInplaceOrView, AutogradCPU), torch.float32, device=None, requires_grad=False, size=[3], stride=[1])  # return x + 1  # mp/ipykernel_532/2126697152.py:2 in inner1\n| | +- NO_HASATTR: hasattr(L['x'], '_dynamo_dynamic_indices') == False           # return x + 1  # mp/ipykernel_532/2126697152.py:2 in inner1\n\nGuard eval latency = 72.12 us\nput_code_state: no cache key, skipping\nrun_gc_after_compile: running gc\nskipping: inner (reason: in skipfiles, file: /opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/_compile.py)\nskipping: disable (reason: in skipfiles, file: /opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/_dynamo/decorators.py)\nskipping: innermost_fn (reason: in skipfiles, file: /opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py)\nskipping: __init__ (reason: in skipfiles, file: /opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py)\nskipping: __init__ (reason: in skipfiles, file: /opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py)\nskipping: nothing (reason: in skipfiles, file: /opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py)\nskipping: __call__ (reason: in skipfiles, file: /opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py)\nskipping: _fn (reason: in skipfiles, file: /opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py)\nskipping: skip_frame (reason: in skipfiles, file: /opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/_dynamo/decorators.py)\ntorchdynamo start compiling inner2 /tmp/ipykernel_532/2126697152.py:3, stack (elided 5 frames):\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/runpy.py\", line 196, in _run_module_as_main\n    return _run_code(code, main_globals, None,\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/runpy.py\", line 86, in _run_code\n    exec(code, run_globals)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel_launcher.py\", line 18, in <module>\n    app.launch_new_instance()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/traitlets/config/application.py\", line 1075, in launch_instance\n    app.start()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/kernelapp.py\", line 758, in start\n    self.io_loop.start()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/tornado/platform/asyncio.py\", line 211, in start\n    self.asyncio_loop.run_forever()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/asyncio/base_events.py\", line 603, in run_forever\n    self._run_once()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/asyncio/base_events.py\", line 1909, in _run_once\n    handle._run()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/asyncio/events.py\", line 80, in _run\n    self._context.run(self._callback, *self._args)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/utils.py\", line 71, in preserve_context\n    return await f(*args, **kwargs)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/kernelbase.py\", line 614, in shell_main\n    await self.dispatch_shell(msg, subshell_id=subshell_id)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/kernelbase.py\", line 471, in dispatch_shell\n    await result\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/ipkernel.py\", line 366, in execute_request\n    await super().execute_request(stream, ident, parent)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/kernelbase.py\", line 827, in execute_request\n    reply_content = await reply_content\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/ipkernel.py\", line 458, in do_execute\n    res = shell.run_cell(\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/zmqshell.py\", line 663, in run_cell\n    return super().run_cell(*args, **kwargs)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/interactiveshell.py\", line 3006, in run_cell\n    result = self._run_cell(\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/interactiveshell.py\", line 3061, in _run_cell\n    result = runner(coro)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/async_helpers.py\", line 129, in _pseudo_sync_runner\n    coro.send(None)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/interactiveshell.py\", line 3266, in run_cell_async\n    has_raised = await self.run_ast_nodes(code_ast.body, cell_name,\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/interactiveshell.py\", line 3445, in run_ast_nodes\n    if await self.run_code(code, result, async_=asy):\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/interactiveshell.py\", line 3505, in run_code\n    exec(code_obj, self.user_global_ns, self.user_ns)\n  File \"/tmp/ipykernel_532/2126697152.py\", line 10, in <module>\n    fn(torch.randn(3))\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py\", line 832, in compile_wrapper\n    return fn(*args, **kwargs)\n\nStep 1: torchdynamo start tracing inner2 /tmp/ipykernel_532/2126697152.py:3\ncreate_env\nTRACE starts_line /tmp/ipykernel_532/2126697152.py:4 in inner2\n        return x + 2\nTRACE LOAD_FAST x []\nTRACE LOAD_CONST 2 [LazyVariableTracker()]\nTRACE BINARY_ADD None [LazyVariableTracker(), ConstantVariable(int: 2)]\nwrap_to_fake L['x'] (3,) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None], constraint_strides=[None], specialize_on=[[]], view_base_context=None, tensor_source=LocalSource(local_name='x', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>\ncreate_graph_input L_x_ L['x'] FakeTensor(..., size=(3,)) at debug_level 0 before=False\nTRACE RETURN_VALUE None [TensorVariable()]\nStep 1: torchdynamo done tracing inner2 (RETURN_VALUE)\nRETURN_VALUE triggered compile\nCOMPILING GRAPH due to GraphCompileReason(reason='return_value', user_stack=[<FrameSummary file /tmp/ipykernel_532/2126697152.py, line 4 in inner2>], graph_break=False)\nTRACED GRAPH\n ===== __compiled_fn_4_c777bb3e_3a95_481d_9fa6_aca3bc776228 =====\n /opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/fx/_lazy_graph_module.py class GraphModule(torch.nn.Module):\n    def forward(self, L_x_: \"f32[3][1]cpu\"):\n        l_x_ = L_x_\n        \n         # File: /tmp/ipykernel_532/2126697152.py:4 in inner2, code: return x + 2\n        add: \"f32[3][1]cpu\" = l_x_ + 2;  l_x_ = None\n        return (add,)\n        \n\nStep 2: calling compiler function eager\nStep 2: done compiler function eager\nproduce_guards\ntrack_symint L['x'].size()[0] 3 None\ntrack_symint L['x'].stride()[0] 1 None\ntrack_symint L['x'].storage_offset() 0 None\nSkipping guard L['x'].size()[0] == 3\nSkipping guard L['x'].stride()[0] == 1\nSkipping guard L['x'].storage_offset() == 0\nGUARDS:\n\nTREE_GUARD_MANAGER:\n+- RootGuardManager\n| +- LAMBDA_GUARD: torch._functorch.aot_autograd.utils.top_saved_tensors_hooks ids == None  # _dynamo/output_graph.py:688 in init_ambient_guards\n| +- DEFAULT_DEVICE: utils_device.CURRENT_DEVICE == None                           # _dynamo/output_graph.py:676 in init_ambient_guards\n| +- GLOBAL_STATE: ___check_global_state()\n| +- TORCH_FUNCTION_MODE_STACK: ___check_torch_function_mode_stack()\n| +- GuardManager: source=L['x'], accessed_by=FrameLocalsGuardAccessor(key='x', framelocals_idx=0), type=<class 'torch.Tensor'>, tag_safe=(True, False)\n| | +- TENSOR_MATCH: check_tensor(L['x'], Tensor, DispatchKeySet(CPU, BackendSelect, ADInplaceOrView, AutogradCPU), torch.float32, device=None, requires_grad=False, size=[3], stride=[1])  # return x + 2  # mp/ipykernel_532/2126697152.py:4 in inner2\n| | +- NO_HASATTR: hasattr(L['x'], '_dynamo_dynamic_indices') == False           # return x + 2  # mp/ipykernel_532/2126697152.py:4 in inner2\n\nGuard eval latency = 66.29 us\nput_code_state: no cache key, skipping\nrun_gc_after_compile: running gc\nskipping: remove (reason: in skipfiles, file: /opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/utils/weak.py)\nskipping: __hash__ (reason: in skipfiles, file: /opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/utils/weak.py)\n\n```\n\nIn the above example,torch.compilewill tracefn(includinginner1) up until theskip_frame.\nThenfnis skipped and run eagerly -inner1andinner2are compiled when they are called.\ntorch.compile\nfn\ninner1\nskip_frame\nfn\ninner1\ninner2\nSkipping functions may result in lost optimization opportunities,\nso it is important to check if code you want compiled is being skipped, and if so, to work around the skip.\n\n## Graph Break in a Loop#\n\ntorch.compilecannot resume tracing if a graph break occurs in a loop:\ntorch.compile\n\n```python\n@torch.compile\ndef fn(x):\n    for i in range(5):\n        x = x + 1\n        if i == 3:\n            torch._dynamo.graph_break()\n    return x\nfn(torch.randn(3))\n\n```\n\n\n```python\ntorchdynamo start compiling fn /tmp/ipykernel_532/2044822433.py:1, stack (elided 5 frames):\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/runpy.py\", line 196, in _run_module_as_main\n    return _run_code(code, main_globals, None,\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/runpy.py\", line 86, in _run_code\n    exec(code, run_globals)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel_launcher.py\", line 18, in <module>\n    app.launch_new_instance()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/traitlets/config/application.py\", line 1075, in launch_instance\n    app.start()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/kernelapp.py\", line 758, in start\n    self.io_loop.start()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/tornado/platform/asyncio.py\", line 211, in start\n    self.asyncio_loop.run_forever()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/asyncio/base_events.py\", line 603, in run_forever\n    self._run_once()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/asyncio/base_events.py\", line 1909, in _run_once\n    handle._run()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/asyncio/events.py\", line 80, in _run\n    self._context.run(self._callback, *self._args)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/utils.py\", line 71, in preserve_context\n    return await f(*args, **kwargs)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/kernelbase.py\", line 614, in shell_main\n    await self.dispatch_shell(msg, subshell_id=subshell_id)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/kernelbase.py\", line 471, in dispatch_shell\n    await result\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/ipkernel.py\", line 366, in execute_request\n    await super().execute_request(stream, ident, parent)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/kernelbase.py\", line 827, in execute_request\n    reply_content = await reply_content\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/ipkernel.py\", line 458, in do_execute\n    res = shell.run_cell(\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/zmqshell.py\", line 663, in run_cell\n    return super().run_cell(*args, **kwargs)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/interactiveshell.py\", line 3006, in run_cell\n    result = self._run_cell(\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/interactiveshell.py\", line 3061, in _run_cell\n    result = runner(coro)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/async_helpers.py\", line 129, in _pseudo_sync_runner\n    coro.send(None)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/interactiveshell.py\", line 3266, in run_cell_async\n    has_raised = await self.run_ast_nodes(code_ast.body, cell_name,\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/interactiveshell.py\", line 3445, in run_ast_nodes\n    if await self.run_code(code, result, async_=asy):\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/interactiveshell.py\", line 3505, in run_code\n    exec(code_obj, self.user_global_ns, self.user_ns)\n  File \"/tmp/ipykernel_532/2044822433.py\", line 8, in <module>\n    fn(torch.randn(3))\n\nStep 1: torchdynamo start tracing fn /tmp/ipykernel_532/2044822433.py:1\ncreate_env\nTRACE starts_line /tmp/ipykernel_532/2044822433.py:3 in fn\n        for i in range(5):\nTRACE LOAD_GLOBAL range []\nTRACE LOAD_CONST 5 [LazyVariableTracker()]\nTRACE CALL_FUNCTION 1 [LazyVariableTracker(), ConstantVariable(int: 5)]\nTRACE GET_ITER None [RangeVariable()]\nTRACE FOR_ITER 40 [RangeIteratorVariable()]\nTRACE STORE_FAST i [RangeIteratorVariable(), ConstantVariable(int: 0)]\nTRACE starts_line /tmp/ipykernel_532/2044822433.py:4 in fn\n            x = x + 1\nTRACE LOAD_FAST x [RangeIteratorVariable()]\nTRACE LOAD_CONST 1 [RangeIteratorVariable(), LazyVariableTracker()]\nTRACE BINARY_ADD None [RangeIteratorVariable(), LazyVariableTracker(), ConstantVariable(int: 1)]\nwrap_to_fake L['x'] (3,) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None], constraint_strides=[None], specialize_on=[[]], view_base_context=None, tensor_source=LocalSource(local_name='x', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>\ncreate_graph_input L_x_ L['x'] FakeTensor(..., size=(3,)) at debug_level 0 before=False\nTRACE STORE_FAST x [RangeIteratorVariable(), TensorVariable()]\nTRACE starts_line /tmp/ipykernel_532/2044822433.py:5 in fn\n            if i == 3:\nTRACE LOAD_FAST i [RangeIteratorVariable()]\nTRACE LOAD_CONST 3 [RangeIteratorVariable(), ConstantVariable(int: 0)]\nTRACE COMPARE_OP == [RangeIteratorVariable(), ConstantVariable(int: 0), ConstantVariable(int: 3)]\nTRACE POP_JUMP_IF_FALSE 38 [RangeIteratorVariable(), ConstantVariable(bool: False)]\nTRACE starts_line /tmp/ipykernel_532/2044822433.py:6 in fn\n                torch._dynamo.graph_break()\nTRACE JUMP_ABSOLUTE 8 [RangeIteratorVariable()]\nTRACE starts_line /tmp/ipykernel_532/2044822433.py:3 in fn\n        for i in range(5):\nTRACE FOR_ITER 40 [RangeIteratorVariable()]\nTRACE STORE_FAST i [RangeIteratorVariable(), ConstantVariable(int: 1)]\nTRACE starts_line /tmp/ipykernel_532/2044822433.py:4 in fn\n            x = x + 1\nTRACE LOAD_FAST x [RangeIteratorVariable()]\nTRACE LOAD_CONST 1 [RangeIteratorVariable(), TensorVariable()]\nTRACE BINARY_ADD None [RangeIteratorVariable(), TensorVariable(), ConstantVariable(int: 1)]\nTRACE STORE_FAST x [RangeIteratorVariable(), TensorVariable()]\nTRACE starts_line /tmp/ipykernel_532/2044822433.py:5 in fn\n            if i == 3:\nTRACE LOAD_FAST i [RangeIteratorVariable()]\nTRACE LOAD_CONST 3 [RangeIteratorVariable(), ConstantVariable(int: 1)]\nTRACE COMPARE_OP == [RangeIteratorVariable(), ConstantVariable(int: 1), ConstantVariable(int: 3)]\nTRACE POP_JUMP_IF_FALSE 38 [RangeIteratorVariable(), ConstantVariable(bool: False)]\nTRACE starts_line /tmp/ipykernel_532/2044822433.py:6 in fn\n                torch._dynamo.graph_break()\nTRACE JUMP_ABSOLUTE 8 [RangeIteratorVariable()]\nTRACE starts_line /tmp/ipykernel_532/2044822433.py:3 in fn\n        for i in range(5):\nTRACE FOR_ITER 40 [RangeIteratorVariable()]\nTRACE STORE_FAST i [RangeIteratorVariable(), ConstantVariable(int: 2)]\nTRACE starts_line /tmp/ipykernel_532/2044822433.py:4 in fn\n            x = x + 1\nTRACE LOAD_FAST x [RangeIteratorVariable()]\nTRACE LOAD_CONST 1 [RangeIteratorVariable(), TensorVariable()]\nTRACE BINARY_ADD None [RangeIteratorVariable(), TensorVariable(), ConstantVariable(int: 1)]\nTRACE STORE_FAST x [RangeIteratorVariable(), TensorVariable()]\nTRACE starts_line /tmp/ipykernel_532/2044822433.py:5 in fn\n            if i == 3:\nTRACE LOAD_FAST i [RangeIteratorVariable()]\nTRACE LOAD_CONST 3 [RangeIteratorVariable(), ConstantVariable(int: 2)]\nTRACE COMPARE_OP == [RangeIteratorVariable(), ConstantVariable(int: 2), ConstantVariable(int: 3)]\nTRACE POP_JUMP_IF_FALSE 38 [RangeIteratorVariable(), ConstantVariable(bool: False)]\nTRACE starts_line /tmp/ipykernel_532/2044822433.py:6 in fn\n                torch._dynamo.graph_break()\nTRACE JUMP_ABSOLUTE 8 [RangeIteratorVariable()]\nTRACE starts_line /tmp/ipykernel_532/2044822433.py:3 in fn\n        for i in range(5):\nTRACE FOR_ITER 40 [RangeIteratorVariable()]\nTRACE STORE_FAST i [RangeIteratorVariable(), ConstantVariable(int: 3)]\nTRACE starts_line /tmp/ipykernel_532/2044822433.py:4 in fn\n            x = x + 1\nTRACE LOAD_FAST x [RangeIteratorVariable()]\nTRACE LOAD_CONST 1 [RangeIteratorVariable(), TensorVariable()]\nTRACE BINARY_ADD None [RangeIteratorVariable(), TensorVariable(), ConstantVariable(int: 1)]\nTRACE STORE_FAST x [RangeIteratorVariable(), TensorVariable()]\nTRACE starts_line /tmp/ipykernel_532/2044822433.py:5 in fn\n            if i == 3:\nTRACE LOAD_FAST i [RangeIteratorVariable()]\nTRACE LOAD_CONST 3 [RangeIteratorVariable(), ConstantVariable(int: 3)]\nTRACE COMPARE_OP == [RangeIteratorVariable(), ConstantVariable(int: 3), ConstantVariable(int: 3)]\nTRACE POP_JUMP_IF_FALSE 38 [RangeIteratorVariable(), ConstantVariable(bool: True)]\nTRACE starts_line /tmp/ipykernel_532/2044822433.py:6 in fn\n                torch._dynamo.graph_break()\nTRACE LOAD_GLOBAL torch [RangeIteratorVariable()]\nTRACE LOAD_ATTR _dynamo [RangeIteratorVariable(), LazyVariableTracker()]\nTRACE LOAD_ATTR graph_break [RangeIteratorVariable(), LazyVariableTracker()]\nTRACE CALL_FUNCTION 0 [RangeIteratorVariable(), LazyVariableTracker()]\nGraph break in user code at /tmp/ipykernel_532/2044822433.py:6\nGraph Break Reason: Call to `torch._dynamo.graph_break()`\n  Explanation: User-inserted graph break. Message: None\n  Hint: Remove the `torch._dynamo.graph_break()` call.\n\n  Developer debug context: Called `torch._dynamo.graph_break()` with args `[]`, kwargs `{}`\n\n For more details about this graph break, please visit: https://meta-pytorch.github.io/compile-graph-break-site/gb/gb0025.html\nUser code traceback:\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/runpy.py\", line 196, in _run_module_as_main\n    return _run_code(code, main_globals, None,\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/runpy.py\", line 86, in _run_code\n    exec(code, run_globals)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel_launcher.py\", line 18, in <module>\n    app.launch_new_instance()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/traitlets/config/application.py\", line 1075, in launch_instance\n    app.start()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/kernelapp.py\", line 758, in start\n    self.io_loop.start()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/tornado/platform/asyncio.py\", line 211, in start\n    self.asyncio_loop.run_forever()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/asyncio/base_events.py\", line 603, in run_forever\n    self._run_once()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/asyncio/base_events.py\", line 1909, in _run_once\n    handle._run()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/asyncio/events.py\", line 80, in _run\n    self._context.run(self._callback, *self._args)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/utils.py\", line 71, in preserve_context\n    return await f(*args, **kwargs)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/kernelbase.py\", line 614, in shell_main\n    await self.dispatch_shell(msg, subshell_id=subshell_id)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/kernelbase.py\", line 471, in dispatch_shell\n    await result\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/ipkernel.py\", line 366, in execute_request\n    await super().execute_request(stream, ident, parent)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/kernelbase.py\", line 827, in execute_request\n    reply_content = await reply_content\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/ipkernel.py\", line 458, in do_execute\n    res = shell.run_cell(\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/zmqshell.py\", line 663, in run_cell\n    return super().run_cell(*args, **kwargs)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/interactiveshell.py\", line 3006, in run_cell\n    result = self._run_cell(\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/interactiveshell.py\", line 3061, in _run_cell\n    result = runner(coro)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/async_helpers.py\", line 129, in _pseudo_sync_runner\n    coro.send(None)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/interactiveshell.py\", line 3266, in run_cell_async\n    has_raised = await self.run_ast_nodes(code_ast.body, cell_name,\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/interactiveshell.py\", line 3445, in run_ast_nodes\n    if await self.run_code(code, result, async_=asy):\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/interactiveshell.py\", line 3505, in run_code\n    exec(code_obj, self.user_global_ns, self.user_ns)\n  File \"/tmp/ipykernel_532/2044822433.py\", line 8, in <module>\n    fn(torch.randn(3))\n  File \"/tmp/ipykernel_532/2044822433.py\", line 6, in fn\n    torch._dynamo.graph_break()\n\nSkipping frame because there is a graph break in a for/while loop\n<FrameSummary file /tmp/ipykernel_532/2044822433.py, line 6 in fn>\nSkipping frame Skipping frame because there is a graph break in a for/while loop\n<FrameSummary file /tmp/ipykernel_532/2044822433.py, line 6 in fn> fn                 /tmp/ipykernel_532/2044822433.py 1\nput_code_state: no cache key, skipping\nrun_gc_after_compile: running gc\nskipping: graph_break (reason: in skipfiles, file: /opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/_dynamo/decorators.py)\n\n```\n\n\n```python\ntensor([4.9228, 6.1472, 2.6696])\n\n```\n\nIn this example, we can avoid skipping by unrolling the loop:\n\n```python\n@torch.compile\ndef fn(x):\n    def inner(i):\n        nonlocal x\n        x = x + 1\n        if i == 3:\n            torch._dynamo.graph_break()\n    inner(0)\n    inner(1)\n    inner(2)\n    inner(3)\n    inner(4)\n    return x\nfn(torch.randn(3))\n\n```\n\n\n```python\ntorchdynamo start compiling fn /tmp/ipykernel_532/617960493.py:1, stack (elided 5 frames):\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/runpy.py\", line 196, in _run_module_as_main\n    return _run_code(code, main_globals, None,\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/runpy.py\", line 86, in _run_code\n    exec(code, run_globals)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel_launcher.py\", line 18, in <module>\n    app.launch_new_instance()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/traitlets/config/application.py\", line 1075, in launch_instance\n    app.start()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/kernelapp.py\", line 758, in start\n    self.io_loop.start()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/tornado/platform/asyncio.py\", line 211, in start\n    self.asyncio_loop.run_forever()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/asyncio/base_events.py\", line 603, in run_forever\n    self._run_once()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/asyncio/base_events.py\", line 1909, in _run_once\n    handle._run()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/asyncio/events.py\", line 80, in _run\n    self._context.run(self._callback, *self._args)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/utils.py\", line 71, in preserve_context\n    return await f(*args, **kwargs)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/kernelbase.py\", line 614, in shell_main\n    await self.dispatch_shell(msg, subshell_id=subshell_id)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/kernelbase.py\", line 471, in dispatch_shell\n    await result\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/ipkernel.py\", line 366, in execute_request\n    await super().execute_request(stream, ident, parent)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/kernelbase.py\", line 827, in execute_request\n    reply_content = await reply_content\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/ipkernel.py\", line 458, in do_execute\n    res = shell.run_cell(\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/zmqshell.py\", line 663, in run_cell\n    return super().run_cell(*args, **kwargs)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/interactiveshell.py\", line 3006, in run_cell\n    result = self._run_cell(\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/interactiveshell.py\", line 3061, in _run_cell\n    result = runner(coro)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/async_helpers.py\", line 129, in _pseudo_sync_runner\n    coro.send(None)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/interactiveshell.py\", line 3266, in run_cell_async\n    has_raised = await self.run_ast_nodes(code_ast.body, cell_name,\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/interactiveshell.py\", line 3445, in run_ast_nodes\n    if await self.run_code(code, result, async_=asy):\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/interactiveshell.py\", line 3505, in run_code\n    exec(code_obj, self.user_global_ns, self.user_ns)\n  File \"/tmp/ipykernel_532/617960493.py\", line 14, in <module>\n    fn(torch.randn(3))\n\nStep 1: torchdynamo start tracing fn /tmp/ipykernel_532/617960493.py:1\ncreate_env\nTRACE starts_line /tmp/ipykernel_532/617960493.py:3 in fn\n        def inner(i):\nTRACE LOAD_CLOSURE x []\nTRACE BUILD_TUPLE 1 [CellVariable()]\nTRACE LOAD_CONST <code object inner at 0x7fab86007aa0, file \"/tmp/ipykernel_532/617960493.py\", line 3> [TupleVariable(length=1)]\nTRACE LOAD_CONST fn.<locals>.inner [TupleVariable(length=1), ConstantVariable(code: <code object inner at 0x7fab86007aa0, file \"/tmp/ipykernel_532/617960493.py\", line 3>)]\nTRACE MAKE_FUNCTION 8 [TupleVariable(length=1), ConstantVariable(code: <code object inner at 0x7fab86007aa0, file \"/tmp/ipykernel_532/617960493.py\", line 3>), ConstantVariable(str: 'fn.<locals>.inner')]\nTRACE STORE_FAST inner [NestedUserFunctionVariable()]\nTRACE starts_line /tmp/ipykernel_532/617960493.py:8 in fn\n        inner(0)\nTRACE LOAD_FAST inner []\nTRACE LOAD_CONST 0 [NestedUserFunctionVariable()]\nTRACE CALL_FUNCTION 1 [NestedUserFunctionVariable(), ConstantVariable(int: 0)]\nINLINING <code object inner at 0x7fab86007aa0, file \"/tmp/ipykernel_532/617960493.py\", line 3>, inlined according trace_rules.lookup inlined by default\nTRACE starts_line /tmp/ipykernel_532/617960493.py:5 in inner (inline depth: 1)\n            x = x + 1\nTRACE LOAD_DEREF x []\nwrap_to_fake L['x'] (3,) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None], constraint_strides=[None], specialize_on=[[]], view_base_context=None, tensor_source=LocalSource(local_name='x', is_input=True, dynamism=None, is_derefed_cell_contents=True), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>\ncreate_graph_input L_x_ L['x'] FakeTensor(..., size=(3,)) at debug_level 0 before=False\nTRACE LOAD_CONST 1 [TensorVariable()]\nTRACE BINARY_ADD None [TensorVariable(), ConstantVariable(int: 1)]\nTRACE STORE_DEREF x [TensorVariable()]\nTRACE starts_line /tmp/ipykernel_532/617960493.py:6 in inner (inline depth: 1)\n            if i == 3:\nTRACE LOAD_FAST i []\nTRACE LOAD_CONST 3 [ConstantVariable(int: 0)]\nTRACE COMPARE_OP == [ConstantVariable(int: 0), ConstantVariable(int: 3)]\nTRACE POP_JUMP_IF_FALSE 30 [ConstantVariable(bool: False)]\nTRACE LOAD_CONST None []\nTRACE RETURN_VALUE None [ConstantVariable(NoneType: None)]\nDONE INLINING <code object inner at 0x7fab86007aa0, file \"/tmp/ipykernel_532/617960493.py\", line 3>\nTRACE POP_TOP None [ConstantVariable(NoneType: None)]\nTRACE starts_line /tmp/ipykernel_532/617960493.py:9 in fn\n        inner(1)\nTRACE LOAD_FAST inner []\nTRACE LOAD_CONST 1 [NestedUserFunctionVariable()]\nTRACE CALL_FUNCTION 1 [NestedUserFunctionVariable(), ConstantVariable(int: 1)]\nINLINING <code object inner at 0x7fab86007aa0, file \"/tmp/ipykernel_532/617960493.py\", line 3>, inlined according trace_rules.lookup inlined by default\nTRACE starts_line /tmp/ipykernel_532/617960493.py:5 in inner (inline depth: 1)\n            x = x + 1\nTRACE LOAD_DEREF x []\nTRACE LOAD_CONST 1 [TensorVariable()]\nTRACE BINARY_ADD None [TensorVariable(), ConstantVariable(int: 1)]\nTRACE STORE_DEREF x [TensorVariable()]\nTRACE starts_line /tmp/ipykernel_532/617960493.py:6 in inner (inline depth: 1)\n            if i == 3:\nTRACE LOAD_FAST i []\nTRACE LOAD_CONST 3 [ConstantVariable(int: 1)]\nTRACE COMPARE_OP == [ConstantVariable(int: 1), ConstantVariable(int: 3)]\nTRACE POP_JUMP_IF_FALSE 30 [ConstantVariable(bool: False)]\nTRACE LOAD_CONST None []\nTRACE RETURN_VALUE None [ConstantVariable(NoneType: None)]\nDONE INLINING <code object inner at 0x7fab86007aa0, file \"/tmp/ipykernel_532/617960493.py\", line 3>\nTRACE POP_TOP None [ConstantVariable(NoneType: None)]\nTRACE starts_line /tmp/ipykernel_532/617960493.py:10 in fn\n        inner(2)\nTRACE LOAD_FAST inner []\nTRACE LOAD_CONST 2 [NestedUserFunctionVariable()]\nTRACE CALL_FUNCTION 1 [NestedUserFunctionVariable(), ConstantVariable(int: 2)]\nINLINING <code object inner at 0x7fab86007aa0, file \"/tmp/ipykernel_532/617960493.py\", line 3>, inlined according trace_rules.lookup inlined by default\nTRACE starts_line /tmp/ipykernel_532/617960493.py:5 in inner (inline depth: 1)\n            x = x + 1\nTRACE LOAD_DEREF x []\nTRACE LOAD_CONST 1 [TensorVariable()]\nTRACE BINARY_ADD None [TensorVariable(), ConstantVariable(int: 1)]\nTRACE STORE_DEREF x [TensorVariable()]\nTRACE starts_line /tmp/ipykernel_532/617960493.py:6 in inner (inline depth: 1)\n            if i == 3:\nTRACE LOAD_FAST i []\nTRACE LOAD_CONST 3 [ConstantVariable(int: 2)]\nTRACE COMPARE_OP == [ConstantVariable(int: 2), ConstantVariable(int: 3)]\nTRACE POP_JUMP_IF_FALSE 30 [ConstantVariable(bool: False)]\nTRACE LOAD_CONST None []\nTRACE RETURN_VALUE None [ConstantVariable(NoneType: None)]\nDONE INLINING <code object inner at 0x7fab86007aa0, file \"/tmp/ipykernel_532/617960493.py\", line 3>\nTRACE POP_TOP None [ConstantVariable(NoneType: None)]\nTRACE starts_line /tmp/ipykernel_532/617960493.py:11 in fn\n        inner(3)\nTRACE LOAD_FAST inner []\nTRACE LOAD_CONST 3 [NestedUserFunctionVariable()]\nTRACE CALL_FUNCTION 1 [NestedUserFunctionVariable(), ConstantVariable(int: 3)]\nINLINING <code object inner at 0x7fab86007aa0, file \"/tmp/ipykernel_532/617960493.py\", line 3>, inlined according trace_rules.lookup inlined by default\nTRACE starts_line /tmp/ipykernel_532/617960493.py:5 in inner (inline depth: 1)\n            x = x + 1\nTRACE LOAD_DEREF x []\nTRACE LOAD_CONST 1 [TensorVariable()]\nTRACE BINARY_ADD None [TensorVariable(), ConstantVariable(int: 1)]\nTRACE STORE_DEREF x [TensorVariable()]\nTRACE starts_line /tmp/ipykernel_532/617960493.py:6 in inner (inline depth: 1)\n            if i == 3:\nTRACE LOAD_FAST i []\nTRACE LOAD_CONST 3 [ConstantVariable(int: 3)]\nTRACE COMPARE_OP == [ConstantVariable(int: 3), ConstantVariable(int: 3)]\nTRACE POP_JUMP_IF_FALSE 30 [ConstantVariable(bool: True)]\nTRACE starts_line /tmp/ipykernel_532/617960493.py:7 in inner (inline depth: 1)\n                torch._dynamo.graph_break()\nTRACE LOAD_GLOBAL torch []\nTRACE LOAD_ATTR _dynamo [LazyVariableTracker()]\nTRACE LOAD_ATTR graph_break [LazyVariableTracker()]\nTRACE CALL_FUNCTION 0 [LazyVariableTracker()]\nempty checkpoint\nFAILED INLINING <code object inner at 0x7fab86007aa0, file \"/tmp/ipykernel_532/617960493.py\", line 3>\nGraph break in user code at /tmp/ipykernel_532/617960493.py:7\nGraph Break Reason: Call to `torch._dynamo.graph_break()`\n  Explanation: User-inserted graph break. Message: None\n  Hint: Remove the `torch._dynamo.graph_break()` call.\n\n  Developer debug context: Called `torch._dynamo.graph_break()` with args `[]`, kwargs `{}`\n\n For more details about this graph break, please visit: https://meta-pytorch.github.io/compile-graph-break-site/gb/gb0025.html\nUser code traceback:\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/runpy.py\", line 196, in _run_module_as_main\n    return _run_code(code, main_globals, None,\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/runpy.py\", line 86, in _run_code\n    exec(code, run_globals)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel_launcher.py\", line 18, in <module>\n    app.launch_new_instance()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/traitlets/config/application.py\", line 1075, in launch_instance\n    app.start()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/kernelapp.py\", line 758, in start\n    self.io_loop.start()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/tornado/platform/asyncio.py\", line 211, in start\n    self.asyncio_loop.run_forever()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/asyncio/base_events.py\", line 603, in run_forever\n    self._run_once()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/asyncio/base_events.py\", line 1909, in _run_once\n    handle._run()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/asyncio/events.py\", line 80, in _run\n    self._context.run(self._callback, *self._args)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/utils.py\", line 71, in preserve_context\n    return await f(*args, **kwargs)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/kernelbase.py\", line 614, in shell_main\n    await self.dispatch_shell(msg, subshell_id=subshell_id)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/kernelbase.py\", line 471, in dispatch_shell\n    await result\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/ipkernel.py\", line 366, in execute_request\n    await super().execute_request(stream, ident, parent)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/kernelbase.py\", line 827, in execute_request\n    reply_content = await reply_content\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/ipkernel.py\", line 458, in do_execute\n    res = shell.run_cell(\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/zmqshell.py\", line 663, in run_cell\n    return super().run_cell(*args, **kwargs)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/interactiveshell.py\", line 3006, in run_cell\n    result = self._run_cell(\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/interactiveshell.py\", line 3061, in _run_cell\n    result = runner(coro)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/async_helpers.py\", line 129, in _pseudo_sync_runner\n    coro.send(None)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/interactiveshell.py\", line 3266, in run_cell_async\n    has_raised = await self.run_ast_nodes(code_ast.body, cell_name,\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/interactiveshell.py\", line 3445, in run_ast_nodes\n    if await self.run_code(code, result, async_=asy):\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/interactiveshell.py\", line 3505, in run_code\n    exec(code_obj, self.user_global_ns, self.user_ns)\n  File \"/tmp/ipykernel_532/617960493.py\", line 14, in <module>\n    fn(torch.randn(3))\n  File \"/tmp/ipykernel_532/617960493.py\", line 11, in fn\n    inner(3)\n  File \"/tmp/ipykernel_532/617960493.py\", line 7, in inner\n    torch._dynamo.graph_break()\n\nRestarting analysis due to _dynamo/symbolic_convert.py:249 in fail_and_restart_analysis\nStep 1: torchdynamo start tracing fn /tmp/ipykernel_532/617960493.py:1\ncreate_env\nTRACE starts_line /tmp/ipykernel_532/617960493.py:3 in fn\n        def inner(i):\nTRACE LOAD_CLOSURE x []\nTRACE BUILD_TUPLE 1 [CellVariable()]\nTRACE LOAD_CONST <code object inner at 0x7fab86007aa0, file \"/tmp/ipykernel_532/617960493.py\", line 3> [TupleVariable(length=1)]\nTRACE LOAD_CONST fn.<locals>.inner [TupleVariable(length=1), ConstantVariable(code: <code object inner at 0x7fab86007aa0, file \"/tmp/ipykernel_532/617960493.py\", line 3>)]\nTRACE MAKE_FUNCTION 8 [TupleVariable(length=1), ConstantVariable(code: <code object inner at 0x7fab86007aa0, file \"/tmp/ipykernel_532/617960493.py\", line 3>), ConstantVariable(str: 'fn.<locals>.inner')]\nTRACE STORE_FAST inner [NestedUserFunctionVariable()]\nTRACE starts_line /tmp/ipykernel_532/617960493.py:8 in fn\n        inner(0)\nTRACE LOAD_FAST inner []\nTRACE LOAD_CONST 0 [NestedUserFunctionVariable()]\nTRACE CALL_FUNCTION 1 [NestedUserFunctionVariable(), ConstantVariable(int: 0)]\nINLINING <code object inner at 0x7fab86007aa0, file \"/tmp/ipykernel_532/617960493.py\", line 3>, inlined according trace_rules.lookup inlined by default\nTRACE starts_line /tmp/ipykernel_532/617960493.py:5 in inner (inline depth: 1)\n            x = x + 1\nTRACE LOAD_DEREF x []\nwrap_to_fake L['x'] (3,) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None], constraint_strides=[None], specialize_on=[[]], view_base_context=None, tensor_source=LocalSource(local_name='x', is_input=True, dynamism=None, is_derefed_cell_contents=True), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>\ncreate_graph_input L_x_ L['x'] FakeTensor(..., size=(3,)) at debug_level 0 before=False\nTRACE LOAD_CONST 1 [TensorVariable()]\nTRACE BINARY_ADD None [TensorVariable(), ConstantVariable(int: 1)]\nTRACE STORE_DEREF x [TensorVariable()]\nTRACE starts_line /tmp/ipykernel_532/617960493.py:6 in inner (inline depth: 1)\n            if i == 3:\nTRACE LOAD_FAST i []\nTRACE LOAD_CONST 3 [ConstantVariable(int: 0)]\nTRACE COMPARE_OP == [ConstantVariable(int: 0), ConstantVariable(int: 3)]\nTRACE POP_JUMP_IF_FALSE 30 [ConstantVariable(bool: False)]\nTRACE LOAD_CONST None []\nTRACE RETURN_VALUE None [ConstantVariable(NoneType: None)]\nDONE INLINING <code object inner at 0x7fab86007aa0, file \"/tmp/ipykernel_532/617960493.py\", line 3>\nTRACE POP_TOP None [ConstantVariable(NoneType: None)]\nTRACE starts_line /tmp/ipykernel_532/617960493.py:9 in fn\n        inner(1)\nTRACE LOAD_FAST inner []\nTRACE LOAD_CONST 1 [NestedUserFunctionVariable()]\nTRACE CALL_FUNCTION 1 [NestedUserFunctionVariable(), ConstantVariable(int: 1)]\nINLINING <code object inner at 0x7fab86007aa0, file \"/tmp/ipykernel_532/617960493.py\", line 3>, inlined according trace_rules.lookup inlined by default\nTRACE starts_line /tmp/ipykernel_532/617960493.py:5 in inner (inline depth: 1)\n            x = x + 1\nTRACE LOAD_DEREF x []\nTRACE LOAD_CONST 1 [TensorVariable()]\nTRACE BINARY_ADD None [TensorVariable(), ConstantVariable(int: 1)]\nTRACE STORE_DEREF x [TensorVariable()]\nTRACE starts_line /tmp/ipykernel_532/617960493.py:6 in inner (inline depth: 1)\n            if i == 3:\nTRACE LOAD_FAST i []\nTRACE LOAD_CONST 3 [ConstantVariable(int: 1)]\nTRACE COMPARE_OP == [ConstantVariable(int: 1), ConstantVariable(int: 3)]\nTRACE POP_JUMP_IF_FALSE 30 [ConstantVariable(bool: False)]\nTRACE LOAD_CONST None []\nTRACE RETURN_VALUE None [ConstantVariable(NoneType: None)]\nDONE INLINING <code object inner at 0x7fab86007aa0, file \"/tmp/ipykernel_532/617960493.py\", line 3>\nTRACE POP_TOP None [ConstantVariable(NoneType: None)]\nTRACE starts_line /tmp/ipykernel_532/617960493.py:10 in fn\n        inner(2)\nTRACE LOAD_FAST inner []\nTRACE LOAD_CONST 2 [NestedUserFunctionVariable()]\nTRACE CALL_FUNCTION 1 [NestedUserFunctionVariable(), ConstantVariable(int: 2)]\nINLINING <code object inner at 0x7fab86007aa0, file \"/tmp/ipykernel_532/617960493.py\", line 3>, inlined according trace_rules.lookup inlined by default\nTRACE starts_line /tmp/ipykernel_532/617960493.py:5 in inner (inline depth: 1)\n            x = x + 1\nTRACE LOAD_DEREF x []\nTRACE LOAD_CONST 1 [TensorVariable()]\nTRACE BINARY_ADD None [TensorVariable(), ConstantVariable(int: 1)]\nTRACE STORE_DEREF x [TensorVariable()]\nTRACE starts_line /tmp/ipykernel_532/617960493.py:6 in inner (inline depth: 1)\n            if i == 3:\nTRACE LOAD_FAST i []\nTRACE LOAD_CONST 3 [ConstantVariable(int: 2)]\nTRACE COMPARE_OP == [ConstantVariable(int: 2), ConstantVariable(int: 3)]\nTRACE POP_JUMP_IF_FALSE 30 [ConstantVariable(bool: False)]\nTRACE LOAD_CONST None []\nTRACE RETURN_VALUE None [ConstantVariable(NoneType: None)]\nDONE INLINING <code object inner at 0x7fab86007aa0, file \"/tmp/ipykernel_532/617960493.py\", line 3>\nTRACE POP_TOP None [ConstantVariable(NoneType: None)]\nTRACE starts_line /tmp/ipykernel_532/617960493.py:11 in fn\n        inner(3)\nTRACE LOAD_FAST inner []\nTRACE LOAD_CONST 3 [NestedUserFunctionVariable()]\nTRACE CALL_FUNCTION 1 [NestedUserFunctionVariable(), ConstantVariable(int: 3)]\nCOMPILING GRAPH due to GraphCompileReason(reason='Call to `torch._dynamo.graph_break()`\\n  Explanation: User-inserted graph break. Message: None\\n  Hint: Remove the `torch._dynamo.graph_break()` call.\\n\\n  Developer debug context: Called `torch._dynamo.graph_break()` with args `[]`, kwargs `{}`\\n\\n For more details about this graph break, please visit: https://meta-pytorch.github.io/compile-graph-break-site/gb/gb0025.html', user_stack=[<FrameSummary file /tmp/ipykernel_532/617960493.py, line 11 in fn>, <FrameSummary file /tmp/ipykernel_532/617960493.py, line 7 in inner>], graph_break=True)\nTRACED GRAPH\n ===== __compiled_fn_8_0472935d_d975_47e2_b34e_9d149161b952 =====\n /opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/fx/_lazy_graph_module.py class GraphModule(torch.nn.Module):\n    def forward(self, L_x_: \"f32[3][1]cpu\"):\n        l_x_ = L_x_\n        \n         # File: /tmp/ipykernel_532/617960493.py:5 in inner, code: x = x + 1\n        x: \"f32[3][1]cpu\" = l_x_ + 1;  l_x_ = None\n        \n         # File: /tmp/ipykernel_532/617960493.py:5 in inner, code: x = x + 1\n        x_1: \"f32[3][1]cpu\" = x + 1;  x = None\n        \n         # File: /tmp/ipykernel_532/617960493.py:5 in inner, code: x = x + 1\n        x_2: \"f32[3][1]cpu\" = x_1 + 1;  x_1 = None\n        return (x_2,)\n        \n\nStep 2: calling compiler function eager\nStep 2: done compiler function eager\nproduce_guards\ntrack_symint L['x'].size()[0] 3 None\ntrack_symint L['x'].stride()[0] 1 None\ntrack_symint L['x'].storage_offset() 0 None\nSkipping guard L['x'].size()[0] == 3\nSkipping guard L['x'].stride()[0] == 1\nSkipping guard L['x'].storage_offset() == 0\nGUARDS:\n\nTREE_GUARD_MANAGER:\n+- RootGuardManager\n| +- LAMBDA_GUARD: torch._functorch.aot_autograd.utils.top_saved_tensors_hooks ids == None  # _dynamo/output_graph.py:688 in init_ambient_guards\n| +- DEFAULT_DEVICE: utils_device.CURRENT_DEVICE == None                           # _dynamo/output_graph.py:676 in init_ambient_guards\n| +- GLOBAL_STATE: ___check_global_state()\n| +- TORCH_FUNCTION_MODE_STACK: ___check_torch_function_mode_stack()\n| +- GuardManager: source=L['x'], accessed_by=FrameLocalsGuardAccessor(key='x', framelocals_idx=2), type=<class 'torch.Tensor'>, tag_safe=(True, False)\n| | +- TENSOR_MATCH: check_tensor(L['x'], Tensor, DispatchKeySet(CPU, BackendSelect, ADInplaceOrView, AutogradCPU), torch.float32, device=None, requires_grad=False, size=[3], stride=[1])  # x = x + 1  # mp/ipykernel_532/617960493.py:5 in inner\n| | +- NO_HASATTR: hasattr(L['x'], '_dynamo_dynamic_indices') == False           # x = x + 1  # mp/ipykernel_532/617960493.py:5 in inner\n\nGuard eval latency = 53.83 us\nput_code_state: no cache key, skipping\nrun_gc_after_compile: running gc\nskipping: _create_nested_fn (reason: in skipfiles, file: /opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/_dynamo/variables/functions.py)\ntorchdynamo start compiling inner /tmp/ipykernel_532/617960493.py:3, stack (elided 5 frames):\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/runpy.py\", line 196, in _run_module_as_main\n    return _run_code(code, main_globals, None,\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/runpy.py\", line 86, in _run_code\n    exec(code, run_globals)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel_launcher.py\", line 18, in <module>\n    app.launch_new_instance()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/traitlets/config/application.py\", line 1075, in launch_instance\n    app.start()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/kernelapp.py\", line 758, in start\n    self.io_loop.start()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/tornado/platform/asyncio.py\", line 211, in start\n    self.asyncio_loop.run_forever()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/asyncio/base_events.py\", line 603, in run_forever\n    self._run_once()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/asyncio/base_events.py\", line 1909, in _run_once\n    handle._run()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/asyncio/events.py\", line 80, in _run\n    self._context.run(self._callback, *self._args)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/utils.py\", line 71, in preserve_context\n    return await f(*args, **kwargs)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/kernelbase.py\", line 614, in shell_main\n    await self.dispatch_shell(msg, subshell_id=subshell_id)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/kernelbase.py\", line 471, in dispatch_shell\n    await result\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/ipkernel.py\", line 366, in execute_request\n    await super().execute_request(stream, ident, parent)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/kernelbase.py\", line 827, in execute_request\n    reply_content = await reply_content\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/ipkernel.py\", line 458, in do_execute\n    res = shell.run_cell(\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/zmqshell.py\", line 663, in run_cell\n    return super().run_cell(*args, **kwargs)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/interactiveshell.py\", line 3006, in run_cell\n    result = self._run_cell(\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/interactiveshell.py\", line 3061, in _run_cell\n    result = runner(coro)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/async_helpers.py\", line 129, in _pseudo_sync_runner\n    coro.send(None)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/interactiveshell.py\", line 3266, in run_cell_async\n    has_raised = await self.run_ast_nodes(code_ast.body, cell_name,\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/interactiveshell.py\", line 3445, in run_ast_nodes\n    if await self.run_code(code, result, async_=asy):\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/interactiveshell.py\", line 3505, in run_code\n    exec(code_obj, self.user_global_ns, self.user_ns)\n  File \"/tmp/ipykernel_532/617960493.py\", line 14, in <module>\n    fn(torch.randn(3))\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py\", line 832, in compile_wrapper\n    return fn(*args, **kwargs)\n\nStep 1: torchdynamo start tracing inner /tmp/ipykernel_532/617960493.py:3\ncreate_env\nTRACE starts_line /tmp/ipykernel_532/617960493.py:5 in inner\n            x = x + 1\nTRACE LOAD_DEREF x []\nTRACE LOAD_CONST 1 [LazyVariableTracker()]\nTRACE BINARY_ADD None [LazyVariableTracker(), ConstantVariable(int: 1)]\nwrap_to_fake L['x'] (3,) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None], constraint_strides=[None], specialize_on=[[]], view_base_context=None, tensor_source=LocalSource(local_name='x', is_input=False, dynamism=None, is_derefed_cell_contents=True), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>\ncreate_graph_input L_x_ L['x'] FakeTensor(..., size=(3,)) at debug_level 0 before=False\nTRACE STORE_DEREF x [TensorVariable()]\nTRACE starts_line /tmp/ipykernel_532/617960493.py:6 in inner\n            if i == 3:\nTRACE LOAD_FAST i []\nTRACE LOAD_CONST 3 [LazyVariableTracker()]\nTRACE COMPARE_OP == [LazyVariableTracker(), ConstantVariable(int: 3)]\nTRACE POP_JUMP_IF_FALSE 30 [ConstantVariable(bool: True)]\nTRACE starts_line /tmp/ipykernel_532/617960493.py:7 in inner\n                torch._dynamo.graph_break()\nTRACE LOAD_GLOBAL torch []\nTRACE LOAD_ATTR _dynamo [LazyVariableTracker()]\nTRACE LOAD_ATTR graph_break [LazyVariableTracker()]\nTRACE CALL_FUNCTION 0 [LazyVariableTracker()]\nGraph break (user stack suppressed due to duplicate graph break) in user code at /tmp/ipykernel_532/617960493.py:7\nGraph Break Reason: Call to `torch._dynamo.graph_break()`\n  Explanation: User-inserted graph break. Message: None\n  Hint: Remove the `torch._dynamo.graph_break()` call.\n\n  Developer debug context: Called `torch._dynamo.graph_break()` with args `[]`, kwargs `{}`\n\n For more details about this graph break, please visit: https://meta-pytorch.github.io/compile-graph-break-site/gb/gb0025.html\nRestarting analysis due to _dynamo/symbolic_convert.py:249 in fail_and_restart_analysis\nStep 1: torchdynamo start tracing inner /tmp/ipykernel_532/617960493.py:3\ncreate_env\nTRACE starts_line /tmp/ipykernel_532/617960493.py:5 in inner\n            x = x + 1\nTRACE LOAD_DEREF x []\nTRACE LOAD_CONST 1 [LazyVariableTracker()]\nTRACE BINARY_ADD None [LazyVariableTracker(), ConstantVariable(int: 1)]\nwrap_to_fake L['x'] (3,) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None], constraint_strides=[None], specialize_on=[[]], view_base_context=None, tensor_source=LocalSource(local_name='x', is_input=False, dynamism=None, is_derefed_cell_contents=True), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>\ncreate_graph_input L_x_ L['x'] FakeTensor(..., size=(3,)) at debug_level 0 before=False\nTRACE STORE_DEREF x [TensorVariable()]\nTRACE starts_line /tmp/ipykernel_532/617960493.py:6 in inner\n            if i == 3:\nTRACE LOAD_FAST i []\nTRACE LOAD_CONST 3 [LazyVariableTracker()]\nTRACE COMPARE_OP == [LazyVariableTracker(), ConstantVariable(int: 3)]\nTRACE POP_JUMP_IF_FALSE 30 [ConstantVariable(bool: True)]\nTRACE starts_line /tmp/ipykernel_532/617960493.py:7 in inner\n                torch._dynamo.graph_break()\nTRACE LOAD_GLOBAL torch []\nTRACE LOAD_ATTR _dynamo [LazyVariableTracker()]\nTRACE LOAD_ATTR graph_break [LazyVariableTracker()]\nTRACE CALL_FUNCTION 0 [LazyVariableTracker()]\nCOMPILING GRAPH due to GraphCompileReason(reason='Call to `torch._dynamo.graph_break()`\\n  Explanation: User-inserted graph break. Message: None\\n  Hint: Remove the `torch._dynamo.graph_break()` call.\\n\\n  Developer debug context: Called `torch._dynamo.graph_break()` with args `[]`, kwargs `{}`\\n\\n For more details about this graph break, please visit: https://meta-pytorch.github.io/compile-graph-break-site/gb/gb0025.html', user_stack=[<FrameSummary file /tmp/ipykernel_532/617960493.py, line 7 in inner>], graph_break=True)\nTRACED GRAPH\n ===== __compiled_fn_12_c9702b2e_a86b_41a2_9a4d_e0823204f4ae =====\n /opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/fx/_lazy_graph_module.py class GraphModule(torch.nn.Module):\n    def forward(self, L_x_: \"f32[3][1]cpu\"):\n        l_x_ = L_x_\n        \n         # File: /tmp/ipykernel_532/617960493.py:5 in inner, code: x = x + 1\n        x: \"f32[3][1]cpu\" = l_x_ + 1;  l_x_ = None\n        return (x,)\n        \n\nStep 2: calling compiler function eager\nStep 2: done compiler function eager\nproduce_guards\ntrack_symint L['x'].size()[0] 3 None\ntrack_symint L['x'].stride()[0] 1 None\ntrack_symint L['x'].storage_offset() 0 None\nSkipping guard L['x'].size()[0] == 3\nSkipping guard L['x'].stride()[0] == 1\nSkipping guard L['x'].storage_offset() == 0\nGUARDS:\n\nTREE_GUARD_MANAGER:\n+- RootGuardManager\n| +- LAMBDA_GUARD: torch._functorch.aot_autograd.utils.top_saved_tensors_hooks ids == None  # _dynamo/output_graph.py:688 in init_ambient_guards\n| +- DEFAULT_DEVICE: utils_device.CURRENT_DEVICE == None                           # _dynamo/output_graph.py:676 in init_ambient_guards\n| +- GLOBAL_STATE: ___check_global_state()\n| +- TORCH_FUNCTION_MODE_STACK: ___check_torch_function_mode_stack()\n| +- GuardManager: source=L['i'], accessed_by=FrameLocalsGuardAccessor(key='i', framelocals_idx=0), type=<class 'int'>, tag_safe=(True, False)\n| | +- EQUALS_MATCH: L['i'] == 3                                                   # if i == 3:  # mp/ipykernel_532/617960493.py:6 in inner\n| +- GuardManager: source=L['x'], accessed_by=FrameLocalsGuardAccessor(key='x', framelocals_idx=1), type=<class 'torch.Tensor'>, tag_safe=(True, False)\n| | +- TENSOR_MATCH: check_tensor(L['x'], Tensor, DispatchKeySet(CPU, BackendSelect, ADInplaceOrView, AutogradCPU), torch.float32, device=None, requires_grad=False, size=[3], stride=[1])  # x = x + 1  # mp/ipykernel_532/617960493.py:5 in inner\n| | +- NO_HASATTR: hasattr(L['x'], '_dynamo_dynamic_indices') == False           # x = x + 1  # mp/ipykernel_532/617960493.py:5 in inner\n| +- GuardManager: source=G, accessed_by=GlobalsGuardAccessor, type=<class 'dict'>, tag_safe=(False, False)\n| | +- GuardManager: source=G['torch'], accessed_by=DictGetItemGuardAccessor('torch'), type=<class 'module'>, tag_safe=(False, False)\n| | | +- ID_MATCH: ___check_obj_id(G['torch'], 140376310990704)                  # torch._dynamo.graph_break()  # mp/ipykernel_532/617960493.py:7 in inner\n| | | +- GuardManager: source=G['torch']._dynamo, accessed_by=GetAttrGuardAccessor(_dynamo), type=<class 'module'>, tag_safe=(False, False)\n| | | | +- ID_MATCH: ___check_obj_id(G['torch']._dynamo, 140374889071936)          # torch._dynamo.graph_break()  # mp/ipykernel_532/617960493.py:7 in inner\n| | | | +- GuardManager: source=G['torch']._dynamo.graph_break, accessed_by=GetAttrGuardAccessor(graph_break), type=<class 'function'>, tag_safe=(True, False)\n| | | | | +- GuardManager: source=G['torch']._dynamo.graph_break.__code__, accessed_by=CodeGuardAccessor, type=<class 'code'>, tag_safe=(True, False)\n| | | | | | +- ID_MATCH: ___check_obj_id(G['torch']._dynamo.graph_break.__code__, 140374703207360)  # torch._dynamo.graph_break()  # mp/ipykernel_532/617960493.py:7 in inner\n\nGuard eval latency = 368.80 us\nput_code_state: no cache key, skipping\nrun_gc_after_compile: running gc\ntorchdynamo start compiling torch_dynamo_resume_in_inner_at_7 /tmp/ipykernel_532/617960493.py:7, stack (elided 5 frames):\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/runpy.py\", line 196, in _run_module_as_main\n    return _run_code(code, main_globals, None,\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/runpy.py\", line 86, in _run_code\n    exec(code, run_globals)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel_launcher.py\", line 18, in <module>\n    app.launch_new_instance()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/traitlets/config/application.py\", line 1075, in launch_instance\n    app.start()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/kernelapp.py\", line 758, in start\n    self.io_loop.start()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/tornado/platform/asyncio.py\", line 211, in start\n    self.asyncio_loop.run_forever()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/asyncio/base_events.py\", line 603, in run_forever\n    self._run_once()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/asyncio/base_events.py\", line 1909, in _run_once\n    handle._run()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/asyncio/events.py\", line 80, in _run\n    self._context.run(self._callback, *self._args)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/utils.py\", line 71, in preserve_context\n    return await f(*args, **kwargs)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/kernelbase.py\", line 614, in shell_main\n    await self.dispatch_shell(msg, subshell_id=subshell_id)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/kernelbase.py\", line 471, in dispatch_shell\n    await result\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/ipkernel.py\", line 366, in execute_request\n    await super().execute_request(stream, ident, parent)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/kernelbase.py\", line 827, in execute_request\n    reply_content = await reply_content\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/ipkernel.py\", line 458, in do_execute\n    res = shell.run_cell(\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/zmqshell.py\", line 663, in run_cell\n    return super().run_cell(*args, **kwargs)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/interactiveshell.py\", line 3006, in run_cell\n    result = self._run_cell(\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/interactiveshell.py\", line 3061, in _run_cell\n    result = runner(coro)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/async_helpers.py\", line 129, in _pseudo_sync_runner\n    coro.send(None)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/interactiveshell.py\", line 3266, in run_cell_async\n    has_raised = await self.run_ast_nodes(code_ast.body, cell_name,\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/interactiveshell.py\", line 3445, in run_ast_nodes\n    if await self.run_code(code, result, async_=asy):\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/interactiveshell.py\", line 3505, in run_code\n    exec(code_obj, self.user_global_ns, self.user_ns)\n  File \"/tmp/ipykernel_532/617960493.py\", line 14, in <module>\n    fn(torch.randn(3))\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py\", line 832, in compile_wrapper\n    return fn(*args, **kwargs)\n  File \"/tmp/ipykernel_532/617960493.py\", line 11, in fn\n    inner(3)\n\nStep 1: torchdynamo start tracing torch_dynamo_resume_in_inner_at_7 /tmp/ipykernel_532/617960493.py:7\ncreate_env\nTRACE starts_line /tmp/ipykernel_532/617960493.py:7 in torch_dynamo_resume_in_inner_at_7\n                torch._dynamo.graph_break()\nTRACE LOAD_CONST True []\nTRACE STORE_FAST __is_tracing_resume_prologue [ConstantVariable(bool: True)]\nTRACE LOAD_FAST ___stack0 []\nTRACE LOAD_CONST False [LazyVariableTracker()]\nTRACE STORE_FAST __is_tracing_resume_prologue [LazyVariableTracker(), ConstantVariable(bool: False)]\nTRACE JUMP_ABSOLUTE 36 [LazyVariableTracker()]\nTRACE POP_TOP None [LazyVariableTracker()]\nTRACE LOAD_CONST None []\nTRACE RETURN_VALUE None [ConstantVariable(NoneType: None)]\nSkipping frame because no content in function call torch_dynamo_resume_in_inner_at_7                 /tmp/ipykernel_532/617960493.py 7\nput_code_state: no cache key, skipping\nrun_gc_after_compile: running gc\ntorchdynamo start compiling torch_dynamo_resume_in_fn_at_11 /tmp/ipykernel_532/617960493.py:11, stack (elided 5 frames):\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/runpy.py\", line 196, in _run_module_as_main\n    return _run_code(code, main_globals, None,\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/runpy.py\", line 86, in _run_code\n    exec(code, run_globals)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel_launcher.py\", line 18, in <module>\n    app.launch_new_instance()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/traitlets/config/application.py\", line 1075, in launch_instance\n    app.start()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/kernelapp.py\", line 758, in start\n    self.io_loop.start()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/tornado/platform/asyncio.py\", line 211, in start\n    self.asyncio_loop.run_forever()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/asyncio/base_events.py\", line 603, in run_forever\n    self._run_once()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/asyncio/base_events.py\", line 1909, in _run_once\n    handle._run()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/asyncio/events.py\", line 80, in _run\n    self._context.run(self._callback, *self._args)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/utils.py\", line 71, in preserve_context\n    return await f(*args, **kwargs)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/kernelbase.py\", line 614, in shell_main\n    await self.dispatch_shell(msg, subshell_id=subshell_id)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/kernelbase.py\", line 471, in dispatch_shell\n    await result\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/ipkernel.py\", line 366, in execute_request\n    await super().execute_request(stream, ident, parent)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/kernelbase.py\", line 827, in execute_request\n    reply_content = await reply_content\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/ipkernel.py\", line 458, in do_execute\n    res = shell.run_cell(\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/zmqshell.py\", line 663, in run_cell\n    return super().run_cell(*args, **kwargs)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/interactiveshell.py\", line 3006, in run_cell\n    result = self._run_cell(\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/interactiveshell.py\", line 3061, in _run_cell\n    result = runner(coro)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/async_helpers.py\", line 129, in _pseudo_sync_runner\n    coro.send(None)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/interactiveshell.py\", line 3266, in run_cell_async\n    has_raised = await self.run_ast_nodes(code_ast.body, cell_name,\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/interactiveshell.py\", line 3445, in run_ast_nodes\n    if await self.run_code(code, result, async_=asy):\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/interactiveshell.py\", line 3505, in run_code\n    exec(code_obj, self.user_global_ns, self.user_ns)\n  File \"/tmp/ipykernel_532/617960493.py\", line 14, in <module>\n    fn(torch.randn(3))\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py\", line 832, in compile_wrapper\n    return fn(*args, **kwargs)\n\nStep 1: torchdynamo start tracing torch_dynamo_resume_in_fn_at_11 /tmp/ipykernel_532/617960493.py:11\ncreate_env\nTRACE starts_line /tmp/ipykernel_532/617960493.py:11 in torch_dynamo_resume_in_fn_at_11\n        inner(3)\nTRACE LOAD_CONST True []\nTRACE STORE_FAST __is_tracing_resume_prologue [ConstantVariable(bool: True)]\nTRACE LOAD_FAST ___stack0 []\nTRACE LOAD_CONST False [LazyVariableTracker()]\nTRACE STORE_FAST __is_tracing_resume_prologue [LazyVariableTracker(), ConstantVariable(bool: False)]\nTRACE JUMP_ABSOLUTE 54 [LazyVariableTracker()]\nTRACE POP_TOP None [LazyVariableTracker()]\nTRACE starts_line /tmp/ipykernel_532/617960493.py:12 in torch_dynamo_resume_in_fn_at_11\n        inner(4)\nTRACE LOAD_FAST inner []\nTRACE LOAD_CONST 4 [LazyVariableTracker()]\nTRACE CALL_FUNCTION 1 [LazyVariableTracker(), ConstantVariable(int: 4)]\nINLINING <code object inner at 0x7fab86007aa0, file \"/tmp/ipykernel_532/617960493.py\", line 3>, inlined according trace_rules.lookup inlined by default\nTRACE starts_line /tmp/ipykernel_532/617960493.py:5 in inner (inline depth: 1)\n            x = x + 1\nTRACE LOAD_DEREF x []\nTRACE LOAD_CONST 1 [LazyVariableTracker()]\nTRACE BINARY_ADD None [LazyVariableTracker(), ConstantVariable(int: 1)]\nwrap_to_fake L['x'] (3,) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None], constraint_strides=[None], specialize_on=[[]], view_base_context=None, tensor_source=LocalSource(local_name='x', is_input=False, dynamism=None, is_derefed_cell_contents=True), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>\ncreate_graph_input L_x_ L['x'] FakeTensor(..., size=(3,)) at debug_level 0 before=False\nTRACE STORE_DEREF x [TensorVariable()]\nTRACE starts_line /tmp/ipykernel_532/617960493.py:6 in inner (inline depth: 1)\n            if i == 3:\nTRACE LOAD_FAST i []\nTRACE LOAD_CONST 3 [ConstantVariable(int: 4)]\nTRACE COMPARE_OP == [ConstantVariable(int: 4), ConstantVariable(int: 3)]\nTRACE POP_JUMP_IF_FALSE 30 [ConstantVariable(bool: False)]\nTRACE LOAD_CONST None []\nTRACE RETURN_VALUE None [ConstantVariable(NoneType: None)]\nDONE INLINING <code object inner at 0x7fab86007aa0, file \"/tmp/ipykernel_532/617960493.py\", line 3>\nTRACE POP_TOP None [ConstantVariable(NoneType: None)]\nTRACE starts_line /tmp/ipykernel_532/617960493.py:13 in torch_dynamo_resume_in_fn_at_11\n        return x\nTRACE LOAD_DEREF x []\nTRACE RETURN_VALUE None [TensorVariable()]\nStep 1: torchdynamo done tracing torch_dynamo_resume_in_fn_at_11 (RETURN_VALUE)\nRETURN_VALUE triggered compile\nCOMPILING GRAPH due to GraphCompileReason(reason='return_value', user_stack=[<FrameSummary file /tmp/ipykernel_532/617960493.py, line 13 in torch_dynamo_resume_in_fn_at_11>], graph_break=False)\nTRACED GRAPH\n ===== __compiled_fn_16_240112e8_d62a_444c_a9ef_5bde0a078bbd =====\n /opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/fx/_lazy_graph_module.py class GraphModule(torch.nn.Module):\n    def forward(self, L_x_: \"f32[3][1]cpu\"):\n        l_x_ = L_x_\n        \n         # File: /tmp/ipykernel_532/617960493.py:5 in inner, code: x = x + 1\n        x: \"f32[3][1]cpu\" = l_x_ + 1;  l_x_ = None\n        return (x,)\n        \n\nStep 2: calling compiler function eager\nStep 2: done compiler function eager\nproduce_guards\ntrack_symint L['x'].size()[0] 3 None\ntrack_symint L['x'].stride()[0] 1 None\ntrack_symint L['x'].storage_offset() 0 None\nSkipping guard L['x'].size()[0] == 3\nSkipping guard L['x'].stride()[0] == 1\nSkipping guard L['x'].storage_offset() == 0\nGUARDS:\n\nTREE_GUARD_MANAGER:\n+- RootGuardManager\n| +- LAMBDA_GUARD: torch._functorch.aot_autograd.utils.top_saved_tensors_hooks ids == None  # _dynamo/output_graph.py:688 in init_ambient_guards\n| +- DEFAULT_DEVICE: utils_device.CURRENT_DEVICE == None                           # _dynamo/output_graph.py:676 in init_ambient_guards\n| +- GLOBAL_STATE: ___check_global_state()\n| +- TORCH_FUNCTION_MODE_STACK: ___check_torch_function_mode_stack()\n| +- GuardManager: source=L['x'], accessed_by=FrameLocalsGuardAccessor(key='x', framelocals_idx=6), type=<class 'torch.Tensor'>, tag_safe=(True, False)\n| | +- TENSOR_MATCH: check_tensor(L['x'], Tensor, DispatchKeySet(CPU, BackendSelect, ADInplaceOrView, AutogradCPU), torch.float32, device=None, requires_grad=False, size=[3], stride=[1])  # x = x + 1  # mp/ipykernel_532/617960493.py:5 in inner\n| | +- NO_HASATTR: hasattr(L['x'], '_dynamo_dynamic_indices') == False           # x = x + 1  # mp/ipykernel_532/617960493.py:5 in inner\n| +- GuardManager: source=L['inner'], accessed_by=FrameLocalsGuardAccessor(key='inner', framelocals_idx=3), type=<class 'function'>, tag_safe=(True, False)\n| | +- GuardManager: source=L['inner'].__code__, accessed_by=CodeGuardAccessor, type=<class 'code'>, tag_safe=(True, False)\n| | | +- ID_MATCH: ___check_obj_id(L['inner'].__code__, 140374664313504)         # inner(4)  # mp/ipykernel_532/617960493.py:12 in torch_dynamo_resume_in_fn_at_11\n\nGuard eval latency = 1147.51 us\nput_code_state: no cache key, skipping\nrun_gc_after_compile: running gc\nskipping because no torch.* remove             /opt/conda/envs/py_3.10/lib/python3.10/weakref.py 370\n\n```\n\n\n```python\ntensor([4.3159, 5.4236, 5.5645])\n\n```\n\nIn general, resolving the graph break causing the skip will also resolve the skip.\n\n## Graph Break in a Context Manager#\n\nAnother common example of an unresumable graph break is a graph break in most context managers:\n\n```python\nclass CustomCtxManager:\n    def __enter__(self):\n        pass\n    def __exit__(self, exc_type, exc_value, traceback):\n        pass\n@torch.compile\ndef fn(x):\n    with CustomCtxManager():\n        x = x + 1\n        torch._dynamo.graph_break()\n        return x + 1\nfn(torch.randn(3))\n\n```\n\n\n```python\ntorchdynamo start compiling fn /tmp/ipykernel_532/4148913404.py:6, stack (elided 5 frames):\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/runpy.py\", line 196, in _run_module_as_main\n    return _run_code(code, main_globals, None,\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/runpy.py\", line 86, in _run_code\n    exec(code, run_globals)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel_launcher.py\", line 18, in <module>\n    app.launch_new_instance()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/traitlets/config/application.py\", line 1075, in launch_instance\n    app.start()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/kernelapp.py\", line 758, in start\n    self.io_loop.start()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/tornado/platform/asyncio.py\", line 211, in start\n    self.asyncio_loop.run_forever()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/asyncio/base_events.py\", line 603, in run_forever\n    self._run_once()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/asyncio/base_events.py\", line 1909, in _run_once\n    handle._run()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/asyncio/events.py\", line 80, in _run\n    self._context.run(self._callback, *self._args)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/utils.py\", line 71, in preserve_context\n    return await f(*args, **kwargs)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/kernelbase.py\", line 614, in shell_main\n    await self.dispatch_shell(msg, subshell_id=subshell_id)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/kernelbase.py\", line 471, in dispatch_shell\n    await result\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/ipkernel.py\", line 366, in execute_request\n    await super().execute_request(stream, ident, parent)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/kernelbase.py\", line 827, in execute_request\n    reply_content = await reply_content\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/ipkernel.py\", line 458, in do_execute\n    res = shell.run_cell(\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/zmqshell.py\", line 663, in run_cell\n    return super().run_cell(*args, **kwargs)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/interactiveshell.py\", line 3006, in run_cell\n    result = self._run_cell(\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/interactiveshell.py\", line 3061, in _run_cell\n    result = runner(coro)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/async_helpers.py\", line 129, in _pseudo_sync_runner\n    coro.send(None)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/interactiveshell.py\", line 3266, in run_cell_async\n    has_raised = await self.run_ast_nodes(code_ast.body, cell_name,\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/interactiveshell.py\", line 3445, in run_ast_nodes\n    if await self.run_code(code, result, async_=asy):\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/interactiveshell.py\", line 3505, in run_code\n    exec(code_obj, self.user_global_ns, self.user_ns)\n  File \"/tmp/ipykernel_532/4148913404.py\", line 12, in <module>\n    fn(torch.randn(3))\n\nStep 1: torchdynamo start tracing fn /tmp/ipykernel_532/4148913404.py:6\ncreate_env\nTRACE starts_line /tmp/ipykernel_532/4148913404.py:8 in fn\n        with CustomCtxManager():\nTRACE LOAD_GLOBAL CustomCtxManager []\nTRACE CALL_FUNCTION 0 [LazyVariableTracker()]\nTRACE SETUP_WITH 48 [GenericContextWrappingVariable(CustomCtxManager)]\nINLINING <code object __enter__ at 0x7fabee5323f0, file \"/tmp/ipykernel_532/4148913404.py\", line 2>, inlined according trace_rules.lookup inlined by default\nTRACE starts_line /tmp/ipykernel_532/4148913404.py:3 in __enter__ (inline depth: 1)\n            pass\nTRACE LOAD_CONST None []\nTRACE RETURN_VALUE None [ConstantVariable(NoneType: None)]\nDONE INLINING <code object __enter__ at 0x7fabee5323f0, file \"/tmp/ipykernel_532/4148913404.py\", line 2>\nTRACE POP_TOP None [WithExitFunctionVariable(), ConstantVariable(NoneType: None)]\nTRACE starts_line /tmp/ipykernel_532/4148913404.py:9 in fn\n            x = x + 1\nTRACE LOAD_FAST x [WithExitFunctionVariable()]\nTRACE LOAD_CONST 1 [WithExitFunctionVariable(), LazyVariableTracker()]\nTRACE BINARY_ADD None [WithExitFunctionVariable(), LazyVariableTracker(), ConstantVariable(int: 1)]\nwrap_to_fake L['x'] (3,) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None], constraint_strides=[None], specialize_on=[[]], view_base_context=None, tensor_source=LocalSource(local_name='x', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>\ncreate_graph_input L_x_ L['x'] FakeTensor(..., size=(3,)) at debug_level 0 before=False\nTRACE STORE_FAST x [WithExitFunctionVariable(), TensorVariable()]\nTRACE starts_line /tmp/ipykernel_532/4148913404.py:10 in fn\n            torch._dynamo.graph_break()\nTRACE LOAD_GLOBAL torch [WithExitFunctionVariable()]\nTRACE LOAD_ATTR _dynamo [WithExitFunctionVariable(), LazyVariableTracker()]\nTRACE LOAD_ATTR graph_break [WithExitFunctionVariable(), LazyVariableTracker()]\nTRACE CALL_FUNCTION 0 [WithExitFunctionVariable(), LazyVariableTracker()]\nempty checkpoint\nrun_gc_after_compile: running gc\nGraph break: skip: from user code at:\n  File \"/tmp/ipykernel_532/4148913404.py\", line 10, in fn\n    torch._dynamo.graph_break()\nTraceback (most recent call last):\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/_dynamo/symbolic_convert.py\", line 904, in wrapper\n    return inner_fn(self, inst)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/_dynamo/symbolic_convert.py\", line 2333, in CALL_FUNCTION\n    self.call_function(fn, args, {})\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/_dynamo/symbolic_convert.py\", line 1266, in call_function\n    self.push(fn.call_function(self, args, kwargs))  # type: ignore[arg-type]\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/_dynamo/variables/lazy.py\", line 212, in realize_and_forward\n    return getattr(self.realize(), name)(*args, **kwargs)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/_dynamo/variables/functions.py\", line 1515, in call_function\n    unimplemented_v2(\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/_dynamo/exc.py\", line 596, in unimplemented_v2\n    raise Unsupported(msg)\ntorch._dynamo.exc.Unsupported: Call to `torch._dynamo.graph_break()`\n  Explanation: User-inserted graph break. Message: None\n  Hint: Remove the `torch._dynamo.graph_break()` call.\n\n  Developer debug context: Called `torch._dynamo.graph_break()` with args `[]`, kwargs `{}`\n\n For more details about this graph break, please visit: https://meta-pytorch.github.io/compile-graph-break-site/gb/gb0025.html\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/_dynamo/convert_frame.py\", line 1625, in __call__\n    result = self._inner_convert(\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/_dynamo/convert_frame.py\", line 688, in __call__\n    result = _compile(\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/_dynamo/convert_frame.py\", line 1434, in _compile\n    guarded_code, tracer_output = compile_inner(code, one_graph, hooks)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/_utils_internal.py\", line 92, in wrapper_function\n    return function(*args, **kwargs)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/_dynamo/convert_frame.py\", line 1117, in compile_inner\n    return _compile_inner(code, one_graph, hooks)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/_dynamo/convert_frame.py\", line 1151, in _compile_inner\n    dynamo_output = compile_frame(\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/_dynamo/convert_frame.py\", line 1032, in compile_frame\n    bytecode, tracer_output = transform_code_object(code, transform)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/_dynamo/bytecode_transformation.py\", line 1592, in transform_code_object\n    tracer_output = transformations(instructions, code_options)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/_dynamo/convert_frame.py\", line 1004, in transform\n    tracer_output = trace_frame(\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/_dynamo/convert_frame.py\", line 312, in _fn\n    return fn(*args, **kwargs)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/_dynamo/convert_frame.py\", line 815, in trace_frame\n    run_tracer()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/_dynamo/convert_frame.py\", line 797, in run_tracer\n    tracer.run()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/_dynamo/symbolic_convert.py\", line 1500, in run\n    while self.step():\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/_dynamo/symbolic_convert.py\", line 1348, in step\n    self.dispatch_table[inst.opcode](self, inst)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/_dynamo/symbolic_convert.py\", line 910, in wrapper\n    unimplemented_v2(\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/_dynamo/exc.py\", line 595, in unimplemented_v2\n    raise Unsupported(msg) from from_exc\ntorch._dynamo.exc.Unsupported: Graph break under GenericContextWrappingVariable\n  Explanation: Attempted to graph break in an active context manager(s) that doesn't support graph breaking.\n  Hint: Move the offending context manager(s) to outside the compiled region.\n  Hint: This graph break may have been caused by an earlier graph break. Resolving the earlier graph break may resolve this one.\n\n  Developer debug context: Active generic context managers: [GenericContextWrappingVariable(CustomCtxManager)]\n\n For more details about this graph break, please visit: https://meta-pytorch.github.io/compile-graph-break-site/gb/gb0066.html\n\nfrom user code:\n   File \"/tmp/ipykernel_532/4148913404.py\", line 10, in fn\n    torch._dynamo.graph_break()\n\nSet TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS=\"+dynamo\"\n\nWON'T CONVERT fn /tmp/ipykernel_532/4148913404.py line 6 \ndue to: \nTraceback (most recent call last):\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/_dynamo/symbolic_convert.py\", line 904, in wrapper\n    return inner_fn(self, inst)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/_dynamo/symbolic_convert.py\", line 2333, in CALL_FUNCTION\n    self.call_function(fn, args, {})\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/_dynamo/symbolic_convert.py\", line 1266, in call_function\n    self.push(fn.call_function(self, args, kwargs))  # type: ignore[arg-type]\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/_dynamo/variables/lazy.py\", line 212, in realize_and_forward\n    return getattr(self.realize(), name)(*args, **kwargs)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/_dynamo/variables/functions.py\", line 1515, in call_function\n    unimplemented_v2(\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/_dynamo/exc.py\", line 596, in unimplemented_v2\n    raise Unsupported(msg)\ntorch._dynamo.exc.Unsupported: Call to `torch._dynamo.graph_break()`\n  Explanation: User-inserted graph break. Message: None\n  Hint: Remove the `torch._dynamo.graph_break()` call.\n\n  Developer debug context: Called `torch._dynamo.graph_break()` with args `[]`, kwargs `{}`\n\n For more details about this graph break, please visit: https://meta-pytorch.github.io/compile-graph-break-site/gb/gb0025.html\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/_dynamo/convert_frame.py\", line 1625, in __call__\n    result = self._inner_convert(\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/_dynamo/convert_frame.py\", line 688, in __call__\n    result = _compile(\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/_dynamo/convert_frame.py\", line 1434, in _compile\n    guarded_code, tracer_output = compile_inner(code, one_graph, hooks)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/_utils_internal.py\", line 92, in wrapper_function\n    return function(*args, **kwargs)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/_dynamo/convert_frame.py\", line 1117, in compile_inner\n    return _compile_inner(code, one_graph, hooks)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/_dynamo/convert_frame.py\", line 1151, in _compile_inner\n    dynamo_output = compile_frame(\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/_dynamo/convert_frame.py\", line 1032, in compile_frame\n    bytecode, tracer_output = transform_code_object(code, transform)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/_dynamo/bytecode_transformation.py\", line 1592, in transform_code_object\n    tracer_output = transformations(instructions, code_options)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/_dynamo/convert_frame.py\", line 1004, in transform\n    tracer_output = trace_frame(\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/_dynamo/convert_frame.py\", line 312, in _fn\n    return fn(*args, **kwargs)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/_dynamo/convert_frame.py\", line 815, in trace_frame\n    run_tracer()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/_dynamo/convert_frame.py\", line 797, in run_tracer\n    tracer.run()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/_dynamo/symbolic_convert.py\", line 1500, in run\n    while self.step():\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/_dynamo/symbolic_convert.py\", line 1348, in step\n    self.dispatch_table[inst.opcode](self, inst)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/_dynamo/symbolic_convert.py\", line 910, in wrapper\n    unimplemented_v2(\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/_dynamo/exc.py\", line 595, in unimplemented_v2\n    raise Unsupported(msg) from from_exc\ntorch._dynamo.exc.Unsupported: Graph break under GenericContextWrappingVariable\n  Explanation: Attempted to graph break in an active context manager(s) that doesn't support graph breaking.\n  Hint: Move the offending context manager(s) to outside the compiled region.\n  Hint: This graph break may have been caused by an earlier graph break. Resolving the earlier graph break may resolve this one.\n\n  Developer debug context: Active generic context managers: [GenericContextWrappingVariable(CustomCtxManager)]\n\n For more details about this graph break, please visit: https://meta-pytorch.github.io/compile-graph-break-site/gb/gb0066.html\n\nfrom user code:\n   File \"/tmp/ipykernel_532/4148913404.py\", line 10, in fn\n    torch._dynamo.graph_break()\n\nSet TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS=\"+dynamo\"\n\nTraceback (most recent call last):\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/_dynamo/symbolic_convert.py\", line 904, in wrapper\n    return inner_fn(self, inst)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/_dynamo/symbolic_convert.py\", line 2333, in CALL_FUNCTION\n    self.call_function(fn, args, {})\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/_dynamo/symbolic_convert.py\", line 1266, in call_function\n    self.push(fn.call_function(self, args, kwargs))  # type: ignore[arg-type]\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/_dynamo/variables/lazy.py\", line 212, in realize_and_forward\n    return getattr(self.realize(), name)(*args, **kwargs)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/_dynamo/variables/functions.py\", line 1515, in call_function\n    unimplemented_v2(\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/_dynamo/exc.py\", line 596, in unimplemented_v2\n    raise Unsupported(msg)\ntorch._dynamo.exc.Unsupported: Call to `torch._dynamo.graph_break()`\n  Explanation: User-inserted graph break. Message: None\n  Hint: Remove the `torch._dynamo.graph_break()` call.\n\n  Developer debug context: Called `torch._dynamo.graph_break()` with args `[]`, kwargs `{}`\n\n For more details about this graph break, please visit: https://meta-pytorch.github.io/compile-graph-break-site/gb/gb0025.html\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/_dynamo/convert_frame.py\", line 1625, in __call__\n    result = self._inner_convert(\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/_dynamo/convert_frame.py\", line 688, in __call__\n    result = _compile(\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/_dynamo/convert_frame.py\", line 1434, in _compile\n    guarded_code, tracer_output = compile_inner(code, one_graph, hooks)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/_utils_internal.py\", line 92, in wrapper_function\n    return function(*args, **kwargs)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/_dynamo/convert_frame.py\", line 1117, in compile_inner\n    return _compile_inner(code, one_graph, hooks)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/_dynamo/convert_frame.py\", line 1151, in _compile_inner\n    dynamo_output = compile_frame(\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/_dynamo/convert_frame.py\", line 1032, in compile_frame\n    bytecode, tracer_output = transform_code_object(code, transform)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/_dynamo/bytecode_transformation.py\", line 1592, in transform_code_object\n    tracer_output = transformations(instructions, code_options)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/_dynamo/convert_frame.py\", line 1004, in transform\n    tracer_output = trace_frame(\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/_dynamo/convert_frame.py\", line 312, in _fn\n    return fn(*args, **kwargs)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/_dynamo/convert_frame.py\", line 815, in trace_frame\n    run_tracer()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/_dynamo/convert_frame.py\", line 797, in run_tracer\n    tracer.run()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/_dynamo/symbolic_convert.py\", line 1500, in run\n    while self.step():\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/_dynamo/symbolic_convert.py\", line 1348, in step\n    self.dispatch_table[inst.opcode](self, inst)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/_dynamo/symbolic_convert.py\", line 910, in wrapper\n    unimplemented_v2(\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/_dynamo/exc.py\", line 595, in unimplemented_v2\n    raise Unsupported(msg) from from_exc\ntorch._dynamo.exc.Unsupported: Graph break under GenericContextWrappingVariable\n  Explanation: Attempted to graph break in an active context manager(s) that doesn't support graph breaking.\n  Hint: Move the offending context manager(s) to outside the compiled region.\n  Hint: This graph break may have been caused by an earlier graph break. Resolving the earlier graph break may resolve this one.\n\n  Developer debug context: Active generic context managers: [GenericContextWrappingVariable(CustomCtxManager)]\n\n For more details about this graph break, please visit: https://meta-pytorch.github.io/compile-graph-break-site/gb/gb0066.html\n\nfrom user code:\n   File \"/tmp/ipykernel_532/4148913404.py\", line 10, in fn\n    torch._dynamo.graph_break()\n\nSet TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS=\"+dynamo\"\n\nskipping because no torch.* __enter__             /tmp/ipykernel_532/4148913404.py 2\nskipping because no torch.* __exit__             /tmp/ipykernel_532/4148913404.py 4\n\n```\n\n\n```python\ntensor([2.9449, 2.7372, 1.0708])\n\n```\n\nWe can avoid skipping by moving the graph break outside of the context manager:\n\n```python\n@torch.compile\ndef fn(x):\n    with CustomCtxManager():\n        x = x + 1\n    torch._dynamo.graph_break()\n    with CustomCtxManager():\n        return x + 1\nfn(torch.randn(3))\n\n```\n\n\n```python\ntorchdynamo start compiling fn /tmp/ipykernel_532/2124425154.py:1, stack (elided 5 frames):\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/runpy.py\", line 196, in _run_module_as_main\n    return _run_code(code, main_globals, None,\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/runpy.py\", line 86, in _run_code\n    exec(code, run_globals)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel_launcher.py\", line 18, in <module>\n    app.launch_new_instance()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/traitlets/config/application.py\", line 1075, in launch_instance\n    app.start()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/kernelapp.py\", line 758, in start\n    self.io_loop.start()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/tornado/platform/asyncio.py\", line 211, in start\n    self.asyncio_loop.run_forever()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/asyncio/base_events.py\", line 603, in run_forever\n    self._run_once()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/asyncio/base_events.py\", line 1909, in _run_once\n    handle._run()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/asyncio/events.py\", line 80, in _run\n    self._context.run(self._callback, *self._args)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/utils.py\", line 71, in preserve_context\n    return await f(*args, **kwargs)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/kernelbase.py\", line 614, in shell_main\n    await self.dispatch_shell(msg, subshell_id=subshell_id)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/kernelbase.py\", line 471, in dispatch_shell\n    await result\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/ipkernel.py\", line 366, in execute_request\n    await super().execute_request(stream, ident, parent)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/kernelbase.py\", line 827, in execute_request\n    reply_content = await reply_content\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/ipkernel.py\", line 458, in do_execute\n    res = shell.run_cell(\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/zmqshell.py\", line 663, in run_cell\n    return super().run_cell(*args, **kwargs)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/interactiveshell.py\", line 3006, in run_cell\n    result = self._run_cell(\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/interactiveshell.py\", line 3061, in _run_cell\n    result = runner(coro)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/async_helpers.py\", line 129, in _pseudo_sync_runner\n    coro.send(None)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/interactiveshell.py\", line 3266, in run_cell_async\n    has_raised = await self.run_ast_nodes(code_ast.body, cell_name,\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/interactiveshell.py\", line 3445, in run_ast_nodes\n    if await self.run_code(code, result, async_=asy):\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/interactiveshell.py\", line 3505, in run_code\n    exec(code_obj, self.user_global_ns, self.user_ns)\n  File \"/tmp/ipykernel_532/2124425154.py\", line 8, in <module>\n    fn(torch.randn(3))\n\nStep 1: torchdynamo start tracing fn /tmp/ipykernel_532/2124425154.py:1\ncreate_env\nTRACE starts_line /tmp/ipykernel_532/2124425154.py:3 in fn\n        with CustomCtxManager():\nTRACE LOAD_GLOBAL CustomCtxManager []\nTRACE CALL_FUNCTION 0 [LazyVariableTracker()]\nTRACE SETUP_WITH 30 [GenericContextWrappingVariable(CustomCtxManager)]\nINLINING <code object __enter__ at 0x7fabee5323f0, file \"/tmp/ipykernel_532/4148913404.py\", line 2>, inlined according trace_rules.lookup inlined by default\nTRACE starts_line /tmp/ipykernel_532/4148913404.py:3 in __enter__ (inline depth: 1)\n            pass\nTRACE LOAD_CONST None []\nTRACE RETURN_VALUE None [ConstantVariable(NoneType: None)]\nDONE INLINING <code object __enter__ at 0x7fabee5323f0, file \"/tmp/ipykernel_532/4148913404.py\", line 2>\nTRACE POP_TOP None [WithExitFunctionVariable(), ConstantVariable(NoneType: None)]\nTRACE starts_line /tmp/ipykernel_532/2124425154.py:4 in fn\n            x = x + 1\nTRACE LOAD_FAST x [WithExitFunctionVariable()]\nTRACE LOAD_CONST 1 [WithExitFunctionVariable(), LazyVariableTracker()]\nTRACE BINARY_ADD None [WithExitFunctionVariable(), LazyVariableTracker(), ConstantVariable(int: 1)]\nwrap_to_fake L['x'] (3,) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None], constraint_strides=[None], specialize_on=[[]], view_base_context=None, tensor_source=LocalSource(local_name='x', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>\ncreate_graph_input L_x_ L['x'] FakeTensor(..., size=(3,)) at debug_level 0 before=False\nTRACE STORE_FAST x [WithExitFunctionVariable(), TensorVariable()]\nTRACE POP_BLOCK None [WithExitFunctionVariable()]\nTRACE starts_line /tmp/ipykernel_532/2124425154.py:3 in fn\n        with CustomCtxManager():\nTRACE LOAD_CONST None [WithExitFunctionVariable()]\nTRACE DUP_TOP None [WithExitFunctionVariable(), ConstantVariable(NoneType: None)]\nTRACE DUP_TOP None [WithExitFunctionVariable(), ConstantVariable(NoneType: None), ConstantVariable(NoneType: None)]\nTRACE CALL_FUNCTION 3 [WithExitFunctionVariable(), ConstantVariable(NoneType: None), ConstantVariable(NoneType: None), ConstantVariable(NoneType: None)]\nINLINING <code object __exit__ at 0x7fabe8268c90, file \"/tmp/ipykernel_532/4148913404.py\", line 4>, inlined according trace_rules.lookup inlined by default\nTRACE starts_line /tmp/ipykernel_532/4148913404.py:5 in __exit__ (inline depth: 1)\n            pass\nTRACE LOAD_CONST None []\nTRACE RETURN_VALUE None [ConstantVariable(NoneType: None)]\nDONE INLINING <code object __exit__ at 0x7fabe8268c90, file \"/tmp/ipykernel_532/4148913404.py\", line 4>\nTRACE POP_TOP None [ConstantVariable(NoneType: None)]\nTRACE JUMP_FORWARD 46 []\nTRACE starts_line /tmp/ipykernel_532/2124425154.py:5 in fn\n        torch._dynamo.graph_break()\nTRACE LOAD_GLOBAL torch []\nTRACE LOAD_ATTR _dynamo [LazyVariableTracker()]\nTRACE LOAD_ATTR graph_break [LazyVariableTracker()]\nTRACE CALL_FUNCTION 0 [LazyVariableTracker()]\nGraph break in user code at /tmp/ipykernel_532/2124425154.py:5\nGraph Break Reason: Call to `torch._dynamo.graph_break()`\n  Explanation: User-inserted graph break. Message: None\n  Hint: Remove the `torch._dynamo.graph_break()` call.\n\n  Developer debug context: Called `torch._dynamo.graph_break()` with args `[]`, kwargs `{}`\n\n For more details about this graph break, please visit: https://meta-pytorch.github.io/compile-graph-break-site/gb/gb0025.html\nUser code traceback:\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/runpy.py\", line 196, in _run_module_as_main\n    return _run_code(code, main_globals, None,\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/runpy.py\", line 86, in _run_code\n    exec(code, run_globals)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel_launcher.py\", line 18, in <module>\n    app.launch_new_instance()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/traitlets/config/application.py\", line 1075, in launch_instance\n    app.start()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/kernelapp.py\", line 758, in start\n    self.io_loop.start()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/tornado/platform/asyncio.py\", line 211, in start\n    self.asyncio_loop.run_forever()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/asyncio/base_events.py\", line 603, in run_forever\n    self._run_once()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/asyncio/base_events.py\", line 1909, in _run_once\n    handle._run()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/asyncio/events.py\", line 80, in _run\n    self._context.run(self._callback, *self._args)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/utils.py\", line 71, in preserve_context\n    return await f(*args, **kwargs)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/kernelbase.py\", line 614, in shell_main\n    await self.dispatch_shell(msg, subshell_id=subshell_id)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/kernelbase.py\", line 471, in dispatch_shell\n    await result\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/ipkernel.py\", line 366, in execute_request\n    await super().execute_request(stream, ident, parent)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/kernelbase.py\", line 827, in execute_request\n    reply_content = await reply_content\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/ipkernel.py\", line 458, in do_execute\n    res = shell.run_cell(\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/zmqshell.py\", line 663, in run_cell\n    return super().run_cell(*args, **kwargs)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/interactiveshell.py\", line 3006, in run_cell\n    result = self._run_cell(\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/interactiveshell.py\", line 3061, in _run_cell\n    result = runner(coro)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/async_helpers.py\", line 129, in _pseudo_sync_runner\n    coro.send(None)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/interactiveshell.py\", line 3266, in run_cell_async\n    has_raised = await self.run_ast_nodes(code_ast.body, cell_name,\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/interactiveshell.py\", line 3445, in run_ast_nodes\n    if await self.run_code(code, result, async_=asy):\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/interactiveshell.py\", line 3505, in run_code\n    exec(code_obj, self.user_global_ns, self.user_ns)\n  File \"/tmp/ipykernel_532/2124425154.py\", line 8, in <module>\n    fn(torch.randn(3))\n  File \"/tmp/ipykernel_532/2124425154.py\", line 5, in fn\n    torch._dynamo.graph_break()\n\nRestarting analysis due to _dynamo/symbolic_convert.py:249 in fail_and_restart_analysis\nStep 1: torchdynamo start tracing fn /tmp/ipykernel_532/2124425154.py:1\ncreate_env\nTRACE starts_line /tmp/ipykernel_532/2124425154.py:3 in fn\n        with CustomCtxManager():\nTRACE LOAD_GLOBAL CustomCtxManager []\nTRACE CALL_FUNCTION 0 [LazyVariableTracker()]\nTRACE SETUP_WITH 30 [GenericContextWrappingVariable(CustomCtxManager)]\nINLINING <code object __enter__ at 0x7fabee5323f0, file \"/tmp/ipykernel_532/4148913404.py\", line 2>, inlined according trace_rules.lookup inlined by default\nTRACE starts_line /tmp/ipykernel_532/4148913404.py:3 in __enter__ (inline depth: 1)\n            pass\nTRACE LOAD_CONST None []\nTRACE RETURN_VALUE None [ConstantVariable(NoneType: None)]\nDONE INLINING <code object __enter__ at 0x7fabee5323f0, file \"/tmp/ipykernel_532/4148913404.py\", line 2>\nTRACE POP_TOP None [WithExitFunctionVariable(), ConstantVariable(NoneType: None)]\nTRACE starts_line /tmp/ipykernel_532/2124425154.py:4 in fn\n            x = x + 1\nTRACE LOAD_FAST x [WithExitFunctionVariable()]\nTRACE LOAD_CONST 1 [WithExitFunctionVariable(), LazyVariableTracker()]\nTRACE BINARY_ADD None [WithExitFunctionVariable(), LazyVariableTracker(), ConstantVariable(int: 1)]\nwrap_to_fake L['x'] (3,) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None], constraint_strides=[None], specialize_on=[[]], view_base_context=None, tensor_source=LocalSource(local_name='x', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>\ncreate_graph_input L_x_ L['x'] FakeTensor(..., size=(3,)) at debug_level 0 before=False\nTRACE STORE_FAST x [WithExitFunctionVariable(), TensorVariable()]\nTRACE POP_BLOCK None [WithExitFunctionVariable()]\nTRACE starts_line /tmp/ipykernel_532/2124425154.py:3 in fn\n        with CustomCtxManager():\nTRACE LOAD_CONST None [WithExitFunctionVariable()]\nTRACE DUP_TOP None [WithExitFunctionVariable(), ConstantVariable(NoneType: None)]\nTRACE DUP_TOP None [WithExitFunctionVariable(), ConstantVariable(NoneType: None), ConstantVariable(NoneType: None)]\nTRACE CALL_FUNCTION 3 [WithExitFunctionVariable(), ConstantVariable(NoneType: None), ConstantVariable(NoneType: None), ConstantVariable(NoneType: None)]\nINLINING <code object __exit__ at 0x7fabe8268c90, file \"/tmp/ipykernel_532/4148913404.py\", line 4>, inlined according trace_rules.lookup inlined by default\nTRACE starts_line /tmp/ipykernel_532/4148913404.py:5 in __exit__ (inline depth: 1)\n            pass\nTRACE LOAD_CONST None []\nTRACE RETURN_VALUE None [ConstantVariable(NoneType: None)]\nDONE INLINING <code object __exit__ at 0x7fabe8268c90, file \"/tmp/ipykernel_532/4148913404.py\", line 4>\nTRACE POP_TOP None [ConstantVariable(NoneType: None)]\nTRACE JUMP_FORWARD 46 []\nTRACE starts_line /tmp/ipykernel_532/2124425154.py:5 in fn\n        torch._dynamo.graph_break()\nTRACE LOAD_GLOBAL torch []\nTRACE LOAD_ATTR _dynamo [LazyVariableTracker()]\nTRACE LOAD_ATTR graph_break [LazyVariableTracker()]\nTRACE CALL_FUNCTION 0 [LazyVariableTracker()]\nCOMPILING GRAPH due to GraphCompileReason(reason='Call to `torch._dynamo.graph_break()`\\n  Explanation: User-inserted graph break. Message: None\\n  Hint: Remove the `torch._dynamo.graph_break()` call.\\n\\n  Developer debug context: Called `torch._dynamo.graph_break()` with args `[]`, kwargs `{}`\\n\\n For more details about this graph break, please visit: https://meta-pytorch.github.io/compile-graph-break-site/gb/gb0025.html', user_stack=[<FrameSummary file /tmp/ipykernel_532/2124425154.py, line 5 in fn>], graph_break=True)\nTRACED GRAPH\n ===== __compiled_fn_20_763153f3_7654_433a_8e55_bfa1b1276b54 =====\n /opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/fx/_lazy_graph_module.py class GraphModule(torch.nn.Module):\n    def forward(self, L_x_: \"f32[3][1]cpu\"):\n        l_x_ = L_x_\n        \n         # File: /tmp/ipykernel_532/2124425154.py:4 in fn, code: x = x + 1\n        x: \"f32[3][1]cpu\" = l_x_ + 1;  l_x_ = None\n        return (x,)\n        \n\nStep 2: calling compiler function eager\nStep 2: done compiler function eager\nproduce_guards\ntrack_symint L['x'].size()[0] 3 None\ntrack_symint L['x'].stride()[0] 1 None\ntrack_symint L['x'].storage_offset() 0 None\nSkipping guard L['x'].size()[0] == 3\nSkipping guard L['x'].stride()[0] == 1\nSkipping guard L['x'].storage_offset() == 0\nGUARDS:\n\nTREE_GUARD_MANAGER:\n+- RootGuardManager\n| +- LAMBDA_GUARD: torch._functorch.aot_autograd.utils.top_saved_tensors_hooks ids == None  # _dynamo/output_graph.py:688 in init_ambient_guards\n| +- DEFAULT_DEVICE: utils_device.CURRENT_DEVICE == None                           # _dynamo/output_graph.py:676 in init_ambient_guards\n| +- GLOBAL_STATE: ___check_global_state()\n| +- TORCH_FUNCTION_MODE_STACK: ___check_torch_function_mode_stack()\n| +- GuardManager: source=L['x'], accessed_by=FrameLocalsGuardAccessor(key='x', framelocals_idx=0), type=<class 'torch.Tensor'>, tag_safe=(True, False)\n| | +- TENSOR_MATCH: check_tensor(L['x'], Tensor, DispatchKeySet(CPU, BackendSelect, ADInplaceOrView, AutogradCPU), torch.float32, device=None, requires_grad=False, size=[3], stride=[1])  # x = x + 1  # mp/ipykernel_532/2124425154.py:4 in fn\n| | +- NO_HASATTR: hasattr(L['x'], '_dynamo_dynamic_indices') == False           # x = x + 1  # mp/ipykernel_532/2124425154.py:4 in fn\n| +- GuardManager: source=G, accessed_by=GlobalsGuardAccessor, type=<class 'dict'>, tag_safe=(False, False)\n| | +- GuardManager: source=G['torch'], accessed_by=DictGetItemGuardAccessor('torch'), type=<class 'module'>, tag_safe=(False, False)\n| | | +- ID_MATCH: ___check_obj_id(G['torch'], 140376310990704)                  # torch._dynamo.graph_break()  # mp/ipykernel_532/2124425154.py:5 in fn\n| | | +- GuardManager: source=G['torch']._dynamo, accessed_by=GetAttrGuardAccessor(_dynamo), type=<class 'module'>, tag_safe=(False, False)\n| | | | +- ID_MATCH: ___check_obj_id(G['torch']._dynamo, 140374889071936)          # torch._dynamo.graph_break()  # mp/ipykernel_532/2124425154.py:5 in fn\n| | | | +- GuardManager: source=G['torch']._dynamo.graph_break, accessed_by=GetAttrGuardAccessor(graph_break), type=<class 'function'>, tag_safe=(True, False)\n| | | | | +- GuardManager: source=G['torch']._dynamo.graph_break.__code__, accessed_by=CodeGuardAccessor, type=<class 'code'>, tag_safe=(True, False)\n| | | | | | +- ID_MATCH: ___check_obj_id(G['torch']._dynamo.graph_break.__code__, 140374703207360)  # torch._dynamo.graph_break()  # mp/ipykernel_532/2124425154.py:5 in fn\n| | +- GuardManager: source=G['CustomCtxManager'], accessed_by=DictGetItemGuardAccessor('CustomCtxManager'), type=<class 'type'>, tag_safe=(True, False)\n| | | +- ID_MATCH: ___check_obj_id(G['CustomCtxManager'], 93956540677728)        # with CustomCtxManager():  # mp/ipykernel_532/2124425154.py:3 in fn\n\nGuard eval latency = 48.80 us\nput_code_state: no cache key, skipping\nrun_gc_after_compile: running gc\ntorchdynamo start compiling torch_dynamo_resume_in_fn_at_5 /tmp/ipykernel_532/2124425154.py:5, stack (elided 5 frames):\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/runpy.py\", line 196, in _run_module_as_main\n    return _run_code(code, main_globals, None,\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/runpy.py\", line 86, in _run_code\n    exec(code, run_globals)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel_launcher.py\", line 18, in <module>\n    app.launch_new_instance()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/traitlets/config/application.py\", line 1075, in launch_instance\n    app.start()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/kernelapp.py\", line 758, in start\n    self.io_loop.start()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/tornado/platform/asyncio.py\", line 211, in start\n    self.asyncio_loop.run_forever()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/asyncio/base_events.py\", line 603, in run_forever\n    self._run_once()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/asyncio/base_events.py\", line 1909, in _run_once\n    handle._run()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/asyncio/events.py\", line 80, in _run\n    self._context.run(self._callback, *self._args)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/utils.py\", line 71, in preserve_context\n    return await f(*args, **kwargs)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/kernelbase.py\", line 614, in shell_main\n    await self.dispatch_shell(msg, subshell_id=subshell_id)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/kernelbase.py\", line 471, in dispatch_shell\n    await result\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/ipkernel.py\", line 366, in execute_request\n    await super().execute_request(stream, ident, parent)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/kernelbase.py\", line 827, in execute_request\n    reply_content = await reply_content\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/ipkernel.py\", line 458, in do_execute\n    res = shell.run_cell(\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/zmqshell.py\", line 663, in run_cell\n    return super().run_cell(*args, **kwargs)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/interactiveshell.py\", line 3006, in run_cell\n    result = self._run_cell(\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/interactiveshell.py\", line 3061, in _run_cell\n    result = runner(coro)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/async_helpers.py\", line 129, in _pseudo_sync_runner\n    coro.send(None)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/interactiveshell.py\", line 3266, in run_cell_async\n    has_raised = await self.run_ast_nodes(code_ast.body, cell_name,\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/interactiveshell.py\", line 3445, in run_ast_nodes\n    if await self.run_code(code, result, async_=asy):\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/interactiveshell.py\", line 3505, in run_code\n    exec(code_obj, self.user_global_ns, self.user_ns)\n  File \"/tmp/ipykernel_532/2124425154.py\", line 8, in <module>\n    fn(torch.randn(3))\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py\", line 832, in compile_wrapper\n    return fn(*args, **kwargs)\n\nStep 1: torchdynamo start tracing torch_dynamo_resume_in_fn_at_5 /tmp/ipykernel_532/2124425154.py:5\ncreate_env\nTRACE starts_line /tmp/ipykernel_532/2124425154.py:5 in torch_dynamo_resume_in_fn_at_5\n        torch._dynamo.graph_break()\nTRACE LOAD_CONST True []\nTRACE STORE_FAST __is_tracing_resume_prologue [ConstantVariable(bool: True)]\nTRACE LOAD_FAST ___stack0 []\nTRACE LOAD_CONST False [LazyVariableTracker()]\nTRACE STORE_FAST __is_tracing_resume_prologue [LazyVariableTracker(), ConstantVariable(bool: False)]\nTRACE JUMP_ABSOLUTE 66 [LazyVariableTracker()]\nTRACE POP_TOP None [LazyVariableTracker()]\nTRACE starts_line /tmp/ipykernel_532/2124425154.py:6 in torch_dynamo_resume_in_fn_at_5\n        with CustomCtxManager():\nTRACE LOAD_GLOBAL CustomCtxManager []\nTRACE CALL_FUNCTION 0 [LazyVariableTracker()]\nTRACE SETUP_WITH 98 [GenericContextWrappingVariable(CustomCtxManager)]\nINLINING <code object __enter__ at 0x7fabee5323f0, file \"/tmp/ipykernel_532/4148913404.py\", line 2>, inlined according trace_rules.lookup inlined by default\nTRACE starts_line /tmp/ipykernel_532/4148913404.py:3 in __enter__ (inline depth: 1)\n            pass\nTRACE LOAD_CONST None []\nTRACE RETURN_VALUE None [ConstantVariable(NoneType: None)]\nDONE INLINING <code object __enter__ at 0x7fabee5323f0, file \"/tmp/ipykernel_532/4148913404.py\", line 2>\nTRACE POP_TOP None [WithExitFunctionVariable(), ConstantVariable(NoneType: None)]\nTRACE starts_line /tmp/ipykernel_532/2124425154.py:7 in torch_dynamo_resume_in_fn_at_5\n            return x + 1\nTRACE LOAD_FAST x [WithExitFunctionVariable()]\nTRACE LOAD_CONST 1 [WithExitFunctionVariable(), LazyVariableTracker()]\nTRACE BINARY_ADD None [WithExitFunctionVariable(), LazyVariableTracker(), ConstantVariable(int: 1)]\nwrap_to_fake L['x'] (3,) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None], constraint_strides=[None], specialize_on=[[]], view_base_context=None, tensor_source=LocalSource(local_name='x', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>\ncreate_graph_input L_x_ L['x'] FakeTensor(..., size=(3,)) at debug_level 0 before=False\nTRACE starts_line /tmp/ipykernel_532/2124425154.py:6 in torch_dynamo_resume_in_fn_at_5\n        with CustomCtxManager():\nTRACE POP_BLOCK None [WithExitFunctionVariable(), TensorVariable()]\nTRACE ROT_TWO None [WithExitFunctionVariable(), TensorVariable()]\nTRACE LOAD_CONST None [TensorVariable(), WithExitFunctionVariable()]\nTRACE DUP_TOP None [TensorVariable(), WithExitFunctionVariable(), ConstantVariable(NoneType: None)]\nTRACE DUP_TOP None [TensorVariable(), WithExitFunctionVariable(), ConstantVariable(NoneType: None), ConstantVariable(NoneType: None)]\nTRACE CALL_FUNCTION 3 [TensorVariable(), WithExitFunctionVariable(), ConstantVariable(NoneType: None), ConstantVariable(NoneType: None), ConstantVariable(NoneType: None)]\nINLINING <code object __exit__ at 0x7fabe8268c90, file \"/tmp/ipykernel_532/4148913404.py\", line 4>, inlined according trace_rules.lookup inlined by default\nTRACE starts_line /tmp/ipykernel_532/4148913404.py:5 in __exit__ (inline depth: 1)\n            pass\nTRACE LOAD_CONST None []\nTRACE RETURN_VALUE None [ConstantVariable(NoneType: None)]\nDONE INLINING <code object __exit__ at 0x7fabe8268c90, file \"/tmp/ipykernel_532/4148913404.py\", line 4>\nTRACE POP_TOP None [TensorVariable(), ConstantVariable(NoneType: None)]\nTRACE RETURN_VALUE None [TensorVariable()]\nStep 1: torchdynamo done tracing torch_dynamo_resume_in_fn_at_5 (RETURN_VALUE)\nRETURN_VALUE triggered compile\nCOMPILING GRAPH due to GraphCompileReason(reason='return_value', user_stack=[<FrameSummary file /tmp/ipykernel_532/2124425154.py, line 6 in torch_dynamo_resume_in_fn_at_5>], graph_break=False)\nTRACED GRAPH\n ===== __compiled_fn_23_df525bd6_d853_4d00_8aac_8dccfb55e2ea =====\n /opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/fx/_lazy_graph_module.py class GraphModule(torch.nn.Module):\n    def forward(self, L_x_: \"f32[3][1]cpu\"):\n        l_x_ = L_x_\n        \n         # File: /tmp/ipykernel_532/2124425154.py:7 in torch_dynamo_resume_in_fn_at_5, code: return x + 1\n        add: \"f32[3][1]cpu\" = l_x_ + 1;  l_x_ = None\n        return (add,)\n        \n\nStep 2: calling compiler function eager\nStep 2: done compiler function eager\nproduce_guards\ntrack_symint L['x'].size()[0] 3 None\ntrack_symint L['x'].stride()[0] 1 None\ntrack_symint L['x'].storage_offset() 0 None\nSkipping guard L['x'].size()[0] == 3\nSkipping guard L['x'].stride()[0] == 1\nSkipping guard L['x'].storage_offset() == 0\nGUARDS:\n\nTREE_GUARD_MANAGER:\n+- RootGuardManager\n| +- LAMBDA_GUARD: torch._functorch.aot_autograd.utils.top_saved_tensors_hooks ids == None  # _dynamo/output_graph.py:688 in init_ambient_guards\n| +- DEFAULT_DEVICE: utils_device.CURRENT_DEVICE == None                           # _dynamo/output_graph.py:676 in init_ambient_guards\n| +- GLOBAL_STATE: ___check_global_state()\n| +- TORCH_FUNCTION_MODE_STACK: ___check_torch_function_mode_stack()\n| +- GuardManager: source=L['x'], accessed_by=FrameLocalsGuardAccessor(key='x', framelocals_idx=3), type=<class 'torch.Tensor'>, tag_safe=(True, False)\n| | +- TENSOR_MATCH: check_tensor(L['x'], Tensor, DispatchKeySet(CPU, BackendSelect, ADInplaceOrView, AutogradCPU), torch.float32, device=None, requires_grad=False, size=[3], stride=[1])  # return x + 1  # mp/ipykernel_532/2124425154.py:7 in torch_dynamo_resume_in_fn_at_5\n| | +- NO_HASATTR: hasattr(L['x'], '_dynamo_dynamic_indices') == False           # return x + 1  # mp/ipykernel_532/2124425154.py:7 in torch_dynamo_resume_in_fn_at_5\n| +- GuardManager: source=G, accessed_by=GlobalsGuardAccessor, type=<class 'dict'>, tag_safe=(True, False)\n| | +- GuardManager: source=G['CustomCtxManager'], accessed_by=DictGetItemGuardAccessor('CustomCtxManager'), type=<class 'type'>, tag_safe=(True, False)\n| | | +- ID_MATCH: ___check_obj_id(G['CustomCtxManager'], 93956540677728)        # with CustomCtxManager():  # mp/ipykernel_532/2124425154.py:6 in torch_dynamo_resume_in_fn_at_5\n\nGuard eval latency = 1087.49 us\nput_code_state: no cache key, skipping\nrun_gc_after_compile: running gc\n\n```\n\n\n```python\ntensor([1.5408, 1.1547, 1.4015])\n\n```\n\nThere are some context managers where Dynamo can resume after a graph break.\nSome of these can be found insupported_ctx_manager_classesintorch/_dynamo/variables/torch.py.\nIn general, any context manager represented by aContextWrappingVariablesubclass intorch/_dynamo/variables/ctx_manager.pysupport resuming after a graph break. For example:\nsupported_ctx_manager_classes\ntorch/_dynamo/variables/torch.py\nContextWrappingVariable\ntorch/_dynamo/variables/ctx_manager.py\n\n```python\nimport contextlib\n@torch.compile\ndef fn(x):\n    with contextlib.nullcontext():\n        with torch.no_grad():\n            x = x + 1\n            torch._dynamo.graph_break()\n            return x + 1\nfn(torch.randn(3))\n\n```\n\n\n```python\ntorchdynamo start compiling fn /tmp/ipykernel_532/3152636365.py:2, stack (elided 5 frames):\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/runpy.py\", line 196, in _run_module_as_main\n    return _run_code(code, main_globals, None,\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/runpy.py\", line 86, in _run_code\n    exec(code, run_globals)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel_launcher.py\", line 18, in <module>\n    app.launch_new_instance()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/traitlets/config/application.py\", line 1075, in launch_instance\n    app.start()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/kernelapp.py\", line 758, in start\n    self.io_loop.start()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/tornado/platform/asyncio.py\", line 211, in start\n    self.asyncio_loop.run_forever()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/asyncio/base_events.py\", line 603, in run_forever\n    self._run_once()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/asyncio/base_events.py\", line 1909, in _run_once\n    handle._run()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/asyncio/events.py\", line 80, in _run\n    self._context.run(self._callback, *self._args)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/utils.py\", line 71, in preserve_context\n    return await f(*args, **kwargs)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/kernelbase.py\", line 614, in shell_main\n    await self.dispatch_shell(msg, subshell_id=subshell_id)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/kernelbase.py\", line 471, in dispatch_shell\n    await result\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/ipkernel.py\", line 366, in execute_request\n    await super().execute_request(stream, ident, parent)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/kernelbase.py\", line 827, in execute_request\n    reply_content = await reply_content\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/ipkernel.py\", line 458, in do_execute\n    res = shell.run_cell(\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/zmqshell.py\", line 663, in run_cell\n    return super().run_cell(*args, **kwargs)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/interactiveshell.py\", line 3006, in run_cell\n    result = self._run_cell(\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/interactiveshell.py\", line 3061, in _run_cell\n    result = runner(coro)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/async_helpers.py\", line 129, in _pseudo_sync_runner\n    coro.send(None)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/interactiveshell.py\", line 3266, in run_cell_async\n    has_raised = await self.run_ast_nodes(code_ast.body, cell_name,\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/interactiveshell.py\", line 3445, in run_ast_nodes\n    if await self.run_code(code, result, async_=asy):\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/interactiveshell.py\", line 3505, in run_code\n    exec(code_obj, self.user_global_ns, self.user_ns)\n  File \"/tmp/ipykernel_532/3152636365.py\", line 9, in <module>\n    fn(torch.randn(3))\n\nStep 1: torchdynamo start tracing fn /tmp/ipykernel_532/3152636365.py:2\ncreate_env\nTRACE starts_line /tmp/ipykernel_532/3152636365.py:4 in fn\n        with contextlib.nullcontext():\nTRACE LOAD_GLOBAL contextlib []\nTRACE LOAD_ATTR nullcontext [LazyVariableTracker()]\nTRACE CALL_FUNCTION 0 [LazyVariableTracker()]\nTRACE SETUP_WITH 106 [NullContextVariable()]\nTRACE POP_TOP None [WithExitFunctionVariable(), ConstantVariable(NoneType: None)]\nTRACE starts_line /tmp/ipykernel_532/3152636365.py:5 in fn\n            with torch.no_grad():\nTRACE LOAD_GLOBAL torch [WithExitFunctionVariable()]\nTRACE LOAD_ATTR no_grad [WithExitFunctionVariable(), LazyVariableTracker()]\nTRACE CALL_FUNCTION 0 [WithExitFunctionVariable(), LazyVariableTracker()]\nTRACE SETUP_WITH 74 [WithExitFunctionVariable(), GradModeVariable()]\nTRACE POP_TOP None [WithExitFunctionVariable(), WithExitFunctionVariable(), ConstantVariable(NoneType: None)]\nTRACE starts_line /tmp/ipykernel_532/3152636365.py:6 in fn\n                x = x + 1\nTRACE LOAD_FAST x [WithExitFunctionVariable(), WithExitFunctionVariable()]\nTRACE LOAD_CONST 1 [WithExitFunctionVariable(), WithExitFunctionVariable(), LazyVariableTracker()]\nTRACE BINARY_ADD None [WithExitFunctionVariable(), WithExitFunctionVariable(), LazyVariableTracker(), ConstantVariable(int: 1)]\nwrap_to_fake L['x'] (3,) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None], constraint_strides=[None], specialize_on=[[]], view_base_context=None, tensor_source=LocalSource(local_name='x', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>\ncreate_graph_input L_x_ L['x'] FakeTensor(..., size=(3,)) at debug_level 0 before=False\nTRACE STORE_FAST x [WithExitFunctionVariable(), WithExitFunctionVariable(), TensorVariable()]\nTRACE starts_line /tmp/ipykernel_532/3152636365.py:7 in fn\n                torch._dynamo.graph_break()\nTRACE LOAD_GLOBAL torch [WithExitFunctionVariable(), WithExitFunctionVariable()]\nTRACE LOAD_ATTR _dynamo [WithExitFunctionVariable(), WithExitFunctionVariable(), LazyVariableTracker()]\nTRACE LOAD_ATTR graph_break [WithExitFunctionVariable(), WithExitFunctionVariable(), LazyVariableTracker()]\nTRACE CALL_FUNCTION 0 [WithExitFunctionVariable(), WithExitFunctionVariable(), LazyVariableTracker()]\nGraph break in user code at /tmp/ipykernel_532/3152636365.py:7\nGraph Break Reason: Call to `torch._dynamo.graph_break()`\n  Explanation: User-inserted graph break. Message: None\n  Hint: Remove the `torch._dynamo.graph_break()` call.\n\n  Developer debug context: Called `torch._dynamo.graph_break()` with args `[]`, kwargs `{}`\n\n For more details about this graph break, please visit: https://meta-pytorch.github.io/compile-graph-break-site/gb/gb0025.html\nUser code traceback:\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/runpy.py\", line 196, in _run_module_as_main\n    return _run_code(code, main_globals, None,\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/runpy.py\", line 86, in _run_code\n    exec(code, run_globals)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel_launcher.py\", line 18, in <module>\n    app.launch_new_instance()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/traitlets/config/application.py\", line 1075, in launch_instance\n    app.start()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/kernelapp.py\", line 758, in start\n    self.io_loop.start()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/tornado/platform/asyncio.py\", line 211, in start\n    self.asyncio_loop.run_forever()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/asyncio/base_events.py\", line 603, in run_forever\n    self._run_once()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/asyncio/base_events.py\", line 1909, in _run_once\n    handle._run()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/asyncio/events.py\", line 80, in _run\n    self._context.run(self._callback, *self._args)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/utils.py\", line 71, in preserve_context\n    return await f(*args, **kwargs)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/kernelbase.py\", line 614, in shell_main\n    await self.dispatch_shell(msg, subshell_id=subshell_id)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/kernelbase.py\", line 471, in dispatch_shell\n    await result\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/ipkernel.py\", line 366, in execute_request\n    await super().execute_request(stream, ident, parent)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/kernelbase.py\", line 827, in execute_request\n    reply_content = await reply_content\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/ipkernel.py\", line 458, in do_execute\n    res = shell.run_cell(\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/zmqshell.py\", line 663, in run_cell\n    return super().run_cell(*args, **kwargs)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/interactiveshell.py\", line 3006, in run_cell\n    result = self._run_cell(\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/interactiveshell.py\", line 3061, in _run_cell\n    result = runner(coro)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/async_helpers.py\", line 129, in _pseudo_sync_runner\n    coro.send(None)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/interactiveshell.py\", line 3266, in run_cell_async\n    has_raised = await self.run_ast_nodes(code_ast.body, cell_name,\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/interactiveshell.py\", line 3445, in run_ast_nodes\n    if await self.run_code(code, result, async_=asy):\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/interactiveshell.py\", line 3505, in run_code\n    exec(code_obj, self.user_global_ns, self.user_ns)\n  File \"/tmp/ipykernel_532/3152636365.py\", line 9, in <module>\n    fn(torch.randn(3))\n  File \"/tmp/ipykernel_532/3152636365.py\", line 7, in fn\n    torch._dynamo.graph_break()\n\nRestarting analysis due to _dynamo/symbolic_convert.py:249 in fail_and_restart_analysis\nStep 1: torchdynamo start tracing fn /tmp/ipykernel_532/3152636365.py:2\ncreate_env\nTRACE starts_line /tmp/ipykernel_532/3152636365.py:4 in fn\n        with contextlib.nullcontext():\nTRACE LOAD_GLOBAL contextlib []\nTRACE LOAD_ATTR nullcontext [LazyVariableTracker()]\nTRACE CALL_FUNCTION 0 [LazyVariableTracker()]\nTRACE SETUP_WITH 106 [NullContextVariable()]\nTRACE POP_TOP None [WithExitFunctionVariable(), ConstantVariable(NoneType: None)]\nTRACE starts_line /tmp/ipykernel_532/3152636365.py:5 in fn\n            with torch.no_grad():\nTRACE LOAD_GLOBAL torch [WithExitFunctionVariable()]\nTRACE LOAD_ATTR no_grad [WithExitFunctionVariable(), LazyVariableTracker()]\nTRACE CALL_FUNCTION 0 [WithExitFunctionVariable(), LazyVariableTracker()]\nTRACE SETUP_WITH 74 [WithExitFunctionVariable(), GradModeVariable()]\nTRACE POP_TOP None [WithExitFunctionVariable(), WithExitFunctionVariable(), ConstantVariable(NoneType: None)]\nTRACE starts_line /tmp/ipykernel_532/3152636365.py:6 in fn\n                x = x + 1\nTRACE LOAD_FAST x [WithExitFunctionVariable(), WithExitFunctionVariable()]\nTRACE LOAD_CONST 1 [WithExitFunctionVariable(), WithExitFunctionVariable(), LazyVariableTracker()]\nTRACE BINARY_ADD None [WithExitFunctionVariable(), WithExitFunctionVariable(), LazyVariableTracker(), ConstantVariable(int: 1)]\nwrap_to_fake L['x'] (3,) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None], constraint_strides=[None], specialize_on=[[]], view_base_context=None, tensor_source=LocalSource(local_name='x', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>\ncreate_graph_input L_x_ L['x'] FakeTensor(..., size=(3,)) at debug_level 0 before=False\nTRACE STORE_FAST x [WithExitFunctionVariable(), WithExitFunctionVariable(), TensorVariable()]\nTRACE starts_line /tmp/ipykernel_532/3152636365.py:7 in fn\n                torch._dynamo.graph_break()\nTRACE LOAD_GLOBAL torch [WithExitFunctionVariable(), WithExitFunctionVariable()]\nTRACE LOAD_ATTR _dynamo [WithExitFunctionVariable(), WithExitFunctionVariable(), LazyVariableTracker()]\nTRACE LOAD_ATTR graph_break [WithExitFunctionVariable(), WithExitFunctionVariable(), LazyVariableTracker()]\nTRACE CALL_FUNCTION 0 [WithExitFunctionVariable(), WithExitFunctionVariable(), LazyVariableTracker()]\nCOMPILING GRAPH due to GraphCompileReason(reason='Call to `torch._dynamo.graph_break()`\\n  Explanation: User-inserted graph break. Message: None\\n  Hint: Remove the `torch._dynamo.graph_break()` call.\\n\\n  Developer debug context: Called `torch._dynamo.graph_break()` with args `[]`, kwargs `{}`\\n\\n For more details about this graph break, please visit: https://meta-pytorch.github.io/compile-graph-break-site/gb/gb0025.html', user_stack=[<FrameSummary file /tmp/ipykernel_532/3152636365.py, line 7 in fn>], graph_break=True)\nTRACED GRAPH\n ===== __compiled_fn_26_b931600f_47fa_4e1d_8c6b_321de5fcc179 =====\n /opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/fx/_lazy_graph_module.py class GraphModule(torch.nn.Module):\n    def forward(self, L_x_: \"f32[3][1]cpu\"):\n        l_x_ = L_x_\n        \n        # No stacktrace found for following nodes\n        _set_grad_enabled = torch._C._set_grad_enabled(False);  _set_grad_enabled = None\n        \n         # File: /tmp/ipykernel_532/3152636365.py:6 in fn, code: x = x + 1\n        x: \"f32[3][1]cpu\" = l_x_ + 1;  l_x_ = None\n        \n        # No stacktrace found for following nodes\n        _set_grad_enabled_1 = torch._C._set_grad_enabled(True);  _set_grad_enabled_1 = None\n        return (x,)\n        \n\nStep 2: calling compiler function eager\nStep 2: done compiler function eager\nproduce_guards\ntrack_symint L['x'].size()[0] 3 None\ntrack_symint L['x'].stride()[0] 1 None\ntrack_symint L['x'].storage_offset() 0 None\nSkipping guard L['x'].size()[0] == 3\nSkipping guard L['x'].stride()[0] == 1\nSkipping guard L['x'].storage_offset() == 0\nGUARDS:\n\nTREE_GUARD_MANAGER:\n+- RootGuardManager\n| +- LAMBDA_GUARD: torch._functorch.aot_autograd.utils.top_saved_tensors_hooks ids == None  # _dynamo/output_graph.py:688 in init_ambient_guards\n| +- DEFAULT_DEVICE: utils_device.CURRENT_DEVICE == None                           # _dynamo/output_graph.py:676 in init_ambient_guards\n| +- GLOBAL_STATE: ___check_global_state()\n| +- TORCH_FUNCTION_MODE_STACK: ___check_torch_function_mode_stack()\n| +- GuardManager: source=L['x'], accessed_by=FrameLocalsGuardAccessor(key='x', framelocals_idx=0), type=<class 'torch.Tensor'>, tag_safe=(True, False)\n| | +- TENSOR_MATCH: check_tensor(L['x'], Tensor, DispatchKeySet(CPU, BackendSelect, ADInplaceOrView, AutogradCPU), torch.float32, device=None, requires_grad=False, size=[3], stride=[1])  # x = x + 1  # mp/ipykernel_532/3152636365.py:6 in fn\n| | +- NO_HASATTR: hasattr(L['x'], '_dynamo_dynamic_indices') == False           # x = x + 1  # mp/ipykernel_532/3152636365.py:6 in fn\n| +- GuardManager: source=G, accessed_by=GlobalsGuardAccessor, type=<class 'dict'>, tag_safe=(False, False)\n| | +- GuardManager: source=G['torch'], accessed_by=DictGetItemGuardAccessor('torch'), type=<class 'module'>, tag_safe=(False, False)\n| | | +- ID_MATCH: ___check_obj_id(G['torch'], 140376310990704)                  # with torch.no_grad():  # mp/ipykernel_532/3152636365.py:5 in fn\n| | | +- GuardManager: source=G['torch']._dynamo, accessed_by=GetAttrGuardAccessor(_dynamo), type=<class 'module'>, tag_safe=(False, False)\n| | | | +- ID_MATCH: ___check_obj_id(G['torch']._dynamo, 140374889071936)          # torch._dynamo.graph_break()  # mp/ipykernel_532/3152636365.py:7 in fn\n| | | | +- GuardManager: source=G['torch']._dynamo.graph_break, accessed_by=GetAttrGuardAccessor(graph_break), type=<class 'function'>, tag_safe=(True, False)\n| | | | | +- GuardManager: source=G['torch']._dynamo.graph_break.__code__, accessed_by=CodeGuardAccessor, type=<class 'code'>, tag_safe=(True, False)\n| | | | | | +- ID_MATCH: ___check_obj_id(G['torch']._dynamo.graph_break.__code__, 140374703207360)  # torch._dynamo.graph_break()  # mp/ipykernel_532/3152636365.py:7 in fn\n| | | +- GuardManager: source=G['torch'].no_grad, accessed_by=GetAttrGuardAccessor(no_grad), type=<class 'type'>, tag_safe=(True, False)\n| | | | +- ID_MATCH: ___check_obj_id(G['torch'].no_grad, 93956503623376)           # with torch.no_grad():  # mp/ipykernel_532/3152636365.py:5 in fn\n| | +- GuardManager: source=G['contextlib'], accessed_by=DictGetItemGuardAccessor('contextlib'), type=<class 'module'>, tag_safe=(False, False)\n| | | +- ID_MATCH: ___check_obj_id(G['contextlib'], 140376423420832)             # with contextlib.nullcontext():  # mp/ipykernel_532/3152636365.py:4 in fn\n| | | +- GuardManager: source=G['contextlib'].nullcontext, accessed_by=GetAttrGuardAccessor(nullcontext), type=<class 'abc.ABCMeta'>, tag_safe=(True, False)\n| | | | +- ID_MATCH: ___check_obj_id(G['contextlib'].nullcontext, 93956428443184)  # with contextlib.nullcontext():  # mp/ipykernel_532/3152636365.py:4 in fn\n\nGuard eval latency = 261.20 us\nput_code_state: no cache key, skipping\nrun_gc_after_compile: running gc\nskipping because no torch.* __init__             /opt/conda/envs/py_3.10/lib/python3.10/contextlib.py 732\nskipping because no torch.* __enter__             /opt/conda/envs/py_3.10/lib/python3.10/contextlib.py 735\nskipping: __init__ (reason: in skipfiles, file: /opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/autograd/grad_mode.py)\nskipping: __enter__ (reason: in skipfiles, file: /opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/autograd/grad_mode.py)\nskipping: __exit__ (reason: in skipfiles, file: /opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/autograd/grad_mode.py)\nskipping because no torch.* __exit__             /opt/conda/envs/py_3.10/lib/python3.10/contextlib.py 738\ntorchdynamo start compiling torch_dynamo_resume_in_fn_at_7 /tmp/ipykernel_532/3152636365.py:7, stack (elided 5 frames):\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/runpy.py\", line 196, in _run_module_as_main\n    return _run_code(code, main_globals, None,\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/runpy.py\", line 86, in _run_code\n    exec(code, run_globals)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel_launcher.py\", line 18, in <module>\n    app.launch_new_instance()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/traitlets/config/application.py\", line 1075, in launch_instance\n    app.start()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/kernelapp.py\", line 758, in start\n    self.io_loop.start()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/tornado/platform/asyncio.py\", line 211, in start\n    self.asyncio_loop.run_forever()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/asyncio/base_events.py\", line 603, in run_forever\n    self._run_once()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/asyncio/base_events.py\", line 1909, in _run_once\n    handle._run()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/asyncio/events.py\", line 80, in _run\n    self._context.run(self._callback, *self._args)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/utils.py\", line 71, in preserve_context\n    return await f(*args, **kwargs)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/kernelbase.py\", line 614, in shell_main\n    await self.dispatch_shell(msg, subshell_id=subshell_id)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/kernelbase.py\", line 471, in dispatch_shell\n    await result\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/ipkernel.py\", line 366, in execute_request\n    await super().execute_request(stream, ident, parent)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/kernelbase.py\", line 827, in execute_request\n    reply_content = await reply_content\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/ipkernel.py\", line 458, in do_execute\n    res = shell.run_cell(\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/zmqshell.py\", line 663, in run_cell\n    return super().run_cell(*args, **kwargs)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/interactiveshell.py\", line 3006, in run_cell\n    result = self._run_cell(\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/interactiveshell.py\", line 3061, in _run_cell\n    result = runner(coro)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/async_helpers.py\", line 129, in _pseudo_sync_runner\n    coro.send(None)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/interactiveshell.py\", line 3266, in run_cell_async\n    has_raised = await self.run_ast_nodes(code_ast.body, cell_name,\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/interactiveshell.py\", line 3445, in run_ast_nodes\n    if await self.run_code(code, result, async_=asy):\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/interactiveshell.py\", line 3505, in run_code\n    exec(code_obj, self.user_global_ns, self.user_ns)\n  File \"/tmp/ipykernel_532/3152636365.py\", line 9, in <module>\n    fn(torch.randn(3))\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py\", line 832, in compile_wrapper\n    return fn(*args, **kwargs)\n\nStep 1: torchdynamo start tracing torch_dynamo_resume_in_fn_at_7 /tmp/ipykernel_532/3152636365.py:7\ncreate_env\nTRACE starts_line /tmp/ipykernel_532/3152636365.py:7 in torch_dynamo_resume_in_fn_at_7\n                torch._dynamo.graph_break()\nTRACE LOAD_CONST True []\nTRACE STORE_FAST __is_tracing_resume_prologue [ConstantVariable(bool: True)]\nTRACE LOAD_FAST ___stack0 []\nTRACE CALL_FUNCTION 0 [LazyVariableTracker()]\nTRACE NOP None [NullContextVariable()]\nTRACE SETUP_WITH 96 [NullContextVariable()]\nTRACE POP_TOP None [WithExitFunctionVariable(), ConstantVariable(NoneType: None)]\nTRACE NOP None [WithExitFunctionVariable()]\nTRACE LOAD_FAST ___stack1 [WithExitFunctionVariable()]\nTRACE LOAD_CONST False [WithExitFunctionVariable(), LazyVariableTracker()]\nTRACE CALL_FUNCTION 1 [WithExitFunctionVariable(), LazyVariableTracker(), ConstantVariable(bool: False)]\nTRACE NOP None [WithExitFunctionVariable(), GradModeVariable()]\nTRACE SETUP_WITH 56 [WithExitFunctionVariable(), GradModeVariable()]\nTRACE POP_TOP None [WithExitFunctionVariable(), WithExitFunctionVariable(), ConstantVariable(NoneType: None)]\nTRACE NOP None [WithExitFunctionVariable(), WithExitFunctionVariable()]\nTRACE LOAD_FAST ___stack2 [WithExitFunctionVariable(), WithExitFunctionVariable()]\nTRACE LOAD_CONST False [WithExitFunctionVariable(), WithExitFunctionVariable(), LazyVariableTracker()]\nTRACE STORE_FAST __is_tracing_resume_prologue [WithExitFunctionVariable(), WithExitFunctionVariable(), LazyVariableTracker(), ConstantVariable(bool: False)]\nTRACE JUMP_ABSOLUTE 158 [WithExitFunctionVariable(), WithExitFunctionVariable(), LazyVariableTracker()]\nTRACE POP_TOP None [WithExitFunctionVariable(), WithExitFunctionVariable(), LazyVariableTracker()]\nTRACE starts_line /tmp/ipykernel_532/3152636365.py:8 in torch_dynamo_resume_in_fn_at_7\n                return x + 1\nTRACE LOAD_FAST x [WithExitFunctionVariable(), WithExitFunctionVariable()]\nTRACE LOAD_CONST 1 [WithExitFunctionVariable(), WithExitFunctionVariable(), LazyVariableTracker()]\nTRACE BINARY_ADD None [WithExitFunctionVariable(), WithExitFunctionVariable(), LazyVariableTracker(), ConstantVariable(int: 1)]\nwrap_to_fake L['x'] (3,) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None], constraint_strides=[None], specialize_on=[[]], view_base_context=None, tensor_source=LocalSource(local_name='x', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>\ncreate_graph_input L_x_ L['x'] FakeTensor(..., size=(3,)) at debug_level 0 before=False\nTRACE starts_line /tmp/ipykernel_532/3152636365.py:5 in torch_dynamo_resume_in_fn_at_7\n            with torch.no_grad():\nTRACE POP_BLOCK None [WithExitFunctionVariable(), WithExitFunctionVariable(), TensorVariable()]\nTRACE ROT_TWO None [WithExitFunctionVariable(), WithExitFunctionVariable(), TensorVariable()]\nTRACE LOAD_CONST None [WithExitFunctionVariable(), TensorVariable(), WithExitFunctionVariable()]\nTRACE DUP_TOP None [WithExitFunctionVariable(), TensorVariable(), WithExitFunctionVariable(), ConstantVariable(NoneType: None)]\nTRACE DUP_TOP None [WithExitFunctionVariable(), TensorVariable(), WithExitFunctionVariable(), ConstantVariable(NoneType: None), ConstantVariable(NoneType: None)]\nTRACE CALL_FUNCTION 3 [WithExitFunctionVariable(), TensorVariable(), WithExitFunctionVariable(), ConstantVariable(NoneType: None), ConstantVariable(NoneType: None), ConstantVariable(NoneType: None)]\nTRACE POP_TOP None [WithExitFunctionVariable(), TensorVariable(), ConstantVariable(NoneType: None)]\nTRACE starts_line /tmp/ipykernel_532/3152636365.py:4 in torch_dynamo_resume_in_fn_at_7\n        with contextlib.nullcontext():\nTRACE POP_BLOCK None [WithExitFunctionVariable(), TensorVariable()]\nTRACE ROT_TWO None [WithExitFunctionVariable(), TensorVariable()]\nTRACE LOAD_CONST None [TensorVariable(), WithExitFunctionVariable()]\nTRACE DUP_TOP None [TensorVariable(), WithExitFunctionVariable(), ConstantVariable(NoneType: None)]\nTRACE DUP_TOP None [TensorVariable(), WithExitFunctionVariable(), ConstantVariable(NoneType: None), ConstantVariable(NoneType: None)]\nTRACE CALL_FUNCTION 3 [TensorVariable(), WithExitFunctionVariable(), ConstantVariable(NoneType: None), ConstantVariable(NoneType: None), ConstantVariable(NoneType: None)]\nTRACE POP_TOP None [TensorVariable(), ConstantVariable(NoneType: None)]\nTRACE RETURN_VALUE None [TensorVariable()]\nStep 1: torchdynamo done tracing torch_dynamo_resume_in_fn_at_7 (RETURN_VALUE)\nRETURN_VALUE triggered compile\nCOMPILING GRAPH due to GraphCompileReason(reason='return_value', user_stack=[<FrameSummary file /tmp/ipykernel_532/3152636365.py, line 4 in torch_dynamo_resume_in_fn_at_7>], graph_break=False)\nTRACED GRAPH\n ===== __compiled_fn_31_b2a5c450_5d0e_4895_be05_d0def17b67d7 =====\n /opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/fx/_lazy_graph_module.py class GraphModule(torch.nn.Module):\n    def forward(self, L_x_: \"f32[3][1]cpu\"):\n        l_x_ = L_x_\n        \n        # No stacktrace found for following nodes\n        _set_grad_enabled = torch._C._set_grad_enabled(False);  _set_grad_enabled = None\n        \n         # File: /tmp/ipykernel_532/3152636365.py:8 in torch_dynamo_resume_in_fn_at_7, code: return x + 1\n        add: \"f32[3][1]cpu\" = l_x_ + 1;  l_x_ = None\n        \n        # No stacktrace found for following nodes\n        _set_grad_enabled_1 = torch._C._set_grad_enabled(True);  _set_grad_enabled_1 = None\n        return (add,)\n        \n\nStep 2: calling compiler function eager\nStep 2: done compiler function eager\nproduce_guards\ntrack_symint L['x'].size()[0] 3 None\ntrack_symint L['x'].stride()[0] 1 None\ntrack_symint L['x'].storage_offset() 0 None\nSkipping guard L['x'].size()[0] == 3\nSkipping guard L['x'].stride()[0] == 1\nSkipping guard L['x'].storage_offset() == 0\nGUARDS:\n\nTREE_GUARD_MANAGER:\n+- RootGuardManager\n| +- LAMBDA_GUARD: torch._functorch.aot_autograd.utils.top_saved_tensors_hooks ids == None  # _dynamo/output_graph.py:688 in init_ambient_guards\n| +- DEFAULT_DEVICE: utils_device.CURRENT_DEVICE == None                           # _dynamo/output_graph.py:676 in init_ambient_guards\n| +- GLOBAL_STATE: ___check_global_state()\n| +- TORCH_FUNCTION_MODE_STACK: ___check_torch_function_mode_stack()\n| +- GuardManager: source=L['x'], accessed_by=FrameLocalsGuardAccessor(key='x', framelocals_idx=5), type=<class 'torch.Tensor'>, tag_safe=(True, False)\n| | +- TENSOR_MATCH: check_tensor(L['x'], Tensor, DispatchKeySet(CPU, BackendSelect, ADInplaceOrView, AutogradCPU), torch.float32, device=None, requires_grad=False, size=[3], stride=[1])  # return x + 1  # mp/ipykernel_532/3152636365.py:8 in torch_dynamo_resume_in_fn_at_7\n| | +- NO_HASATTR: hasattr(L['x'], '_dynamo_dynamic_indices') == False           # return x + 1  # mp/ipykernel_532/3152636365.py:8 in torch_dynamo_resume_in_fn_at_7\n| +- GuardManager: source=L['___stack0'], accessed_by=FrameLocalsGuardAccessor(key='___stack0', framelocals_idx=2), type=<class 'abc.ABCMeta'>, tag_safe=(True, False)\n| | +- ID_MATCH: ___check_obj_id(L['___stack0'], 93956428443184)               # torch._dynamo.graph_break()  # mp/ipykernel_532/3152636365.py:7 in torch_dynamo_resume_in_fn_at_7\n| +- GuardManager: source=L['___stack1'], accessed_by=FrameLocalsGuardAccessor(key='___stack1', framelocals_idx=3), type=<class 'type'>, tag_safe=(True, False)\n| | +- ID_MATCH: ___check_obj_id(L['___stack1'], 93956503628432)               # torch._dynamo.graph_break()  # mp/ipykernel_532/3152636365.py:7 in torch_dynamo_resume_in_fn_at_7\n\nGuard eval latency = 79.83 us\nput_code_state: no cache key, skipping\nrun_gc_after_compile: running gc\n\n```\n\n\n```python\ntensor([1.3265, 1.4369, 2.3154])\n\n```\n\n\n## Graph Break in a Try Block#\n\nA graph break in a try block cannot be resumed:\n\n```python\n@torch.compile\ndef fn(x):\n    try:\n        x = x + 1\n        torch._dynamo.graph_break()\n        return x + 1\n    except Exception as e:\n        pass\nfn(torch.randn(3))\n\n```\n\n\n```python\ntorchdynamo start compiling fn /tmp/ipykernel_532/2546874632.py:1, stack (elided 5 frames):\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/runpy.py\", line 196, in _run_module_as_main\n    return _run_code(code, main_globals, None,\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/runpy.py\", line 86, in _run_code\n    exec(code, run_globals)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel_launcher.py\", line 18, in <module>\n    app.launch_new_instance()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/traitlets/config/application.py\", line 1075, in launch_instance\n    app.start()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/kernelapp.py\", line 758, in start\n    self.io_loop.start()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/tornado/platform/asyncio.py\", line 211, in start\n    self.asyncio_loop.run_forever()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/asyncio/base_events.py\", line 603, in run_forever\n    self._run_once()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/asyncio/base_events.py\", line 1909, in _run_once\n    handle._run()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/asyncio/events.py\", line 80, in _run\n    self._context.run(self._callback, *self._args)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/utils.py\", line 71, in preserve_context\n    return await f(*args, **kwargs)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/kernelbase.py\", line 614, in shell_main\n    await self.dispatch_shell(msg, subshell_id=subshell_id)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/kernelbase.py\", line 471, in dispatch_shell\n    await result\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/ipkernel.py\", line 366, in execute_request\n    await super().execute_request(stream, ident, parent)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/kernelbase.py\", line 827, in execute_request\n    reply_content = await reply_content\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/ipkernel.py\", line 458, in do_execute\n    res = shell.run_cell(\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/zmqshell.py\", line 663, in run_cell\n    return super().run_cell(*args, **kwargs)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/interactiveshell.py\", line 3006, in run_cell\n    result = self._run_cell(\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/interactiveshell.py\", line 3061, in _run_cell\n    result = runner(coro)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/async_helpers.py\", line 129, in _pseudo_sync_runner\n    coro.send(None)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/interactiveshell.py\", line 3266, in run_cell_async\n    has_raised = await self.run_ast_nodes(code_ast.body, cell_name,\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/interactiveshell.py\", line 3445, in run_ast_nodes\n    if await self.run_code(code, result, async_=asy):\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/interactiveshell.py\", line 3505, in run_code\n    exec(code_obj, self.user_global_ns, self.user_ns)\n  File \"/tmp/ipykernel_532/2546874632.py\", line 9, in <module>\n    fn(torch.randn(3))\n\nStep 1: torchdynamo start tracing fn /tmp/ipykernel_532/2546874632.py:1\ncreate_env\nTRACE starts_line /tmp/ipykernel_532/2546874632.py:3 in fn\n        try:\nTRACE SETUP_FINALLY 30 []\nTRACE starts_line /tmp/ipykernel_532/2546874632.py:4 in fn\n            x = x + 1\nTRACE LOAD_FAST x []\nTRACE LOAD_CONST 1 [LazyVariableTracker()]\nTRACE BINARY_ADD None [LazyVariableTracker(), ConstantVariable(int: 1)]\nwrap_to_fake L['x'] (3,) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None], constraint_strides=[None], specialize_on=[[]], view_base_context=None, tensor_source=LocalSource(local_name='x', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>\ncreate_graph_input L_x_ L['x'] FakeTensor(..., size=(3,)) at debug_level 0 before=False\nTRACE STORE_FAST x [TensorVariable()]\nTRACE starts_line /tmp/ipykernel_532/2546874632.py:5 in fn\n            torch._dynamo.graph_break()\nTRACE LOAD_GLOBAL torch []\nTRACE LOAD_ATTR _dynamo [LazyVariableTracker()]\nTRACE LOAD_ATTR graph_break [LazyVariableTracker()]\nTRACE CALL_FUNCTION 0 [LazyVariableTracker()]\nempty checkpoint\nrun_gc_after_compile: running gc\nGraph break: skip: from user code at:\n  File \"/tmp/ipykernel_532/2546874632.py\", line 5, in fn\n    torch._dynamo.graph_break()\nTraceback (most recent call last):\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/_dynamo/convert_frame.py\", line 1625, in __call__\n    result = self._inner_convert(\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/_dynamo/convert_frame.py\", line 688, in __call__\n    result = _compile(\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/_dynamo/convert_frame.py\", line 1434, in _compile\n    guarded_code, tracer_output = compile_inner(code, one_graph, hooks)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/_utils_internal.py\", line 92, in wrapper_function\n    return function(*args, **kwargs)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/_dynamo/convert_frame.py\", line 1117, in compile_inner\n    return _compile_inner(code, one_graph, hooks)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/_dynamo/convert_frame.py\", line 1151, in _compile_inner\n    dynamo_output = compile_frame(\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/_dynamo/convert_frame.py\", line 1032, in compile_frame\n    bytecode, tracer_output = transform_code_object(code, transform)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/_dynamo/bytecode_transformation.py\", line 1592, in transform_code_object\n    tracer_output = transformations(instructions, code_options)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/_dynamo/convert_frame.py\", line 1004, in transform\n    tracer_output = trace_frame(\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/_dynamo/convert_frame.py\", line 312, in _fn\n    return fn(*args, **kwargs)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/_dynamo/convert_frame.py\", line 815, in trace_frame\n    run_tracer()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/_dynamo/convert_frame.py\", line 797, in run_tracer\n    tracer.run()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/_dynamo/symbolic_convert.py\", line 1500, in run\n    while self.step():\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/_dynamo/symbolic_convert.py\", line 1348, in step\n    self.dispatch_table[inst.opcode](self, inst)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/_dynamo/symbolic_convert.py\", line 904, in wrapper\n    return inner_fn(self, inst)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/_dynamo/symbolic_convert.py\", line 2333, in CALL_FUNCTION\n    self.call_function(fn, args, {})\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/_dynamo/symbolic_convert.py\", line 1266, in call_function\n    self.push(fn.call_function(self, args, kwargs))  # type: ignore[arg-type]\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/_dynamo/variables/lazy.py\", line 212, in realize_and_forward\n    return getattr(self.realize(), name)(*args, **kwargs)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/_dynamo/variables/functions.py\", line 1515, in call_function\n    unimplemented_v2(\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/_dynamo/exc.py\", line 596, in unimplemented_v2\n    raise Unsupported(msg)\ntorch._dynamo.exc.Unsupported: Call to `torch._dynamo.graph_break()`\n  Explanation: User-inserted graph break. Message: None\n  Hint: Remove the `torch._dynamo.graph_break()` call.\n\n  Developer debug context: Called `torch._dynamo.graph_break()` with args `[]`, kwargs `{}`\n\n For more details about this graph break, please visit: https://meta-pytorch.github.io/compile-graph-break-site/gb/gb0025.html\n\nfrom user code:\n   File \"/tmp/ipykernel_532/2546874632.py\", line 5, in fn\n    torch._dynamo.graph_break()\n\nSet TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS=\"+dynamo\"\n\nWON'T CONVERT fn /tmp/ipykernel_532/2546874632.py line 1 \ndue to: \nTraceback (most recent call last):\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/_dynamo/convert_frame.py\", line 1625, in __call__\n    result = self._inner_convert(\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/_dynamo/convert_frame.py\", line 688, in __call__\n    result = _compile(\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/_dynamo/convert_frame.py\", line 1434, in _compile\n    guarded_code, tracer_output = compile_inner(code, one_graph, hooks)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/_utils_internal.py\", line 92, in wrapper_function\n    return function(*args, **kwargs)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/_dynamo/convert_frame.py\", line 1117, in compile_inner\n    return _compile_inner(code, one_graph, hooks)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/_dynamo/convert_frame.py\", line 1151, in _compile_inner\n    dynamo_output = compile_frame(\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/_dynamo/convert_frame.py\", line 1032, in compile_frame\n    bytecode, tracer_output = transform_code_object(code, transform)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/_dynamo/bytecode_transformation.py\", line 1592, in transform_code_object\n    tracer_output = transformations(instructions, code_options)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/_dynamo/convert_frame.py\", line 1004, in transform\n    tracer_output = trace_frame(\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/_dynamo/convert_frame.py\", line 312, in _fn\n    return fn(*args, **kwargs)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/_dynamo/convert_frame.py\", line 815, in trace_frame\n    run_tracer()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/_dynamo/convert_frame.py\", line 797, in run_tracer\n    tracer.run()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/_dynamo/symbolic_convert.py\", line 1500, in run\n    while self.step():\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/_dynamo/symbolic_convert.py\", line 1348, in step\n    self.dispatch_table[inst.opcode](self, inst)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/_dynamo/symbolic_convert.py\", line 904, in wrapper\n    return inner_fn(self, inst)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/_dynamo/symbolic_convert.py\", line 2333, in CALL_FUNCTION\n    self.call_function(fn, args, {})\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/_dynamo/symbolic_convert.py\", line 1266, in call_function\n    self.push(fn.call_function(self, args, kwargs))  # type: ignore[arg-type]\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/_dynamo/variables/lazy.py\", line 212, in realize_and_forward\n    return getattr(self.realize(), name)(*args, **kwargs)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/_dynamo/variables/functions.py\", line 1515, in call_function\n    unimplemented_v2(\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/_dynamo/exc.py\", line 596, in unimplemented_v2\n    raise Unsupported(msg)\ntorch._dynamo.exc.Unsupported: Call to `torch._dynamo.graph_break()`\n  Explanation: User-inserted graph break. Message: None\n  Hint: Remove the `torch._dynamo.graph_break()` call.\n\n  Developer debug context: Called `torch._dynamo.graph_break()` with args `[]`, kwargs `{}`\n\n For more details about this graph break, please visit: https://meta-pytorch.github.io/compile-graph-break-site/gb/gb0025.html\n\nfrom user code:\n   File \"/tmp/ipykernel_532/2546874632.py\", line 5, in fn\n    torch._dynamo.graph_break()\n\nSet TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS=\"+dynamo\"\n\nTraceback (most recent call last):\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/_dynamo/convert_frame.py\", line 1625, in __call__\n    result = self._inner_convert(\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/_dynamo/convert_frame.py\", line 688, in __call__\n    result = _compile(\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/_dynamo/convert_frame.py\", line 1434, in _compile\n    guarded_code, tracer_output = compile_inner(code, one_graph, hooks)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/_utils_internal.py\", line 92, in wrapper_function\n    return function(*args, **kwargs)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/_dynamo/convert_frame.py\", line 1117, in compile_inner\n    return _compile_inner(code, one_graph, hooks)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/_dynamo/convert_frame.py\", line 1151, in _compile_inner\n    dynamo_output = compile_frame(\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/_dynamo/convert_frame.py\", line 1032, in compile_frame\n    bytecode, tracer_output = transform_code_object(code, transform)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/_dynamo/bytecode_transformation.py\", line 1592, in transform_code_object\n    tracer_output = transformations(instructions, code_options)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/_dynamo/convert_frame.py\", line 1004, in transform\n    tracer_output = trace_frame(\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/_dynamo/convert_frame.py\", line 312, in _fn\n    return fn(*args, **kwargs)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/_dynamo/convert_frame.py\", line 815, in trace_frame\n    run_tracer()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/_dynamo/convert_frame.py\", line 797, in run_tracer\n    tracer.run()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/_dynamo/symbolic_convert.py\", line 1500, in run\n    while self.step():\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/_dynamo/symbolic_convert.py\", line 1348, in step\n    self.dispatch_table[inst.opcode](self, inst)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/_dynamo/symbolic_convert.py\", line 904, in wrapper\n    return inner_fn(self, inst)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/_dynamo/symbolic_convert.py\", line 2333, in CALL_FUNCTION\n    self.call_function(fn, args, {})\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/_dynamo/symbolic_convert.py\", line 1266, in call_function\n    self.push(fn.call_function(self, args, kwargs))  # type: ignore[arg-type]\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/_dynamo/variables/lazy.py\", line 212, in realize_and_forward\n    return getattr(self.realize(), name)(*args, **kwargs)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/_dynamo/variables/functions.py\", line 1515, in call_function\n    unimplemented_v2(\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/_dynamo/exc.py\", line 596, in unimplemented_v2\n    raise Unsupported(msg)\ntorch._dynamo.exc.Unsupported: Call to `torch._dynamo.graph_break()`\n  Explanation: User-inserted graph break. Message: None\n  Hint: Remove the `torch._dynamo.graph_break()` call.\n\n  Developer debug context: Called `torch._dynamo.graph_break()` with args `[]`, kwargs `{}`\n\n For more details about this graph break, please visit: https://meta-pytorch.github.io/compile-graph-break-site/gb/gb0025.html\n\nfrom user code:\n   File \"/tmp/ipykernel_532/2546874632.py\", line 5, in fn\n    torch._dynamo.graph_break()\n\nSet TORCHDYNAMO_VERBOSE=1 for the internal stack trace (please do this especially if you're reporting a bug to PyTorch). For even more developer context, set TORCH_LOGS=\"+dynamo\"\n\n```\n\n\n```python\ntensor([1.4041, 2.4074, 2.5800])\n\n```\n\nWe can avoid skipping by moving the graph break outside of the try block:\n\n```python\n@torch.compile\ndef fn(x):\n    try:\n        x = x + 1\n    except Exception as e:\n        pass\n    torch._dynamo.graph_break()\n    try:\n        return x + 1\n    except Exception as e:\n        pass\nfn(torch.randn(3))\n\n```\n\n\n```python\ntorchdynamo start compiling fn /tmp/ipykernel_532/3015389759.py:1, stack (elided 5 frames):\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/runpy.py\", line 196, in _run_module_as_main\n    return _run_code(code, main_globals, None,\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/runpy.py\", line 86, in _run_code\n    exec(code, run_globals)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel_launcher.py\", line 18, in <module>\n    app.launch_new_instance()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/traitlets/config/application.py\", line 1075, in launch_instance\n    app.start()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/kernelapp.py\", line 758, in start\n    self.io_loop.start()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/tornado/platform/asyncio.py\", line 211, in start\n    self.asyncio_loop.run_forever()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/asyncio/base_events.py\", line 603, in run_forever\n    self._run_once()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/asyncio/base_events.py\", line 1909, in _run_once\n    handle._run()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/asyncio/events.py\", line 80, in _run\n    self._context.run(self._callback, *self._args)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/utils.py\", line 71, in preserve_context\n    return await f(*args, **kwargs)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/kernelbase.py\", line 614, in shell_main\n    await self.dispatch_shell(msg, subshell_id=subshell_id)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/kernelbase.py\", line 471, in dispatch_shell\n    await result\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/ipkernel.py\", line 366, in execute_request\n    await super().execute_request(stream, ident, parent)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/kernelbase.py\", line 827, in execute_request\n    reply_content = await reply_content\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/ipkernel.py\", line 458, in do_execute\n    res = shell.run_cell(\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/zmqshell.py\", line 663, in run_cell\n    return super().run_cell(*args, **kwargs)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/interactiveshell.py\", line 3006, in run_cell\n    result = self._run_cell(\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/interactiveshell.py\", line 3061, in _run_cell\n    result = runner(coro)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/async_helpers.py\", line 129, in _pseudo_sync_runner\n    coro.send(None)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/interactiveshell.py\", line 3266, in run_cell_async\n    has_raised = await self.run_ast_nodes(code_ast.body, cell_name,\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/interactiveshell.py\", line 3445, in run_ast_nodes\n    if await self.run_code(code, result, async_=asy):\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/interactiveshell.py\", line 3505, in run_code\n    exec(code_obj, self.user_global_ns, self.user_ns)\n  File \"/tmp/ipykernel_532/3015389759.py\", line 12, in <module>\n    fn(torch.randn(3))\n\nStep 1: torchdynamo start tracing fn /tmp/ipykernel_532/3015389759.py:1\ncreate_env\nTRACE starts_line /tmp/ipykernel_532/3015389759.py:3 in fn\n        try:\nTRACE SETUP_FINALLY 14 []\nTRACE starts_line /tmp/ipykernel_532/3015389759.py:4 in fn\n            x = x + 1\nTRACE LOAD_FAST x []\nTRACE LOAD_CONST 1 [LazyVariableTracker()]\nTRACE BINARY_ADD None [LazyVariableTracker(), ConstantVariable(int: 1)]\nwrap_to_fake L['x'] (3,) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None], constraint_strides=[None], specialize_on=[[]], view_base_context=None, tensor_source=LocalSource(local_name='x', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>\ncreate_graph_input L_x_ L['x'] FakeTensor(..., size=(3,)) at debug_level 0 before=False\nTRACE STORE_FAST x [TensorVariable()]\nTRACE POP_BLOCK None []\nTRACE JUMP_FORWARD 50 []\nTRACE starts_line /tmp/ipykernel_532/3015389759.py:7 in fn\n        torch._dynamo.graph_break()\nTRACE LOAD_GLOBAL torch []\nTRACE LOAD_ATTR _dynamo [LazyVariableTracker()]\nTRACE LOAD_ATTR graph_break [LazyVariableTracker()]\nTRACE CALL_FUNCTION 0 [LazyVariableTracker()]\nGraph break in user code at /tmp/ipykernel_532/3015389759.py:7\nGraph Break Reason: Call to `torch._dynamo.graph_break()`\n  Explanation: User-inserted graph break. Message: None\n  Hint: Remove the `torch._dynamo.graph_break()` call.\n\n  Developer debug context: Called `torch._dynamo.graph_break()` with args `[]`, kwargs `{}`\n\n For more details about this graph break, please visit: https://meta-pytorch.github.io/compile-graph-break-site/gb/gb0025.html\nUser code traceback:\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/runpy.py\", line 196, in _run_module_as_main\n    return _run_code(code, main_globals, None,\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/runpy.py\", line 86, in _run_code\n    exec(code, run_globals)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel_launcher.py\", line 18, in <module>\n    app.launch_new_instance()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/traitlets/config/application.py\", line 1075, in launch_instance\n    app.start()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/kernelapp.py\", line 758, in start\n    self.io_loop.start()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/tornado/platform/asyncio.py\", line 211, in start\n    self.asyncio_loop.run_forever()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/asyncio/base_events.py\", line 603, in run_forever\n    self._run_once()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/asyncio/base_events.py\", line 1909, in _run_once\n    handle._run()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/asyncio/events.py\", line 80, in _run\n    self._context.run(self._callback, *self._args)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/utils.py\", line 71, in preserve_context\n    return await f(*args, **kwargs)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/kernelbase.py\", line 614, in shell_main\n    await self.dispatch_shell(msg, subshell_id=subshell_id)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/kernelbase.py\", line 471, in dispatch_shell\n    await result\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/ipkernel.py\", line 366, in execute_request\n    await super().execute_request(stream, ident, parent)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/kernelbase.py\", line 827, in execute_request\n    reply_content = await reply_content\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/ipkernel.py\", line 458, in do_execute\n    res = shell.run_cell(\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/zmqshell.py\", line 663, in run_cell\n    return super().run_cell(*args, **kwargs)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/interactiveshell.py\", line 3006, in run_cell\n    result = self._run_cell(\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/interactiveshell.py\", line 3061, in _run_cell\n    result = runner(coro)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/async_helpers.py\", line 129, in _pseudo_sync_runner\n    coro.send(None)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/interactiveshell.py\", line 3266, in run_cell_async\n    has_raised = await self.run_ast_nodes(code_ast.body, cell_name,\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/interactiveshell.py\", line 3445, in run_ast_nodes\n    if await self.run_code(code, result, async_=asy):\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/interactiveshell.py\", line 3505, in run_code\n    exec(code_obj, self.user_global_ns, self.user_ns)\n  File \"/tmp/ipykernel_532/3015389759.py\", line 12, in <module>\n    fn(torch.randn(3))\n  File \"/tmp/ipykernel_532/3015389759.py\", line 7, in fn\n    torch._dynamo.graph_break()\n\nRestarting analysis due to _dynamo/symbolic_convert.py:249 in fail_and_restart_analysis\nStep 1: torchdynamo start tracing fn /tmp/ipykernel_532/3015389759.py:1\ncreate_env\nTRACE starts_line /tmp/ipykernel_532/3015389759.py:3 in fn\n        try:\nTRACE SETUP_FINALLY 14 []\nTRACE starts_line /tmp/ipykernel_532/3015389759.py:4 in fn\n            x = x + 1\nTRACE LOAD_FAST x []\nTRACE LOAD_CONST 1 [LazyVariableTracker()]\nTRACE BINARY_ADD None [LazyVariableTracker(), ConstantVariable(int: 1)]\nwrap_to_fake L['x'] (3,) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None], constraint_strides=[None], specialize_on=[[]], view_base_context=None, tensor_source=LocalSource(local_name='x', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>\ncreate_graph_input L_x_ L['x'] FakeTensor(..., size=(3,)) at debug_level 0 before=False\nTRACE STORE_FAST x [TensorVariable()]\nTRACE POP_BLOCK None []\nTRACE JUMP_FORWARD 50 []\nTRACE starts_line /tmp/ipykernel_532/3015389759.py:7 in fn\n        torch._dynamo.graph_break()\nTRACE LOAD_GLOBAL torch []\nTRACE LOAD_ATTR _dynamo [LazyVariableTracker()]\nTRACE LOAD_ATTR graph_break [LazyVariableTracker()]\nTRACE CALL_FUNCTION 0 [LazyVariableTracker()]\nCOMPILING GRAPH due to GraphCompileReason(reason='Call to `torch._dynamo.graph_break()`\\n  Explanation: User-inserted graph break. Message: None\\n  Hint: Remove the `torch._dynamo.graph_break()` call.\\n\\n  Developer debug context: Called `torch._dynamo.graph_break()` with args `[]`, kwargs `{}`\\n\\n For more details about this graph break, please visit: https://meta-pytorch.github.io/compile-graph-break-site/gb/gb0025.html', user_stack=[<FrameSummary file /tmp/ipykernel_532/3015389759.py, line 7 in fn>], graph_break=True)\nTRACED GRAPH\n ===== __compiled_fn_35_9cf6feae_253b_490a_9640_de9cdf09ab17 =====\n /opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/fx/_lazy_graph_module.py class GraphModule(torch.nn.Module):\n    def forward(self, L_x_: \"f32[3][1]cpu\"):\n        l_x_ = L_x_\n        \n         # File: /tmp/ipykernel_532/3015389759.py:4 in fn, code: x = x + 1\n        x: \"f32[3][1]cpu\" = l_x_ + 1;  l_x_ = None\n        return (x,)\n        \n\nStep 2: calling compiler function eager\nStep 2: done compiler function eager\nproduce_guards\ntrack_symint L['x'].size()[0] 3 None\ntrack_symint L['x'].stride()[0] 1 None\ntrack_symint L['x'].storage_offset() 0 None\nSkipping guard L['x'].size()[0] == 3\nSkipping guard L['x'].stride()[0] == 1\nSkipping guard L['x'].storage_offset() == 0\nGUARDS:\n\nTREE_GUARD_MANAGER:\n+- RootGuardManager\n| +- LAMBDA_GUARD: torch._functorch.aot_autograd.utils.top_saved_tensors_hooks ids == None  # _dynamo/output_graph.py:688 in init_ambient_guards\n| +- DEFAULT_DEVICE: utils_device.CURRENT_DEVICE == None                           # _dynamo/output_graph.py:676 in init_ambient_guards\n| +- GLOBAL_STATE: ___check_global_state()\n| +- TORCH_FUNCTION_MODE_STACK: ___check_torch_function_mode_stack()\n| +- GuardManager: source=L['x'], accessed_by=FrameLocalsGuardAccessor(key='x', framelocals_idx=0), type=<class 'torch.Tensor'>, tag_safe=(True, False)\n| | +- TENSOR_MATCH: check_tensor(L['x'], Tensor, DispatchKeySet(CPU, BackendSelect, ADInplaceOrView, AutogradCPU), torch.float32, device=None, requires_grad=False, size=[3], stride=[1])  # x = x + 1  # mp/ipykernel_532/3015389759.py:4 in fn\n| | +- NO_HASATTR: hasattr(L['x'], '_dynamo_dynamic_indices') == False           # x = x + 1  # mp/ipykernel_532/3015389759.py:4 in fn\n| +- GuardManager: source=G, accessed_by=GlobalsGuardAccessor, type=<class 'dict'>, tag_safe=(False, False)\n| | +- GuardManager: source=G['torch'], accessed_by=DictGetItemGuardAccessor('torch'), type=<class 'module'>, tag_safe=(False, False)\n| | | +- ID_MATCH: ___check_obj_id(G['torch'], 140376310990704)                  # torch._dynamo.graph_break()  # mp/ipykernel_532/3015389759.py:7 in fn\n| | | +- GuardManager: source=G['torch']._dynamo, accessed_by=GetAttrGuardAccessor(_dynamo), type=<class 'module'>, tag_safe=(False, False)\n| | | | +- ID_MATCH: ___check_obj_id(G['torch']._dynamo, 140374889071936)          # torch._dynamo.graph_break()  # mp/ipykernel_532/3015389759.py:7 in fn\n| | | | +- GuardManager: source=G['torch']._dynamo.graph_break, accessed_by=GetAttrGuardAccessor(graph_break), type=<class 'function'>, tag_safe=(True, False)\n| | | | | +- GuardManager: source=G['torch']._dynamo.graph_break.__code__, accessed_by=CodeGuardAccessor, type=<class 'code'>, tag_safe=(True, False)\n| | | | | | +- ID_MATCH: ___check_obj_id(G['torch']._dynamo.graph_break.__code__, 140374703207360)  # torch._dynamo.graph_break()  # mp/ipykernel_532/3015389759.py:7 in fn\n\nGuard eval latency = 78.68 us\nput_code_state: no cache key, skipping\nrun_gc_after_compile: running gc\ntorchdynamo start compiling torch_dynamo_resume_in_fn_at_7 /tmp/ipykernel_532/3015389759.py:7, stack (elided 5 frames):\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/runpy.py\", line 196, in _run_module_as_main\n    return _run_code(code, main_globals, None,\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/runpy.py\", line 86, in _run_code\n    exec(code, run_globals)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel_launcher.py\", line 18, in <module>\n    app.launch_new_instance()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/traitlets/config/application.py\", line 1075, in launch_instance\n    app.start()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/kernelapp.py\", line 758, in start\n    self.io_loop.start()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/tornado/platform/asyncio.py\", line 211, in start\n    self.asyncio_loop.run_forever()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/asyncio/base_events.py\", line 603, in run_forever\n    self._run_once()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/asyncio/base_events.py\", line 1909, in _run_once\n    handle._run()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/asyncio/events.py\", line 80, in _run\n    self._context.run(self._callback, *self._args)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/utils.py\", line 71, in preserve_context\n    return await f(*args, **kwargs)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/kernelbase.py\", line 614, in shell_main\n    await self.dispatch_shell(msg, subshell_id=subshell_id)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/kernelbase.py\", line 471, in dispatch_shell\n    await result\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/ipkernel.py\", line 366, in execute_request\n    await super().execute_request(stream, ident, parent)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/kernelbase.py\", line 827, in execute_request\n    reply_content = await reply_content\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/ipkernel.py\", line 458, in do_execute\n    res = shell.run_cell(\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/zmqshell.py\", line 663, in run_cell\n    return super().run_cell(*args, **kwargs)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/interactiveshell.py\", line 3006, in run_cell\n    result = self._run_cell(\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/interactiveshell.py\", line 3061, in _run_cell\n    result = runner(coro)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/async_helpers.py\", line 129, in _pseudo_sync_runner\n    coro.send(None)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/interactiveshell.py\", line 3266, in run_cell_async\n    has_raised = await self.run_ast_nodes(code_ast.body, cell_name,\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/interactiveshell.py\", line 3445, in run_ast_nodes\n    if await self.run_code(code, result, async_=asy):\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/interactiveshell.py\", line 3505, in run_code\n    exec(code_obj, self.user_global_ns, self.user_ns)\n  File \"/tmp/ipykernel_532/3015389759.py\", line 12, in <module>\n    fn(torch.randn(3))\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py\", line 832, in compile_wrapper\n    return fn(*args, **kwargs)\n\nStep 1: torchdynamo start tracing torch_dynamo_resume_in_fn_at_7 /tmp/ipykernel_532/3015389759.py:7\ncreate_env\nTRACE starts_line /tmp/ipykernel_532/3015389759.py:7 in torch_dynamo_resume_in_fn_at_7\n        torch._dynamo.graph_break()\nTRACE LOAD_CONST True []\nTRACE STORE_FAST __is_tracing_resume_prologue [ConstantVariable(bool: True)]\nTRACE LOAD_FAST ___stack0 []\nTRACE LOAD_CONST False [LazyVariableTracker()]\nTRACE STORE_FAST __is_tracing_resume_prologue [LazyVariableTracker(), ConstantVariable(bool: False)]\nTRACE JUMP_ABSOLUTE 70 [LazyVariableTracker()]\nTRACE POP_TOP None [LazyVariableTracker()]\nTRACE starts_line /tmp/ipykernel_532/3015389759.py:8 in torch_dynamo_resume_in_fn_at_7\n        try:\nTRACE SETUP_FINALLY 84 []\nTRACE starts_line /tmp/ipykernel_532/3015389759.py:9 in torch_dynamo_resume_in_fn_at_7\n            return x + 1\nTRACE LOAD_FAST x []\nTRACE LOAD_CONST 1 [LazyVariableTracker()]\nTRACE BINARY_ADD None [LazyVariableTracker(), ConstantVariable(int: 1)]\nwrap_to_fake L['x'] (3,) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None], constraint_strides=[None], specialize_on=[[]], view_base_context=None, tensor_source=LocalSource(local_name='x', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>\ncreate_graph_input L_x_ L['x'] FakeTensor(..., size=(3,)) at debug_level 0 before=False\nTRACE POP_BLOCK None [TensorVariable()]\nTRACE RETURN_VALUE None [TensorVariable()]\nStep 1: torchdynamo done tracing torch_dynamo_resume_in_fn_at_7 (RETURN_VALUE)\nRETURN_VALUE triggered compile\nCOMPILING GRAPH due to GraphCompileReason(reason='return_value', user_stack=[<FrameSummary file /tmp/ipykernel_532/3015389759.py, line 9 in torch_dynamo_resume_in_fn_at_7>], graph_break=False)\nTRACED GRAPH\n ===== __compiled_fn_38_5cdd28f0_bd4c_41fe_864e_fe626167383a =====\n /opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/fx/_lazy_graph_module.py class GraphModule(torch.nn.Module):\n    def forward(self, L_x_: \"f32[3][1]cpu\"):\n        l_x_ = L_x_\n        \n         # File: /tmp/ipykernel_532/3015389759.py:9 in torch_dynamo_resume_in_fn_at_7, code: return x + 1\n        add: \"f32[3][1]cpu\" = l_x_ + 1;  l_x_ = None\n        return (add,)\n        \n\nStep 2: calling compiler function eager\nStep 2: done compiler function eager\nproduce_guards\ntrack_symint L['x'].size()[0] 3 None\ntrack_symint L['x'].stride()[0] 1 None\ntrack_symint L['x'].storage_offset() 0 None\nSkipping guard L['x'].size()[0] == 3\nSkipping guard L['x'].stride()[0] == 1\nSkipping guard L['x'].storage_offset() == 0\nGUARDS:\n\nTREE_GUARD_MANAGER:\n+- RootGuardManager\n| +- LAMBDA_GUARD: torch._functorch.aot_autograd.utils.top_saved_tensors_hooks ids == None  # _dynamo/output_graph.py:688 in init_ambient_guards\n| +- DEFAULT_DEVICE: utils_device.CURRENT_DEVICE == None                           # _dynamo/output_graph.py:676 in init_ambient_guards\n| +- GLOBAL_STATE: ___check_global_state()\n| +- TORCH_FUNCTION_MODE_STACK: ___check_torch_function_mode_stack()\n| +- GuardManager: source=L['x'], accessed_by=FrameLocalsGuardAccessor(key='x', framelocals_idx=3), type=<class 'torch.Tensor'>, tag_safe=(True, False)\n| | +- TENSOR_MATCH: check_tensor(L['x'], Tensor, DispatchKeySet(CPU, BackendSelect, ADInplaceOrView, AutogradCPU), torch.float32, device=None, requires_grad=False, size=[3], stride=[1])  # return x + 1  # mp/ipykernel_532/3015389759.py:9 in torch_dynamo_resume_in_fn_at_7\n| | +- NO_HASATTR: hasattr(L['x'], '_dynamo_dynamic_indices') == False           # return x + 1  # mp/ipykernel_532/3015389759.py:9 in torch_dynamo_resume_in_fn_at_7\n\nGuard eval latency = 61.02 us\nput_code_state: no cache key, skipping\nrun_gc_after_compile: running gc\n\n```\n\n\n```python\ntensor([1.5745, 2.3647, 1.8617])\n\n```\n\n\n## Hitting a Recompilation Limit#\n\nSeeChanging the Cache Size Limit.\n\n## Compiler Errors#\n\nSome compiler errors will result in skipped functions.\nOther compiler errors will result in a hard error rather than a skipped function.\n\n## Dealing with Skipped Functions#\n\nIn general, you can resolve a skipped function by fixing the underlying graph break or error that\nis causing the function to be skipped.\nIf the graph break/error causing the skipped function is difficult to fix,\nthen consider isolating the graph break/error in its own function so that minimal things are skipped.\n\n```python\ndef inner1(x):\n    return x + 1\ndef inner2(x):\n    return x + 2\n@torch.compile\ndef fn(x):\n    x = inner1(x)\n    def problematic_code():\n        torch._dynamo.skip_frame()\n    problematic_code()\n    x = inner2(x)\nfn(torch.randn(3))\n\n```\n\n\n```python\ntorchdynamo start compiling fn /tmp/ipykernel_532/273153676.py:5, stack (elided 5 frames):\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/runpy.py\", line 196, in _run_module_as_main\n    return _run_code(code, main_globals, None,\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/runpy.py\", line 86, in _run_code\n    exec(code, run_globals)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel_launcher.py\", line 18, in <module>\n    app.launch_new_instance()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/traitlets/config/application.py\", line 1075, in launch_instance\n    app.start()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/kernelapp.py\", line 758, in start\n    self.io_loop.start()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/tornado/platform/asyncio.py\", line 211, in start\n    self.asyncio_loop.run_forever()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/asyncio/base_events.py\", line 603, in run_forever\n    self._run_once()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/asyncio/base_events.py\", line 1909, in _run_once\n    handle._run()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/asyncio/events.py\", line 80, in _run\n    self._context.run(self._callback, *self._args)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/utils.py\", line 71, in preserve_context\n    return await f(*args, **kwargs)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/kernelbase.py\", line 614, in shell_main\n    await self.dispatch_shell(msg, subshell_id=subshell_id)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/kernelbase.py\", line 471, in dispatch_shell\n    await result\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/ipkernel.py\", line 366, in execute_request\n    await super().execute_request(stream, ident, parent)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/kernelbase.py\", line 827, in execute_request\n    reply_content = await reply_content\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/ipkernel.py\", line 458, in do_execute\n    res = shell.run_cell(\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/zmqshell.py\", line 663, in run_cell\n    return super().run_cell(*args, **kwargs)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/interactiveshell.py\", line 3006, in run_cell\n    result = self._run_cell(\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/interactiveshell.py\", line 3061, in _run_cell\n    result = runner(coro)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/async_helpers.py\", line 129, in _pseudo_sync_runner\n    coro.send(None)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/interactiveshell.py\", line 3266, in run_cell_async\n    has_raised = await self.run_ast_nodes(code_ast.body, cell_name,\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/interactiveshell.py\", line 3445, in run_ast_nodes\n    if await self.run_code(code, result, async_=asy):\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/interactiveshell.py\", line 3505, in run_code\n    exec(code_obj, self.user_global_ns, self.user_ns)\n  File \"/tmp/ipykernel_532/273153676.py\", line 12, in <module>\n    fn(torch.randn(3))\n\nStep 1: torchdynamo start tracing fn /tmp/ipykernel_532/273153676.py:5\ncreate_env\nTRACE starts_line /tmp/ipykernel_532/273153676.py:7 in fn\n        x = inner1(x)\nTRACE LOAD_GLOBAL inner1 []\nTRACE LOAD_FAST x [LazyVariableTracker()]\nTRACE CALL_FUNCTION 1 [LazyVariableTracker(), LazyVariableTracker()]\nINLINING <code object inner1 at 0x7fabee5514d0, file \"/tmp/ipykernel_532/273153676.py\", line 1>, inlined according trace_rules.lookup inlined by default\nwrap_to_fake L['x'] (3,) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None], constraint_strides=[None], specialize_on=[[]], view_base_context=None, tensor_source=LocalSource(local_name='x', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>\ncreate_graph_input L_x_ L['x'] FakeTensor(..., size=(3,)) at debug_level 0 before=False\nTRACE starts_line /tmp/ipykernel_532/273153676.py:2 in inner1 (inline depth: 1)\n        return x + 1\nTRACE LOAD_FAST x []\nTRACE LOAD_CONST 1 [TensorVariable()]\nTRACE BINARY_ADD None [TensorVariable(), ConstantVariable(int: 1)]\nTRACE RETURN_VALUE None [TensorVariable()]\nDONE INLINING <code object inner1 at 0x7fabee5514d0, file \"/tmp/ipykernel_532/273153676.py\", line 1>\nTRACE STORE_FAST x [TensorVariable()]\nTRACE starts_line /tmp/ipykernel_532/273153676.py:8 in fn\n        def problematic_code():\nTRACE LOAD_CONST <code object problematic_code at 0x7fab85cc7e10, file \"/tmp/ipykernel_532/273153676.py\", line 8> []\nTRACE LOAD_CONST fn.<locals>.problematic_code [ConstantVariable(code: <code object problematic_code at 0x7fab85cc7e10, file \"/tmp/ipykernel_532/273153676.py\", line 8>)]\nTRACE MAKE_FUNCTION 0 [ConstantVariable(code: <code object problematic_code at 0x7fab85cc7e10, file \"/tmp/ipykernel_532/273153676.py\", line 8>), ConstantVariable(str: 'fn.<locals>.problematic_code')]\nTRACE STORE_FAST problematic_code [NestedUserFunctionVariable()]\nTRACE starts_line /tmp/ipykernel_532/273153676.py:10 in fn\n        problematic_code()\nTRACE LOAD_FAST problematic_code []\nTRACE CALL_FUNCTION 0 [NestedUserFunctionVariable()]\nINLINING <code object problematic_code at 0x7fab85cc7e10, file \"/tmp/ipykernel_532/273153676.py\", line 8>, inlined according trace_rules.lookup inlined by default\nTRACE starts_line /tmp/ipykernel_532/273153676.py:9 in problematic_code (inline depth: 1)\n            torch._dynamo.skip_frame()\nTRACE LOAD_GLOBAL torch []\nTRACE LOAD_ATTR _dynamo [LazyVariableTracker()]\nTRACE LOAD_ATTR skip_frame [LazyVariableTracker()]\nTRACE CALL_FUNCTION 0 [LazyVariableTracker()]\nSKIPPED INLINING <code object problematic_code at 0x7fab85cc7e10, file \"/tmp/ipykernel_532/273153676.py\", line 8>: Skip frame due to `torch._dynamo.skip_frame()`. Message: None\nGraph break in user code at /tmp/ipykernel_532/273153676.py:10\nGraph Break Reason: SKIPPED INLINING <code object problematic_code at 0x7fab85cc7e10, file \"/tmp/ipykernel_532/273153676.py\", line 8>: Skip frame due to `torch._dynamo.skip_frame()`. Message: None\nUser code traceback:\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/runpy.py\", line 196, in _run_module_as_main\n    return _run_code(code, main_globals, None,\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/runpy.py\", line 86, in _run_code\n    exec(code, run_globals)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel_launcher.py\", line 18, in <module>\n    app.launch_new_instance()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/traitlets/config/application.py\", line 1075, in launch_instance\n    app.start()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/kernelapp.py\", line 758, in start\n    self.io_loop.start()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/tornado/platform/asyncio.py\", line 211, in start\n    self.asyncio_loop.run_forever()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/asyncio/base_events.py\", line 603, in run_forever\n    self._run_once()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/asyncio/base_events.py\", line 1909, in _run_once\n    handle._run()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/asyncio/events.py\", line 80, in _run\n    self._context.run(self._callback, *self._args)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/utils.py\", line 71, in preserve_context\n    return await f(*args, **kwargs)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/kernelbase.py\", line 614, in shell_main\n    await self.dispatch_shell(msg, subshell_id=subshell_id)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/kernelbase.py\", line 471, in dispatch_shell\n    await result\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/ipkernel.py\", line 366, in execute_request\n    await super().execute_request(stream, ident, parent)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/kernelbase.py\", line 827, in execute_request\n    reply_content = await reply_content\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/ipkernel.py\", line 458, in do_execute\n    res = shell.run_cell(\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/zmqshell.py\", line 663, in run_cell\n    return super().run_cell(*args, **kwargs)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/interactiveshell.py\", line 3006, in run_cell\n    result = self._run_cell(\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/interactiveshell.py\", line 3061, in _run_cell\n    result = runner(coro)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/async_helpers.py\", line 129, in _pseudo_sync_runner\n    coro.send(None)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/interactiveshell.py\", line 3266, in run_cell_async\n    has_raised = await self.run_ast_nodes(code_ast.body, cell_name,\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/interactiveshell.py\", line 3445, in run_ast_nodes\n    if await self.run_code(code, result, async_=asy):\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/interactiveshell.py\", line 3505, in run_code\n    exec(code_obj, self.user_global_ns, self.user_ns)\n  File \"/tmp/ipykernel_532/273153676.py\", line 12, in <module>\n    fn(torch.randn(3))\n  File \"/tmp/ipykernel_532/273153676.py\", line 10, in fn\n    problematic_code()\n\nRestarting analysis due to _dynamo/symbolic_convert.py:249 in fail_and_restart_analysis\nStep 1: torchdynamo start tracing fn /tmp/ipykernel_532/273153676.py:5\ncreate_env\nTRACE starts_line /tmp/ipykernel_532/273153676.py:7 in fn\n        x = inner1(x)\nTRACE LOAD_GLOBAL inner1 []\nTRACE LOAD_FAST x [LazyVariableTracker()]\nTRACE CALL_FUNCTION 1 [LazyVariableTracker(), LazyVariableTracker()]\nINLINING <code object inner1 at 0x7fabee5514d0, file \"/tmp/ipykernel_532/273153676.py\", line 1>, inlined according trace_rules.lookup inlined by default\nwrap_to_fake L['x'] (3,) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None], constraint_strides=[None], specialize_on=[[]], view_base_context=None, tensor_source=LocalSource(local_name='x', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>\ncreate_graph_input L_x_ L['x'] FakeTensor(..., size=(3,)) at debug_level 0 before=False\nTRACE starts_line /tmp/ipykernel_532/273153676.py:2 in inner1 (inline depth: 1)\n        return x + 1\nTRACE LOAD_FAST x []\nTRACE LOAD_CONST 1 [TensorVariable()]\nTRACE BINARY_ADD None [TensorVariable(), ConstantVariable(int: 1)]\nTRACE RETURN_VALUE None [TensorVariable()]\nDONE INLINING <code object inner1 at 0x7fabee5514d0, file \"/tmp/ipykernel_532/273153676.py\", line 1>\nTRACE STORE_FAST x [TensorVariable()]\nTRACE starts_line /tmp/ipykernel_532/273153676.py:8 in fn\n        def problematic_code():\nTRACE LOAD_CONST <code object problematic_code at 0x7fab85cc7e10, file \"/tmp/ipykernel_532/273153676.py\", line 8> []\nTRACE LOAD_CONST fn.<locals>.problematic_code [ConstantVariable(code: <code object problematic_code at 0x7fab85cc7e10, file \"/tmp/ipykernel_532/273153676.py\", line 8>)]\nTRACE MAKE_FUNCTION 0 [ConstantVariable(code: <code object problematic_code at 0x7fab85cc7e10, file \"/tmp/ipykernel_532/273153676.py\", line 8>), ConstantVariable(str: 'fn.<locals>.problematic_code')]\nTRACE STORE_FAST problematic_code [NestedUserFunctionVariable()]\nTRACE starts_line /tmp/ipykernel_532/273153676.py:10 in fn\n        problematic_code()\nTRACE LOAD_FAST problematic_code []\nTRACE CALL_FUNCTION 0 [NestedUserFunctionVariable()]\nCOMPILING GRAPH due to GraphCompileReason(reason='SKIPPED INLINING <code object problematic_code at 0x7fab85cc7e10, file \"/tmp/ipykernel_532/273153676.py\", line 8>: Skip frame due to `torch._dynamo.skip_frame()`. Message: None', user_stack=[<FrameSummary file /tmp/ipykernel_532/273153676.py, line 10 in fn>], graph_break=True)\nTRACED GRAPH\n ===== __compiled_fn_41_48d91d4a_4ea8_4f47_a3d3_109b14872333 =====\n /opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/fx/_lazy_graph_module.py class GraphModule(torch.nn.Module):\n    def forward(self, L_x_: \"f32[3][1]cpu\"):\n        l_x_ = L_x_\n        \n         # File: /tmp/ipykernel_532/273153676.py:2 in inner1, code: return x + 1\n        x: \"f32[3][1]cpu\" = l_x_ + 1;  l_x_ = None\n        return (x,)\n        \n\nStep 2: calling compiler function eager\nStep 2: done compiler function eager\nproduce_guards\ntrack_symint L['x'].size()[0] 3 None\ntrack_symint L['x'].stride()[0] 1 None\ntrack_symint L['x'].storage_offset() 0 None\nSkipping guard L['x'].size()[0] == 3\nSkipping guard L['x'].stride()[0] == 1\nSkipping guard L['x'].storage_offset() == 0\nGUARDS:\n\nTREE_GUARD_MANAGER:\n+- RootGuardManager\n| +- LAMBDA_GUARD: torch._functorch.aot_autograd.utils.top_saved_tensors_hooks ids == None  # _dynamo/output_graph.py:688 in init_ambient_guards\n| +- DEFAULT_DEVICE: utils_device.CURRENT_DEVICE == None                           # _dynamo/output_graph.py:676 in init_ambient_guards\n| +- GLOBAL_STATE: ___check_global_state()\n| +- TORCH_FUNCTION_MODE_STACK: ___check_torch_function_mode_stack()\n| +- GuardManager: source=L['x'], accessed_by=FrameLocalsGuardAccessor(key='x', framelocals_idx=0), type=<class 'torch.Tensor'>, tag_safe=(True, False)\n| | +- TENSOR_MATCH: check_tensor(L['x'], Tensor, DispatchKeySet(CPU, BackendSelect, ADInplaceOrView, AutogradCPU), torch.float32, device=None, requires_grad=False, size=[3], stride=[1])  # x = inner1(x)  # mp/ipykernel_532/273153676.py:7 in fn\n| | +- NO_HASATTR: hasattr(L['x'], '_dynamo_dynamic_indices') == False           # x = inner1(x)  # mp/ipykernel_532/273153676.py:7 in fn\n| +- GuardManager: source=G, accessed_by=GlobalsGuardAccessor, type=<class 'dict'>, tag_safe=(True, False)\n| | +- GuardManager: source=G['inner1'], accessed_by=DictGetItemGuardAccessor('inner1'), type=<class 'function'>, tag_safe=(True, False)\n| | | +- GuardManager: source=G['inner1'].__code__, accessed_by=CodeGuardAccessor, type=<class 'code'>, tag_safe=(True, False)\n| | | | +- ID_MATCH: ___check_obj_id(G['inner1'].__code__, 140376414688464)        # x = inner1(x)  # mp/ipykernel_532/273153676.py:7 in fn\n\nGuard eval latency = 1067.03 us\nput_code_state: no cache key, skipping\nrun_gc_after_compile: running gc\ntorchdynamo start compiling problematic_code /tmp/ipykernel_532/273153676.py:8, stack (elided 5 frames):\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/runpy.py\", line 196, in _run_module_as_main\n    return _run_code(code, main_globals, None,\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/runpy.py\", line 86, in _run_code\n    exec(code, run_globals)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel_launcher.py\", line 18, in <module>\n    app.launch_new_instance()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/traitlets/config/application.py\", line 1075, in launch_instance\n    app.start()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/kernelapp.py\", line 758, in start\n    self.io_loop.start()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/tornado/platform/asyncio.py\", line 211, in start\n    self.asyncio_loop.run_forever()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/asyncio/base_events.py\", line 603, in run_forever\n    self._run_once()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/asyncio/base_events.py\", line 1909, in _run_once\n    handle._run()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/asyncio/events.py\", line 80, in _run\n    self._context.run(self._callback, *self._args)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/utils.py\", line 71, in preserve_context\n    return await f(*args, **kwargs)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/kernelbase.py\", line 614, in shell_main\n    await self.dispatch_shell(msg, subshell_id=subshell_id)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/kernelbase.py\", line 471, in dispatch_shell\n    await result\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/ipkernel.py\", line 366, in execute_request\n    await super().execute_request(stream, ident, parent)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/kernelbase.py\", line 827, in execute_request\n    reply_content = await reply_content\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/ipkernel.py\", line 458, in do_execute\n    res = shell.run_cell(\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/zmqshell.py\", line 663, in run_cell\n    return super().run_cell(*args, **kwargs)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/interactiveshell.py\", line 3006, in run_cell\n    result = self._run_cell(\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/interactiveshell.py\", line 3061, in _run_cell\n    result = runner(coro)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/async_helpers.py\", line 129, in _pseudo_sync_runner\n    coro.send(None)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/interactiveshell.py\", line 3266, in run_cell_async\n    has_raised = await self.run_ast_nodes(code_ast.body, cell_name,\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/interactiveshell.py\", line 3445, in run_ast_nodes\n    if await self.run_code(code, result, async_=asy):\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/interactiveshell.py\", line 3505, in run_code\n    exec(code_obj, self.user_global_ns, self.user_ns)\n  File \"/tmp/ipykernel_532/273153676.py\", line 12, in <module>\n    fn(torch.randn(3))\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py\", line 832, in compile_wrapper\n    return fn(*args, **kwargs)\n\nStep 1: torchdynamo start tracing problematic_code /tmp/ipykernel_532/273153676.py:8\ncreate_env\nTRACE starts_line /tmp/ipykernel_532/273153676.py:9 in problematic_code\n            torch._dynamo.skip_frame()\nTRACE LOAD_GLOBAL torch []\nTRACE LOAD_ATTR _dynamo [LazyVariableTracker()]\nTRACE LOAD_ATTR skip_frame [LazyVariableTracker()]\nTRACE CALL_FUNCTION 0 [LazyVariableTracker()]\nSkipping frame Skip frame due to `torch._dynamo.skip_frame()`. Message: None problematic_code                 /tmp/ipykernel_532/273153676.py 8\nput_code_state: no cache key, skipping\nrun_gc_after_compile: running gc\ntorchdynamo start compiling torch_dynamo_resume_in_fn_at_10 /tmp/ipykernel_532/273153676.py:10, stack (elided 5 frames):\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/runpy.py\", line 196, in _run_module_as_main\n    return _run_code(code, main_globals, None,\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/runpy.py\", line 86, in _run_code\n    exec(code, run_globals)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel_launcher.py\", line 18, in <module>\n    app.launch_new_instance()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/traitlets/config/application.py\", line 1075, in launch_instance\n    app.start()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/kernelapp.py\", line 758, in start\n    self.io_loop.start()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/tornado/platform/asyncio.py\", line 211, in start\n    self.asyncio_loop.run_forever()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/asyncio/base_events.py\", line 603, in run_forever\n    self._run_once()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/asyncio/base_events.py\", line 1909, in _run_once\n    handle._run()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/asyncio/events.py\", line 80, in _run\n    self._context.run(self._callback, *self._args)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/utils.py\", line 71, in preserve_context\n    return await f(*args, **kwargs)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/kernelbase.py\", line 614, in shell_main\n    await self.dispatch_shell(msg, subshell_id=subshell_id)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/kernelbase.py\", line 471, in dispatch_shell\n    await result\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/ipkernel.py\", line 366, in execute_request\n    await super().execute_request(stream, ident, parent)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/kernelbase.py\", line 827, in execute_request\n    reply_content = await reply_content\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/ipkernel.py\", line 458, in do_execute\n    res = shell.run_cell(\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/zmqshell.py\", line 663, in run_cell\n    return super().run_cell(*args, **kwargs)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/interactiveshell.py\", line 3006, in run_cell\n    result = self._run_cell(\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/interactiveshell.py\", line 3061, in _run_cell\n    result = runner(coro)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/async_helpers.py\", line 129, in _pseudo_sync_runner\n    coro.send(None)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/interactiveshell.py\", line 3266, in run_cell_async\n    has_raised = await self.run_ast_nodes(code_ast.body, cell_name,\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/interactiveshell.py\", line 3445, in run_ast_nodes\n    if await self.run_code(code, result, async_=asy):\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/interactiveshell.py\", line 3505, in run_code\n    exec(code_obj, self.user_global_ns, self.user_ns)\n  File \"/tmp/ipykernel_532/273153676.py\", line 12, in <module>\n    fn(torch.randn(3))\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py\", line 832, in compile_wrapper\n    return fn(*args, **kwargs)\n\nStep 1: torchdynamo start tracing torch_dynamo_resume_in_fn_at_10 /tmp/ipykernel_532/273153676.py:10\ncreate_env\nTRACE starts_line /tmp/ipykernel_532/273153676.py:10 in torch_dynamo_resume_in_fn_at_10\n        problematic_code()\nTRACE LOAD_CONST True []\nTRACE STORE_FAST __is_tracing_resume_prologue [ConstantVariable(bool: True)]\nTRACE LOAD_FAST ___stack0 []\nTRACE LOAD_CONST False [LazyVariableTracker()]\nTRACE STORE_FAST __is_tracing_resume_prologue [LazyVariableTracker(), ConstantVariable(bool: False)]\nTRACE JUMP_ABSOLUTE 32 [LazyVariableTracker()]\nTRACE POP_TOP None [LazyVariableTracker()]\nTRACE starts_line /tmp/ipykernel_532/273153676.py:11 in torch_dynamo_resume_in_fn_at_10\n        x = inner2(x)\nTRACE LOAD_GLOBAL inner2 []\nTRACE LOAD_FAST x [LazyVariableTracker()]\nTRACE CALL_FUNCTION 1 [LazyVariableTracker(), LazyVariableTracker()]\nINLINING <code object inner2 at 0x7fab86277b50, file \"/tmp/ipykernel_532/273153676.py\", line 3>, inlined according trace_rules.lookup inlined by default\nwrap_to_fake L['x'] (3,) StatefulSymbolicContext(dynamic_sizes=[<DimDynamic.STATIC: 2>], dynamic_strides=[<DimDynamic.INFER_STRIDE: 4>], constraint_sizes=[None], constraint_strides=[None], specialize_on=[[]], view_base_context=None, tensor_source=LocalSource(local_name='x', is_input=True, dynamism=None, is_derefed_cell_contents=False), shape_env_to_source_to_symbol_cache={}) <class 'torch.Tensor'>\ncreate_graph_input L_x_ L['x'] FakeTensor(..., size=(3,)) at debug_level 0 before=False\nTRACE starts_line /tmp/ipykernel_532/273153676.py:4 in inner2 (inline depth: 1)\n        return x + 2\nTRACE LOAD_FAST x []\nTRACE LOAD_CONST 2 [TensorVariable()]\nTRACE BINARY_ADD None [TensorVariable(), ConstantVariable(int: 2)]\nTRACE RETURN_VALUE None [TensorVariable()]\nDONE INLINING <code object inner2 at 0x7fab86277b50, file \"/tmp/ipykernel_532/273153676.py\", line 3>\nTRACE STORE_FAST x [TensorVariable()]\nTRACE LOAD_CONST None []\nTRACE RETURN_VALUE None [ConstantVariable(NoneType: None)]\nStep 1: torchdynamo done tracing torch_dynamo_resume_in_fn_at_10 (RETURN_VALUE)\nRETURN_VALUE triggered compile\nCOMPILING GRAPH due to GraphCompileReason(reason='return_value', user_stack=[<FrameSummary file /tmp/ipykernel_532/273153676.py, line 11 in torch_dynamo_resume_in_fn_at_10>], graph_break=False)\nTRACED GRAPH\n ===== __compiled_fn_45_b13efbe6_821e_4bde_a769_2f883cd09f46 =====\n /opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/fx/_lazy_graph_module.py class GraphModule(torch.nn.Module):\n    def forward(self, L_x_: \"f32[3][1]cpu\"):\n        l_x_ = L_x_\n        \n         # File: /tmp/ipykernel_532/273153676.py:4 in inner2, code: return x + 2\n        x: \"f32[3][1]cpu\" = l_x_ + 2;  l_x_ = x = None\n        return ()\n        \n\nStep 2: calling compiler function eager\nStep 2: done compiler function eager\nproduce_guards\ntrack_symint L['x'].size()[0] 3 None\ntrack_symint L['x'].stride()[0] 1 None\ntrack_symint L['x'].storage_offset() 0 None\nSkipping guard L['x'].size()[0] == 3\nSkipping guard L['x'].stride()[0] == 1\nSkipping guard L['x'].storage_offset() == 0\nGUARDS:\n\nTREE_GUARD_MANAGER:\n+- RootGuardManager\n| +- LAMBDA_GUARD: torch._functorch.aot_autograd.utils.top_saved_tensors_hooks ids == None  # _dynamo/output_graph.py:688 in init_ambient_guards\n| +- DEFAULT_DEVICE: utils_device.CURRENT_DEVICE == None                           # _dynamo/output_graph.py:676 in init_ambient_guards\n| +- GLOBAL_STATE: ___check_global_state()\n| +- TORCH_FUNCTION_MODE_STACK: ___check_torch_function_mode_stack()\n| +- GuardManager: source=L['x'], accessed_by=FrameLocalsGuardAccessor(key='x', framelocals_idx=3), type=<class 'torch.Tensor'>, tag_safe=(True, False)\n| | +- TENSOR_MATCH: check_tensor(L['x'], Tensor, DispatchKeySet(CPU, BackendSelect, ADInplaceOrView, AutogradCPU), torch.float32, device=None, requires_grad=False, size=[3], stride=[1])  # x = inner2(x)  # mp/ipykernel_532/273153676.py:11 in torch_dynamo_resume_in_fn_at_10\n| | +- NO_HASATTR: hasattr(L['x'], '_dynamo_dynamic_indices') == False           # x = inner2(x)  # mp/ipykernel_532/273153676.py:11 in torch_dynamo_resume_in_fn_at_10\n| +- GuardManager: source=G, accessed_by=GlobalsGuardAccessor, type=<class 'dict'>, tag_safe=(True, False)\n| | +- GuardManager: source=G['inner2'], accessed_by=DictGetItemGuardAccessor('inner2'), type=<class 'function'>, tag_safe=(True, False)\n| | | +- GuardManager: source=G['inner2'].__code__, accessed_by=CodeGuardAccessor, type=<class 'code'>, tag_safe=(True, False)\n| | | | +- ID_MATCH: ___check_obj_id(G['inner2'].__code__, 140374666869584)        # x = inner2(x)  # mp/ipykernel_532/273153676.py:11 in torch_dynamo_resume_in_fn_at_10\n\nGuard eval latency = 1082.61 us\nput_code_state: no cache key, skipping\nrun_gc_after_compile: running gc\n\n```\n",
  "url": "https://pytorch.org/docs/stable/compile/programming_model.skipped_functions.html",
  "metadata": {
    "section": null,
    "issue_number": null,
    "labels": null,
    "answer_author": null
  }
}