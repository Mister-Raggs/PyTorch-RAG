{
  "doc_id": "44c530c881b96ec25e2a8c843d5a48e7",
  "source": "pytorch_docs",
  "title": "Disabling and Suppressing Errors \u2014 PyTorch 2.9 documentation",
  "text": "\n## Disabling and Suppressing Errors#\n\nCreated On: Jul 28, 2025 | Last Updated On: Jul 28, 2025\nFor some model architectures, there are portions of the model which are particularly difficult to compile -\neither there are many graph breaks, or there are crashes.\nYou may want to explicitly disable these portions of the model which are problematic so that you can applytorch.compileto the parts that work. You can do this by using the@torch.compiler.disabledecorator.\nWhentorch.compileattempts to call a disabled function, it breaks the graph and skips tracing the disabled function,\nresuming tracing after the call. By default, all recursive calls made from a disabled function are also disabled.\nUse therecursive=Falseoption to allow compilation for recursive calls.\ntorch.compile\n@torch.compiler.disable\ntorch.compile\nrecursive=False\n\n```python\ndef inner1(x):\n    torch._dynamo.graph_break()  # not traced\n    return x + 1  # not traced\n\n@torch.compiler.disable\ndef outer1(x):\n    x = x + 2  # not traced\n    torch._dynamo.graph_break()  # not traced\n    return inner1(x)\n\n@torch.compile\ndef f(x):\n    x = outer1(x)\n    return x + 4  # traced\n\nprint(f(torch.ones(3)))\n\n```\n\n\n```python\ntensor([8., 8., 8.])\n\n```\n\n\n```python\nGraph break in user code at /tmp/ipykernel_183/1421264493.py:13\nGraph Break Reason: Skip calling `torch.compiler.disable()`d function\n  Explanation: Skip calling function `<function outer1 at 0x7f597c0792d0>` since it was wrapped with `torch.compiler.disable` (reason: None)\n  Hint: Remove the `torch.compiler.disable` call\n\n  Developer debug context: <function outer1 at 0x7f597c0792d0>\n\n For more details about this graph break, please visit: https://meta-pytorch.github.io/compile-graph-break-site/gb/gb0098.html\nUser code traceback:\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/runpy.py\", line 196, in _run_module_as_main\n    return _run_code(code, main_globals, None,\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/runpy.py\", line 86, in _run_code\n    exec(code, run_globals)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel_launcher.py\", line 18, in <module>\n    app.launch_new_instance()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/traitlets/config/application.py\", line 1075, in launch_instance\n    app.start()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/kernelapp.py\", line 758, in start\n    self.io_loop.start()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/tornado/platform/asyncio.py\", line 211, in start\n    self.asyncio_loop.run_forever()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/asyncio/base_events.py\", line 603, in run_forever\n    self._run_once()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/asyncio/base_events.py\", line 1909, in _run_once\n    handle._run()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/asyncio/events.py\", line 80, in _run\n    self._context.run(self._callback, *self._args)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/utils.py\", line 71, in preserve_context\n    return await f(*args, **kwargs)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/kernelbase.py\", line 614, in shell_main\n    await self.dispatch_shell(msg, subshell_id=subshell_id)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/kernelbase.py\", line 471, in dispatch_shell\n    await result\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/ipkernel.py\", line 366, in execute_request\n    await super().execute_request(stream, ident, parent)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/kernelbase.py\", line 827, in execute_request\n    reply_content = await reply_content\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/ipkernel.py\", line 458, in do_execute\n    res = shell.run_cell(\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/zmqshell.py\", line 663, in run_cell\n    return super().run_cell(*args, **kwargs)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/interactiveshell.py\", line 3006, in run_cell\n    result = self._run_cell(\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/interactiveshell.py\", line 3061, in _run_cell\n    result = runner(coro)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/async_helpers.py\", line 129, in _pseudo_sync_runner\n    coro.send(None)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/interactiveshell.py\", line 3266, in run_cell_async\n    has_raised = await self.run_ast_nodes(code_ast.body, cell_name,\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/interactiveshell.py\", line 3445, in run_ast_nodes\n    if await self.run_code(code, result, async_=asy):\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/interactiveshell.py\", line 3505, in run_code\n    exec(code_obj, self.user_global_ns, self.user_ns)\n  File \"/tmp/ipykernel_183/1421264493.py\", line 16, in <module>\n    print(f(torch.ones(3)))\n  File \"/tmp/ipykernel_183/1421264493.py\", line 13, in f\n    x = outer1(x)\n\nTRACED GRAPH\n ===== __compiled_fn_4_d64fea0f_2ed0_41fa_b031_95a5e2bf9415 =====\n /opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/fx/_lazy_graph_module.py class GraphModule(torch.nn.Module):\n    def forward(self, L_stack0_: \"f32[3][1]cpu\"):\n        l_stack0_ = L_stack0_\n        \n         # File: /tmp/ipykernel_183/1421264493.py:14 in torch_dynamo_resume_in_f_at_13, code: return x + 4  # traced\n        add: \"f32[3][1]cpu\" = l_stack0_ + 4;  l_stack0_ = None\n        return (add,)\n        \n\n```\n\n\n```python\ndef inner2(x):\n    torch._dynamo.graph_break()  # traced\n    return x + 1  # traced\n\n@torch.compiler.disable(recursive=False)\ndef outer2(x):\n    x = x + 2  # not traced\n    torch._dynamo.graph_break()  # not traced\n    return inner2(x)\n\n@torch.compile\ndef g(x):\n    x = outer2(x)\n    return x + 4  # traced\n\nprint(g(torch.ones(3)))\n\n```\n\n\n```python\ntensor([8., 8., 8.])\n\n```\n\n\n```python\nGraph break in user code at /tmp/ipykernel_183/881423632.py:13\nGraph Break Reason: Skip inlining `torch.compiler.disable()`d function\n  Explanation: Skip inlining function <function outer2 at 0x7f5918bc3e20> since it was wrapped with `torch.compiler.disable` (reason: None)\n  Hint: Remove the `torch.compiler.disable` call\n\n  Developer debug context: <function outer2 at 0x7f5918bc3e20>\n\n For more details about this graph break, please visit: https://meta-pytorch.github.io/compile-graph-break-site/gb/gb0099.html\nUser code traceback:\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/runpy.py\", line 196, in _run_module_as_main\n    return _run_code(code, main_globals, None,\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/runpy.py\", line 86, in _run_code\n    exec(code, run_globals)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel_launcher.py\", line 18, in <module>\n    app.launch_new_instance()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/traitlets/config/application.py\", line 1075, in launch_instance\n    app.start()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/kernelapp.py\", line 758, in start\n    self.io_loop.start()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/tornado/platform/asyncio.py\", line 211, in start\n    self.asyncio_loop.run_forever()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/asyncio/base_events.py\", line 603, in run_forever\n    self._run_once()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/asyncio/base_events.py\", line 1909, in _run_once\n    handle._run()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/asyncio/events.py\", line 80, in _run\n    self._context.run(self._callback, *self._args)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/utils.py\", line 71, in preserve_context\n    return await f(*args, **kwargs)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/kernelbase.py\", line 614, in shell_main\n    await self.dispatch_shell(msg, subshell_id=subshell_id)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/kernelbase.py\", line 471, in dispatch_shell\n    await result\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/ipkernel.py\", line 366, in execute_request\n    await super().execute_request(stream, ident, parent)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/kernelbase.py\", line 827, in execute_request\n    reply_content = await reply_content\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/ipkernel.py\", line 458, in do_execute\n    res = shell.run_cell(\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/zmqshell.py\", line 663, in run_cell\n    return super().run_cell(*args, **kwargs)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/interactiveshell.py\", line 3006, in run_cell\n    result = self._run_cell(\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/interactiveshell.py\", line 3061, in _run_cell\n    result = runner(coro)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/async_helpers.py\", line 129, in _pseudo_sync_runner\n    coro.send(None)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/interactiveshell.py\", line 3266, in run_cell_async\n    has_raised = await self.run_ast_nodes(code_ast.body, cell_name,\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/interactiveshell.py\", line 3445, in run_ast_nodes\n    if await self.run_code(code, result, async_=asy):\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/interactiveshell.py\", line 3505, in run_code\n    exec(code_obj, self.user_global_ns, self.user_ns)\n  File \"/tmp/ipykernel_183/881423632.py\", line 16, in <module>\n    print(g(torch.ones(3)))\n  File \"/tmp/ipykernel_183/881423632.py\", line 13, in g\n    x = outer2(x)\n\nGraph break in user code at /tmp/ipykernel_183/881423632.py:2\nGraph Break Reason: Call to `torch._dynamo.graph_break()`\n  Explanation: User-inserted graph break. Message: None\n  Hint: Remove the `torch._dynamo.graph_break()` call.\n\n  Developer debug context: Called `torch._dynamo.graph_break()` with args `[]`, kwargs `{}`\n\n For more details about this graph break, please visit: https://meta-pytorch.github.io/compile-graph-break-site/gb/gb0025.html\nUser code traceback:\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/runpy.py\", line 196, in _run_module_as_main\n    return _run_code(code, main_globals, None,\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/runpy.py\", line 86, in _run_code\n    exec(code, run_globals)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel_launcher.py\", line 18, in <module>\n    app.launch_new_instance()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/traitlets/config/application.py\", line 1075, in launch_instance\n    app.start()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/kernelapp.py\", line 758, in start\n    self.io_loop.start()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/tornado/platform/asyncio.py\", line 211, in start\n    self.asyncio_loop.run_forever()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/asyncio/base_events.py\", line 603, in run_forever\n    self._run_once()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/asyncio/base_events.py\", line 1909, in _run_once\n    handle._run()\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/asyncio/events.py\", line 80, in _run\n    self._context.run(self._callback, *self._args)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/utils.py\", line 71, in preserve_context\n    return await f(*args, **kwargs)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/kernelbase.py\", line 614, in shell_main\n    await self.dispatch_shell(msg, subshell_id=subshell_id)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/kernelbase.py\", line 471, in dispatch_shell\n    await result\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/ipkernel.py\", line 366, in execute_request\n    await super().execute_request(stream, ident, parent)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/kernelbase.py\", line 827, in execute_request\n    reply_content = await reply_content\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/ipkernel.py\", line 458, in do_execute\n    res = shell.run_cell(\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/ipykernel/zmqshell.py\", line 663, in run_cell\n    return super().run_cell(*args, **kwargs)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/interactiveshell.py\", line 3006, in run_cell\n    result = self._run_cell(\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/interactiveshell.py\", line 3061, in _run_cell\n    result = runner(coro)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/async_helpers.py\", line 129, in _pseudo_sync_runner\n    coro.send(None)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/interactiveshell.py\", line 3266, in run_cell_async\n    has_raised = await self.run_ast_nodes(code_ast.body, cell_name,\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/interactiveshell.py\", line 3445, in run_ast_nodes\n    if await self.run_code(code, result, async_=asy):\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/IPython/core/interactiveshell.py\", line 3505, in run_code\n    exec(code_obj, self.user_global_ns, self.user_ns)\n  File \"/tmp/ipykernel_183/881423632.py\", line 16, in <module>\n    print(g(torch.ones(3)))\n  File \"/tmp/ipykernel_183/881423632.py\", line 13, in g\n    x = outer2(x)\n  File \"/opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/_dynamo/external_utils.py\", line 196, in nonrecursive_disable_wrapper\n    return fn(*args, **kwargs)\n  File \"/tmp/ipykernel_183/881423632.py\", line 9, in outer2\n    return inner2(x)\n  File \"/tmp/ipykernel_183/881423632.py\", line 2, in inner2\n    torch._dynamo.graph_break()  # traced\n\nTRACED GRAPH\n ===== __compiled_fn_12_26020017_c915_42ce_9ca0_f38bb8979845 =====\n /opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/fx/_lazy_graph_module.py class GraphModule(torch.nn.Module):\n    def forward(self, L_x_: \"f32[3][1]cpu\"):\n        l_x_ = L_x_\n        \n         # File: /tmp/ipykernel_183/881423632.py:3 in torch_dynamo_resume_in_inner2_at_2, code: return x + 1  # traced\n        add: \"f32[3][1]cpu\" = l_x_ + 1;  l_x_ = None\n        return (add,)\n        \n\nTRACED GRAPH\n ===== __compiled_fn_14_51c0ecfe_ceb5_435c_9b11_d2460775d0e0 =====\n /opt/conda/envs/py_3.10/lib/python3.10/site-packages/torch/fx/_lazy_graph_module.py class GraphModule(torch.nn.Module):\n    def forward(self, L_stack0_: \"f32[3][1]cpu\"):\n        l_stack0_ = L_stack0_\n        \n         # File: /tmp/ipykernel_183/881423632.py:14 in torch_dynamo_resume_in_g_at_13, code: return x + 4  # traced\n        add: \"f32[3][1]cpu\" = l_stack0_ + 4;  l_stack0_ = None\n        return (add,)\n        \n\n```\n\nFor example, one can usetorch.compiler.disableto disabletorch.compileon sparse architecture in\nrecommendation models, as the sparse arch is difficult to compile.\nPreprocessing and logging functions are other examples of functions that typically cause\na lot of graph breaks and do not get value from being compiled.\ntorch.compiler.disable\ntorch.compile\nIf you are experiencing compiler crashes and you want to continue regardless,\nyou can settorch._dynamo.config.suppress_errors=True.\nWhen the compiler crashes, we will just skip tracing the function and try again later.This is not best practice- it is better to eventually manually adddisableannotations as necessary.\ntorch._dynamo.config.suppress_errors=True\ndisable",
  "url": "https://pytorch.org/docs/stable/compile/programming_model.compiler_disable.html",
  "metadata": {
    "section": null,
    "issue_number": null,
    "labels": null,
    "answer_author": null
  }
}