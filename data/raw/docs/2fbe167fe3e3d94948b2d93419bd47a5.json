{
  "doc_id": "2fbe167fe3e3d94948b2d93419bd47a5",
  "source": "pytorch_docs",
  "title": "torch.hub \u2014 PyTorch 2.9 documentation",
  "text": "\n## torch.hub#\n\nCreated On: Jun 13, 2025 | Last Updated On: Jun 13, 2025\nPytorch Hub is a pre-trained model repository designed to facilitate research reproducibility.\n\n## Publishing models#\n\nPytorch Hub supports publishing pre-trained models(model definitions and pre-trained weights)\nto a GitHub repository by adding a simplehubconf.pyfile;\nhubconf.py\nhubconf.pycan have multiple entrypoints. Each entrypoint is defined as a python function\n(example: a pre-trained model you want to publish).\nhubconf.py\n\n```python\n  def entrypoint_name(*args, **kwargs):\n      # args & kwargs are optional, for models which take positional/keyword arguments.\n      ...\n\n```\n\n\n## How to implement an entrypoint?#\n\nHere is a code snippet specifies an entrypoint forresnet18model if we expand\nthe implementation inpytorch/vision/hubconf.py.\nIn most case importing the right function inhubconf.pyis sufficient. Here we\njust want to use the expanded version as an example to show how it works.\nYou can see the full script inpytorch/vision repo\nresnet18\npytorch/vision/hubconf.py\nhubconf.py\n\n```python\n  dependencies = ['torch']\n  from torchvision.models.resnet import resnet18 as _resnet18\n\n  # resnet18 is the name of entrypoint\n  def resnet18(pretrained=False, **kwargs):\n      \"\"\" # This docstring shows up in hub.help()\n      Resnet18 model\n      pretrained (bool): kwargs, load pretrained weights into the model\n      \"\"\"\n      # Call the model, load pretrained weights\n      model = _resnet18(pretrained=pretrained, **kwargs)\n      return model\n\n```\n\ndependenciesvariable is alistof package names required toloadthe model. Note this might\nbe slightly different from dependencies required for training a model.\ndependencies\nargsandkwargsare passed along to the real callable function.\nargs\nkwargs\nDocstring of the function works as a help message. It explains what does the model do and what\nare the allowed positional/keyword arguments. It\u2019s highly recommended to add a few examples here.\nEntrypoint function can either return a model(nn.module), or auxiliary tools to make the user workflow smoother, e.g. tokenizers.\nCallables prefixed with underscore are considered as helper functions which won\u2019t show up intorch.hub.list().\ntorch.hub.list()\nPretrained weights can either be stored locally in the GitHub repo, or loadable bytorch.hub.load_state_dict_from_url(). If less than 2GB, it\u2019s recommended to attach it to aproject releaseand use the url from the release.\nIn the example abovetorchvision.models.resnet.resnet18handlespretrained, alternatively you can put the following logic in the entrypoint definition.\ntorch.hub.load_state_dict_from_url()\ntorchvision.models.resnet.resnet18\npretrained\n\n```python\n  if pretrained:\n      # For checkpoint saved in local GitHub repo, e.g. <RELATIVE_PATH_TO_CHECKPOINT>=weights/save.pth\n      dirname = os.path.dirname(__file__)\n      checkpoint = os.path.join(dirname, <RELATIVE_PATH_TO_CHECKPOINT>)\n      state_dict = torch.load(checkpoint)\n      model.load_state_dict(state_dict)\n\n      # For checkpoint saved elsewhere\n      checkpoint = 'https://download.pytorch.org/models/resnet18-5c106cde.pth'\n      model.load_state_dict(torch.hub.load_state_dict_from_url(checkpoint, progress=False))\n\n```\n\n\n## Important Notice#\n\nThe published models should be at least in a branch/tag. It can\u2019t be a random commit.\n\n## Loading models from Hub#\n\nPytorch Hub provides convenient APIs to explore all available models in hub\nthroughtorch.hub.list(), show docstring and examples throughtorch.hub.help()and load the pre-trained models usingtorch.hub.load().\ntorch.hub.list()\ntorch.hub.help()\ntorch.hub.load()\nList all callable entrypoints available in the repo specified bygithub.\ngithub\ngithub(str) \u2013 a string with format \u201crepo_owner/repo_name[:ref]\u201d with an optional\nref (tag or branch). Ifrefis not specified, the default branch is assumed to bemainif\nit exists, and otherwisemaster.\nExample: \u2018pytorch/vision:0.10\u2019\nref\nmain\nmaster\nforce_reload(bool,optional) \u2013 whether to discard the existing cache and force a fresh download.\nDefault isFalse.\nFalse\nskip_validation(bool,optional) \u2013 ifFalse, torchhub will check that the branch or commit\nspecified by thegithubargument properly belongs to the repo owner. This will make\nrequests to the GitHub API; you can specify a non-default GitHub token by setting theGITHUB_TOKENenvironment variable. Default isFalse.\nFalse\ngithub\nGITHUB_TOKEN\nFalse\ntrust_repo(bool,strorNone) \u2013\"check\",True,FalseorNone.\nThis parameter was introduced in v1.12 and helps ensuring that users\nonly run code from repos that they trust.IfFalse, a prompt will ask the user whether the repo should\nbe trusted.IfTrue, the repo will be added to the trusted list and loaded\nwithout requiring explicit confirmation.If\"check\", the repo will be checked against the list of\ntrusted repos in the cache. If it is not present in that list, the\nbehaviour will fall back onto thetrust_repo=Falseoption.IfNone: this will raise a warning, inviting the user to settrust_repoto eitherFalse,Trueor\"check\". This\nis only present for backward compatibility and will be removed in\nv2.0.Default isNoneand will eventually change to\"check\"in v2.0.\n\"check\",True,FalseorNone.\nThis parameter was introduced in v1.12 and helps ensuring that users\nonly run code from repos that they trust.\n\"check\"\nTrue\nFalse\nNone\nIfFalse, a prompt will ask the user whether the repo should\nbe trusted.\nFalse\nIfTrue, the repo will be added to the trusted list and loaded\nwithout requiring explicit confirmation.\nTrue\nIf\"check\", the repo will be checked against the list of\ntrusted repos in the cache. If it is not present in that list, the\nbehaviour will fall back onto thetrust_repo=Falseoption.\n\"check\"\ntrust_repo=False\nIfNone: this will raise a warning, inviting the user to settrust_repoto eitherFalse,Trueor\"check\". This\nis only present for backward compatibility and will be removed in\nv2.0.\nNone\ntrust_repo\nFalse\nTrue\n\"check\"\nDefault isNoneand will eventually change to\"check\"in v2.0.\nNone\n\"check\"\nverbose(bool,optional) \u2013 IfFalse, mute messages about hitting\nlocal caches. Note that the message about first download cannot be\nmuted. Default isTrue.\nFalse\nTrue\nThe available callables entrypoint\nlist\nExample\n\n```python\n>>> entrypoints = torch.hub.list(\"pytorch/vision\", force_reload=True)\n\n```\n\nShow the docstring of entrypointmodel.\nmodel\ngithub(str) \u2013 a string with format <repo_owner/repo_name[:ref]> with an optional\nref (a tag or a branch). Ifrefis not specified, the default branch is assumed\nto bemainif it exists, and otherwisemaster.\nExample: \u2018pytorch/vision:0.10\u2019\nref\nmain\nmaster\nmodel(str) \u2013 a string of entrypoint name defined in repo\u2019shubconf.py\nhubconf.py\nforce_reload(bool,optional) \u2013 whether to discard the existing cache and force a fresh download.\nDefault isFalse.\nFalse\nskip_validation(bool,optional) \u2013 ifFalse, torchhub will check that the ref\nspecified by thegithubargument properly belongs to the repo owner. This will make\nrequests to the GitHub API; you can specify a non-default GitHub token by setting theGITHUB_TOKENenvironment variable. Default isFalse.\nFalse\ngithub\nGITHUB_TOKEN\nFalse\ntrust_repo(bool,strorNone) \u2013\"check\",True,FalseorNone.\nThis parameter was introduced in v1.12 and helps ensuring that users\nonly run code from repos that they trust.IfFalse, a prompt will ask the user whether the repo should\nbe trusted.IfTrue, the repo will be added to the trusted list and loaded\nwithout requiring explicit confirmation.If\"check\", the repo will be checked against the list of\ntrusted repos in the cache. If it is not present in that list, the\nbehaviour will fall back onto thetrust_repo=Falseoption.IfNone: this will raise a warning, inviting the user to settrust_repoto eitherFalse,Trueor\"check\". This\nis only present for backward compatibility and will be removed in\nv2.0.Default isNoneand will eventually change to\"check\"in v2.0.\n\"check\",True,FalseorNone.\nThis parameter was introduced in v1.12 and helps ensuring that users\nonly run code from repos that they trust.\n\"check\"\nTrue\nFalse\nNone\nIfFalse, a prompt will ask the user whether the repo should\nbe trusted.\nFalse\nIfTrue, the repo will be added to the trusted list and loaded\nwithout requiring explicit confirmation.\nTrue\nIf\"check\", the repo will be checked against the list of\ntrusted repos in the cache. If it is not present in that list, the\nbehaviour will fall back onto thetrust_repo=Falseoption.\n\"check\"\ntrust_repo=False\nIfNone: this will raise a warning, inviting the user to settrust_repoto eitherFalse,Trueor\"check\". This\nis only present for backward compatibility and will be removed in\nv2.0.\nNone\ntrust_repo\nFalse\nTrue\n\"check\"\nDefault isNoneand will eventually change to\"check\"in v2.0.\nNone\n\"check\"\nExample\n\n```python\n>>> print(torch.hub.help(\"pytorch/vision\", \"resnet18\", force_reload=True))\n\n```\n\nLoad a model from a github repo or a local directory.\nNote: Loading a model is the typical use case, but this can also be used to\nfor loading other objects such as tokenizers, loss functions, etc.\nIfsourceis \u2018github\u2019,repo_or_diris expected to be\nof the formrepo_owner/repo_name[:ref]with an optional\nref (a tag or a branch).\nsource\nrepo_or_dir\nrepo_owner/repo_name[:ref]\nIfsourceis \u2018local\u2019,repo_or_diris expected to be a\npath to a local directory.\nsource\nrepo_or_dir\nrepo_or_dir(str) \u2013 Ifsourceis \u2018github\u2019,\nthis should correspond to a github repo with formatrepo_owner/repo_name[:ref]with\nan optional ref (tag or branch), for example \u2018pytorch/vision:0.10\u2019. Ifrefis not specified,\nthe default branch is assumed to bemainif it exists, and otherwisemaster.\nIfsourceis \u2018local\u2019  then it should be a path to a local directory.\nsource\nrepo_owner/repo_name[:ref]\nref\nmain\nmaster\nsource\nmodel(str) \u2013 the name of a callable (entrypoint) defined in the\nrepo/dir\u2019shubconf.py.\nhubconf.py\n*args(optional) \u2013 the corresponding args for callablemodel.\nmodel\nsource(str,optional) \u2013 \u2018github\u2019 or \u2018local\u2019. Specifies howrepo_or_diris to be interpreted. Default is \u2018github\u2019.\nrepo_or_dir\ntrust_repo(bool,strorNone) \u2013\"check\",True,FalseorNone.\nThis parameter was introduced in v1.12 and helps ensuring that users\nonly run code from repos that they trust.IfFalse, a prompt will ask the user whether the repo should\nbe trusted.IfTrue, the repo will be added to the trusted list and loaded\nwithout requiring explicit confirmation.If\"check\", the repo will be checked against the list of\ntrusted repos in the cache. If it is not present in that list, the\nbehaviour will fall back onto thetrust_repo=Falseoption.IfNone: this will raise a warning, inviting the user to settrust_repoto eitherFalse,Trueor\"check\". This\nis only present for backward compatibility and will be removed in\nv2.0.Default isNoneand will eventually change to\"check\"in v2.0.\n\"check\",True,FalseorNone.\nThis parameter was introduced in v1.12 and helps ensuring that users\nonly run code from repos that they trust.\n\"check\"\nTrue\nFalse\nNone\nIfFalse, a prompt will ask the user whether the repo should\nbe trusted.\nFalse\nIfTrue, the repo will be added to the trusted list and loaded\nwithout requiring explicit confirmation.\nTrue\nIf\"check\", the repo will be checked against the list of\ntrusted repos in the cache. If it is not present in that list, the\nbehaviour will fall back onto thetrust_repo=Falseoption.\n\"check\"\ntrust_repo=False\nIfNone: this will raise a warning, inviting the user to settrust_repoto eitherFalse,Trueor\"check\". This\nis only present for backward compatibility and will be removed in\nv2.0.\nNone\ntrust_repo\nFalse\nTrue\n\"check\"\nDefault isNoneand will eventually change to\"check\"in v2.0.\nNone\n\"check\"\nforce_reload(bool,optional) \u2013 whether to force a fresh download of\nthe github repo unconditionally. Does not have any effect ifsource='local'. Default isFalse.\nsource='local'\nFalse\nverbose(bool,optional) \u2013 IfFalse, mute messages about hitting\nlocal caches. Note that the message about first download cannot be\nmuted. Does not have any effect ifsource='local'.\nDefault isTrue.\nFalse\nsource='local'\nTrue\nskip_validation(bool,optional) \u2013 ifFalse, torchhub will check that the branch or commit\nspecified by thegithubargument properly belongs to the repo owner. This will make\nrequests to the GitHub API; you can specify a non-default GitHub token by setting theGITHUB_TOKENenvironment variable. Default isFalse.\nFalse\ngithub\nGITHUB_TOKEN\nFalse\n**kwargs(optional) \u2013 the corresponding kwargs for callablemodel.\nmodel\nThe output of themodelcallable when called with the given*argsand**kwargs.\nmodel\n*args\n**kwargs\nExample\n\n```python\n>>> # from a github repo\n>>> repo = \"pytorch/vision\"\n>>> model = torch.hub.load(\n...     repo, \"resnet50\", weights=\"ResNet50_Weights.IMAGENET1K_V1\"\n... )\n>>> # from a local directory\n>>> path = \"/some/local/path/pytorch/vision\"\n>>> model = torch.hub.load(path, \"resnet50\", weights=\"ResNet50_Weights.DEFAULT\")\n\n```\n\nDownload object at the given URL to a local path.\nurl(str) \u2013 URL of the object to download\ndst(str) \u2013 Full path where object will be saved, e.g./tmp/temporary_file\n/tmp/temporary_file\nhash_prefix(str,optional) \u2013 If not None, the SHA256 downloaded file should start withhash_prefix.\nDefault: None\nhash_prefix\nprogress(bool,optional) \u2013 whether or not to display a progress bar to stderr\nDefault: True\nExample\n\n```python\n>>> torch.hub.download_url_to_file(\n...     \"https://s3.amazonaws.com/pytorch/models/resnet18-5c106cde.pth\",\n...     \"/tmp/temporary_file\",\n... )\n\n```\n\nLoads the Torch serialized object at the given URL.\nIf downloaded file is a zip file, it will be automatically\ndecompressed.\nIf the object is already present inmodel_dir, it\u2019s deserialized and\nreturned.\nThe default value ofmodel_diris<hub_dir>/checkpointswherehub_diris the directory returned byget_dir().\nmodel_dir\n<hub_dir>/checkpoints\nhub_dir\nget_dir()\nurl(str) \u2013 URL of the object to download\nmodel_dir(str,optional) \u2013 directory in which to save the object\nmap_location(optional) \u2013 a function or a dict specifying how to remap storage locations (see torch.load)\nprogress(bool,optional) \u2013 whether or not to display a progress bar to stderr.\nDefault: True\ncheck_hash(bool,optional) \u2013 If True, the filename part of the URL should follow the naming conventionfilename-<sha256>.extwhere<sha256>is the first eight or more\ndigits of the SHA256 hash of the contents of the file. The hash is used to\nensure unique names and to verify the contents of the file.\nDefault: False\nfilename-<sha256>.ext\n<sha256>\nfile_name(str,optional) \u2013 name for the downloaded file. Filename fromurlwill be used if not set.\nurl\nweights_only(bool,optional) \u2013 If True, only weights will be loaded and no complex pickled objects.\nRecommended for untrusted sources. Seeload()for more details.\nload()\ndict[str,Any]\nExample\n\n```python\n>>> state_dict = torch.hub.load_state_dict_from_url(\n...     \"https://s3.amazonaws.com/pytorch/models/resnet18-5c106cde.pth\"\n... )\n\n```\n\n\n## Running a loaded model:#\n\nNote that*argsand**kwargsintorch.hub.load()are used toinstantiatea model. After you have loaded a model, how can you find out\nwhat you can do with the model?\nA suggested workflow is\n*args\n**kwargs\ntorch.hub.load()\ndir(model)to see all available methods of the model.\ndir(model)\nhelp(model.foo)to check what argumentsmodel.footakes to run\nhelp(model.foo)\nmodel.foo\nTo help users explore without referring to documentation back and forth, we strongly\nrecommend repo owners make function help messages clear and succinct. It\u2019s also helpful\nto include a minimal working example.\n\n## Where are my downloaded models saved?#\n\nThe locations are used in the order of\nCallinghub.set_dir(<PATH_TO_HUB_DIR>)\nhub.set_dir(<PATH_TO_HUB_DIR>)\n$TORCH_HOME/hub, if environment variableTORCH_HOMEis set.\n$TORCH_HOME/hub\nTORCH_HOME\n$XDG_CACHE_HOME/torch/hub, if environment variableXDG_CACHE_HOMEis set.\n$XDG_CACHE_HOME/torch/hub\nXDG_CACHE_HOME\n~/.cache/torch/hub\n~/.cache/torch/hub\nGet the Torch Hub cache directory used for storing downloaded models & weights.\nIfset_dir()is not called, default path is$TORCH_HOME/hubwhere\nenvironment variable$TORCH_HOMEdefaults to$XDG_CACHE_HOME/torch.$XDG_CACHE_HOMEfollows the X Design Group specification of the Linux\nfilesystem layout, with a default value~/.cacheif the environment\nvariable is not set.\nset_dir()\n$TORCH_HOME/hub\n$TORCH_HOME\n$XDG_CACHE_HOME/torch\n$XDG_CACHE_HOME\n~/.cache\nstr\nOptionally set the Torch Hub directory used to save downloaded models & weights.\nd(str) \u2013 path to a local folder to save downloaded models & weights.\n\n## Caching logic#\n\nBy default, we don\u2019t clean up files after loading it. Hub uses the cache by default if it already exists in the\ndirectory returned byget_dir().\nget_dir()\nUsers can force a reload by callinghub.load(...,force_reload=True). This will delete\nthe existing GitHub folder and downloaded weights, reinitialize a fresh download. This is useful\nwhen updates are published to the same branch, users can keep up with the latest release.\nhub.load(...,force_reload=True)\n\n## Known limitations:#\n\nTorch hub works by importing the package as if it was installed. There are some side effects\nintroduced by importing in Python. For example, you can see new items in Python cachessys.modulesandsys.path_importer_cachewhich is normal Python behavior.\nThis also means that you may have import errors when importing different models\nfrom different repos, if the repos have the same sub-package names (typically, amodelsubpackage). A workaround for these kinds of import errors is to\nremove the offending sub-package from thesys.modulesdict; more details can\nbe found inthis GitHub issue.\nsys.modules\nsys.path_importer_cache\nmodel\nsys.modules\nA known limitation that is worth mentioning here: usersCANNOTload two different branches of\nthe same repo in thesame python process. It\u2019s just like installing two packages with the\nsame name in Python, which is not good. Cache might join the party and give you surprises if you\nactually try that. Of course it\u2019s totally fine to load them in separate processes.",
  "url": "https://pytorch.org/docs/stable/hub.html",
  "metadata": {
    "section": null,
    "issue_number": null,
    "labels": null,
    "answer_author": null
  }
}